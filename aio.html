<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R for Reproducible Scientific Analysis: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav software"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Software Carpentry" src="assets/images/software-logo.svg">
</div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Software Carpentry" src="assets/images/software-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R for Reproducible Scientific Analysis
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R for Reproducible Scientific Analysis
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R for Reproducible Scientific Analysis
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-rstudio-intro.html">1. Introduction to R and RStudio</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-project-intro.html">2. Project Management With RStudio</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-seeking-help.html">3. Seeking Help</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-data-structures-part1.html">4. Data Structures</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-data-structures-part2.html">5. Exploring Data Frames</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-data-subsetting.html">6. Subsetting Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07b-control-flow.html">7. Control Flow--if() and for()</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-plot-ggplot2.html">8. Creating Publication-Quality Graphics with ggplot2</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-vectorization.html">9. Vectorization</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-functions.html">10. Functions Explained</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-writing-data.html">11. Writing Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-plyr.html">12. Splitting and Combining Data Frames with plyr</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13b-dplyr.html">13. Data Frame Manipulation with dplyr</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14b-tidyr.html">14. Pivoting using tidyr</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="15-knitr-markdown.html">15. Producing Reports With knitr</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="16-wrap-up.html">16. Writing Good Software</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li>
<li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-rstudio-intro"><p>Content from <a href="01-rstudio-intro.html">Introduction to R and RStudio</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/01-rstudio-intro.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to find your way around RStudio?</li>
<li>How to interact with R?</li>
<li>How to manage your environment?</li>
<li>How to install packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the purpose and use of each pane in RStudio</li>
<li>Locate buttons and options in RStudio</li>
<li>Define a variable</li>
<li>Assign data to a variable</li>
<li>Manage a workspace in an interactive R session</li>
<li>Use mathematical and comparison operators</li>
<li>Call functions</li>
<li>Manage packages</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="before-starting-the-workshop"><h2 class="section-heading">Before Starting The Workshop<a class="anchor" aria-label="anchor" href="#before-starting-the-workshop"></a>
</h2>
<hr class="half-width">
<p>Please ensure you have the latest version of R and RStudio installed
on your machine. This is important, as some packages used in the
workshop may not install correctly (or at all) if R is not up to
date.</p>
<ul>
<li><a href="https://www.r-project.org/" class="external-link">Download and install the latest
version of R here</a></li>
<li><a href="https://www.rstudio.com/products/rstudio/download/#download" class="external-link">Download
and install RStudio here</a></li>
</ul></section><section id="why-use-r-and-r-studio"><h2 class="section-heading">Why use R and R studio?<a class="anchor" aria-label="anchor" href="#why-use-r-and-r-studio"></a>
</h2>
<hr class="half-width">
<p>Welcome to the R portion of the Software Carpentry workshop!</p>
<p>Science is a multi-step process: once you’ve designed an experiment
and collected data, the real fun begins with analysis! Throughout this
lesson, we’re going to teach you some of the fundamentals of the R
language as well as some best practices for organizing code for
scientific projects that will make your life easier.</p>
<p>Although we could use a spreadsheet in Microsoft Excel or Google
sheets to analyze our data, these tools are limited in their flexibility
and accessibility. Critically, they also are difficult to share steps
which explore and change the raw data, which is key to <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003285" class="external-link">“reproducible”
research</a>.</p>
<p>Therefore, this lesson will teach you how to begin exploring your
data using R and RStudio. The R program is available for Windows, Mac,
and Linux operating systems, and is a freely-available where you
downloaded it above. To run R, all you need is the R program.</p>
<p>However, to make using R easier, we will use the program RStudio,
which we also downloaded above. RStudio is a free, open-source,
Integrated Development Environment (IDE). It provides a built-in editor,
works on all platforms (including on servers) and provides many
advantages such as integration with version control and project
management.</p>
</section><section id="overview"><h2 class="section-heading">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<hr class="half-width">
<p>We will begin with raw data, perform exploratory analyses, and learn
how to plot results graphically. This example starts with a dataset from
<a href="https://www.gapminder.org" class="external-link">gapminder.org</a> containing
population information for many countries through time. Can you read the
data into R? Can you plot the population for Senegal? Can you calculate
the average income for countries on the continent of Asia? By the end of
these lessons you will be able to do things like plot the populations
for all of these countries in under a minute!</p>
<p><strong>Basic layout</strong></p>
<p>When you first open RStudio, you will be greeted by three panels:</p>
<ul>
<li>The interactive R console/Terminal (entire left)</li>
<li>Environment/History/Connections (tabbed in upper right)</li>
<li>Files/Plots/Packages/Help/Viewer (tabbed in lower right)</li>
</ul>
<figure><img src="fig/01-rstudio.png" alt="RStudio layout" class="figure mx-auto d-block"></figure><p>Once you open files, such as R scripts, an editor panel will also
open in the top left.</p>
<figure><img src="fig/01-rstudio-script.png" alt="RStudio layout with .R file open" class="figure mx-auto d-block"></figure><div id="r-scripts" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="r-scripts" class="callout-inner">
<h3 class="callout-title">R scripts<a class="anchor" aria-label="anchor" href="#r-scripts"></a>
</h3>
<div class="callout-content">
<p>Any commands that you write in the R console can be saved to a file
to be re-run again. Files containing R code to be ran in this way are
called R scripts. R scripts have <code>.R</code> at the end of their
names to let you know what they are.</p>
</div>
</div>
</div>
</section><section id="workflow-within-rstudio"><h2 class="section-heading">Workflow within RStudio<a class="anchor" aria-label="anchor" href="#workflow-within-rstudio"></a>
</h2>
<hr class="half-width">
<p>There are two main ways one can work within RStudio:</p>
<ol style="list-style-type: decimal">
<li>Test and play within the interactive R console then copy code into a
.R file to run later.</li>
</ol>
<ul>
<li>This works well when doing small tests and initially starting
off.</li>
<li>It quickly becomes laborious</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Start writing in a .R file and use RStudio’s short cut keys for the
Run command to push the current line, selected lines or modified lines
to the interactive R console.</li>
</ol>
<ul>
<li>This is a great way to start; all your code is saved for later</li>
<li>You will be able to run the file you create from within RStudio or
using R’s <code>source()</code> function.</li>
</ul>
<div id="tip-running-segments-of-your-code" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-running-segments-of-your-code" class="callout-inner">
<h3 class="callout-title">Tip: Running segments of your code<a class="anchor" aria-label="anchor" href="#tip-running-segments-of-your-code"></a>
</h3>
<div class="callout-content">
<p>RStudio offers you great flexibility in running code from within the
editor window. There are buttons, menu choices, and keyboard shortcuts.
To run the current line, you can</p>
<ol style="list-style-type: decimal">
<li>click on the <code>Run</code> button above the editor panel, or</li>
<li>select “Run Lines” from the “Code” menu, or</li>
<li>hit <kbd>Ctrl</kbd>+<kbd>Return</kbd> in Windows or Linux or
<kbd>⌘</kbd>+<kbd>Return</kbd> on OS X. (This shortcut can also be seen
by hovering the mouse over the button). To run a block of code, select
it and then <code>Run</code>. If you have modified a line of code within
a block of code you have just run, there is no need to reselect the
section and <code>Run</code>, you can use the next button along,
<code>Re-run the previous region</code>. This will run the previous code
block including the modifications you have made.</li>
</ol>
</div>
</div>
</div>
</section><section id="introduction-to-r"><h2 class="section-heading">Introduction to R<a class="anchor" aria-label="anchor" href="#introduction-to-r"></a>
</h2>
<hr class="half-width">
<p>Much of your time in R will be spent in the R interactive console.
This is where you will run all of your code, and can be a useful
environment to try out ideas before adding them to an R script file.
This console in RStudio is the same as the one you would get if you
typed in <code>R</code> in your command-line environment.</p>
<p>The first thing you will see in the R interactive session is a bunch
of information, followed by a “&gt;” and a blinking cursor. In many ways
this is similar to the shell environment you learned about during the
shell lessons: it operates on the same idea of a “Read, evaluate, print
loop”: you type in commands, R tries to execute them, and then returns a
result.</p>
</section><section id="using-r-as-a-calculator"><h2 class="section-heading">Using R as a calculator<a class="anchor" aria-label="anchor" href="#using-r-as-a-calculator"></a>
</h2>
<hr class="half-width">
<p>The simplest thing you could do with R is to do arithmetic:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">+</span> <span class="fl">100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 101</code></pre>
</div>
<p>And R will print out the answer, with a preceding “[1]”. [1] is the
index of the first element of the line being printed in the console. For
more information on indexing vectors, see <a href="https://swcarpentry.github.io/r-novice-gapminder/06-data-subsetting/index.html" class="external-link">Episode
6: Subsetting Data</a>.</p>
<p>If you type in an incomplete command, R will wait for you to complete
it. If you are familiar with Unix Shell’s bash, you may recognize this
behavior from bash.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">+</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>+</code></pre>
</div>
<p>Any time you hit return and the R session shows a “+” instead of a
“&gt;”, it means it’s waiting for you to complete the command. If you
want to cancel a command you can hit <kbd>Esc</kbd> and RStudio will
give you back the “&gt;” prompt.</p>
<div id="tip-canceling-commands" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-canceling-commands" class="callout-inner">
<h3 class="callout-title">Tip: Canceling commands<a class="anchor" aria-label="anchor" href="#tip-canceling-commands"></a>
</h3>
<div class="callout-content">
<p>If you’re using R from the command line instead of from within
RStudio, you need to use <kbd>Ctrl</kbd>+<kbd>C</kbd> instead of
<kbd>Esc</kbd> to cancel the command. This applies to Mac users as
well!</p>
<p>Canceling a command isn’t only useful for killing incomplete
commands: you can also use it to tell R to stop running code (for
example if it’s taking much longer than you expect), or to get rid of
the code you’re currently writing.</p>
</div>
</div>
</div>
<p>When using R as a calculator, the order of operations is the same as
you would have learned back in school.</p>
<p>From highest to lowest precedence:</p>
<ul>
<li>Parentheses: <code>(</code>, <code>)</code>
</li>
<li>Exponents: <code>^</code> or <code>**</code>
</li>
<li>Multiply: <code>*</code>
</li>
<li>Divide: <code>/</code>
</li>
<li>Add: <code>+</code>
</li>
<li>Subtract: <code>-</code>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 13</code></pre>
</div>
<p>Use parentheses to group operations in order to force the order of
evaluation if it differs from the default, or to make clear what you
intend.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 16</code></pre>
</div>
<p>This can get unwieldy when not needed, but clarifies your intentions.
Remember that others may later read your code.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># hard to read</span></span>
<span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span>       <span class="co"># clear, if you remember the rules</span></span>
<span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>     <span class="co"># if you forget some rules, this might help</span></span></code></pre>
</div>
<p>The text after each line of code is called a “comment”. Anything that
follows after the hash (or octothorpe) symbol <code>#</code> is ignored
by R when it executes code.</p>
<p>Really small or large numbers get a scientific notation:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">/</span><span class="fl">10000</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2e-04</code></pre>
</div>
<p>Which is shorthand for “multiplied by <code>10^XX</code>”. So
<code>2e-4</code> is shorthand for <code>2 * 10^(-4)</code>.</p>
<p>You can write numbers in scientific notation too:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5e3</span>  <span class="co"># Note the lack of minus here</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5000</code></pre>
</div>
</section><section id="mathematical-functions"><h2 class="section-heading">Mathematical functions<a class="anchor" aria-label="anchor" href="#mathematical-functions"></a>
</h2>
<hr class="half-width">
<p>R has many built in mathematical functions. To call a function, we
can type its name, followed by open and closing parentheses. Functions
take arguments as inputs, anything we type inside the parentheses of a
function is considered an argument. Depending on the function, the
number of arguments can vary from none to multiple. For example:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">getwd</span><span class="op">(</span><span class="op">)</span> <span class="co">#returns an absolute filepath</span></span></code></pre>
</div>
<p>doesn’t require an argument, whereas for the next set of mathematical
functions we will need to supply the function a value in order to
compute the result.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sin</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>  <span class="co"># trigonometry functions</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.841471</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>  <span class="co"># natural logarithm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log10</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># base-10 logarithm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span> <span class="co"># e^(1/2)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.648721</code></pre>
</div>
<p>Don’t worry about trying to remember every function in R. You can
look them up on Google, or if you can remember the start of the
function’s name, use the tab completion in RStudio.</p>
<p>This is one advantage that RStudio has over R on its own, it has
auto-completion abilities that allow you to more easily look up
functions, their arguments, and the values that they take.</p>
<p>Typing a <code>?</code> before the name of a command will open the
help page for that command. When using RStudio, this will open the
‘Help’ pane; if using R in the terminal, the help page will open in your
browser. The help page will include a detailed description of the
command and how it works. Scrolling to the bottom of the help page will
usually show a collection of code examples which illustrate command
usage. We’ll go through an example later.</p>
</section><section id="comparing-things"><h2 class="section-heading">Comparing things<a class="anchor" aria-label="anchor" href="#comparing-things"></a>
</h2>
<hr class="half-width">
<p>We can also do comparisons in R:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">==</span> <span class="fl">1</span>  <span class="co"># equality (note two equals signs, read as "is equal to")</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">!=</span> <span class="fl">2</span>  <span class="co"># inequality (read as "is not equal to")</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&lt;</span> <span class="fl">2</span>  <span class="co"># less than</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&lt;=</span> <span class="fl">1</span>  <span class="co"># less than or equal to</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&gt;</span> <span class="fl">0</span>  <span class="co"># greater than</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&gt;=</span> <span class="op">-</span><span class="fl">9</span> <span class="co"># greater than or equal to</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div id="tip-comparing-numbers" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-comparing-numbers" class="callout-inner">
<h3 class="callout-title">Tip: Comparing Numbers<a class="anchor" aria-label="anchor" href="#tip-comparing-numbers"></a>
</h3>
<div class="callout-content">
<p>A word of warning about comparing numbers: you should never use
<code>==</code> to compare two numbers unless they are integers (a data
type which can specifically represent only whole numbers).</p>
<p>Computers may only represent decimal numbers with a certain degree of
precision, so two numbers which look the same when printed out by R, may
actually have different underlying representations and therefore be
different by a small margin of error (called Machine numeric
tolerance).</p>
<p>Instead you should use the <code>all.equal</code> function.</p>
<p>Further reading: <a href="https://floating-point-gui.de/" class="external-link">http://floating-point-gui.de/</a></p>
</div>
</div>
</div>
</section><section id="variables-and-assignment"><h2 class="section-heading">Variables and assignment<a class="anchor" aria-label="anchor" href="#variables-and-assignment"></a>
</h2>
<hr class="half-width">
<p>We can store values in variables using the assignment operator
<code>&lt;-</code>, like this:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">40</span></span></code></pre>
</div>
<p>Notice that assignment does not print a value. Instead, we stored it
for later in something called a <strong>variable</strong>.
<code>x</code> now contains the <strong>value</strong>
<code>0.025</code>:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.025</code></pre>
</div>
<p>More precisely, the stored value is a <em>decimal approximation</em>
of this fraction called a <a href="https://en.wikipedia.org/wiki/Floating_point" class="external-link">floating point
number</a>.</p>
<p>Look for the <code>Environment</code> tab in the top right panel of
RStudio, and you will see that <code>x</code> and its value have
appeared. Our variable <code>x</code> can be used in place of a number
in any calculation that expects a number:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -3.688879</code></pre>
</div>
<p>Notice also that variables can be reassigned:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre>
</div>
<p><code>x</code> used to contain the value 0.025 and now it has the
value 100.</p>
<p>Assignment values can contain the variable being assigned to:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span> <span class="co">#notice how RStudio updates its description of x on the top right tab</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
<p>The right hand side of the assignment can be any valid R expression.
The right hand side is <em>fully evaluated</em> before the assignment
occurs.</p>
<p>Variable names can contain letters, numbers, underscores and periods
but no spaces. They must start with a letter or a period followed by a
letter (they cannot start with a number nor an underscore). Variables
beginning with a period are hidden variables. Different people use
different conventions for long variable names, these include</p>
<ul>
<li>periods.between.words</li>
<li>underscores_between_words</li>
<li>camelCaseToSeparateWords</li>
</ul>
<p>What you use is up to you, but <strong>be consistent</strong>.</p>
<p>It is also possible to use the <code>=</code> operator for
assignment:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">40</span></span></code></pre>
</div>
<p>But this is much less common among R users. The most important thing
is to <strong>be consistent</strong> with the operator you use. There
are occasionally places where it is less confusing to use
<code>&lt;-</code> than <code>=</code>, and it is the most common symbol
used in the community. So the recommendation is to use
<code>&lt;-</code>.</p>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Which of the following are valid R variable names?</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>min_height</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>max.height</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>_age</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>.mass</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>MaxLength</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>min<span class="sc">-</span>length</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="dv">2</span>widths</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>celsius2kelvin</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The following can be used as R variables:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">min_height</span></span>
<span><span class="va">max.height</span></span>
<span><span class="va">MaxLength</span></span>
<span><span class="va">celsius2kelvin</span></span></code></pre>
</div>
<p>The following creates a hidden variable:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.mass</span></span></code></pre>
</div>
<p>The following will not be able to be used to create a variable</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>_age</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>min<span class="sc">-</span>length</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="dv">2</span>widths</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="vectorization"><h2 class="section-heading">Vectorization<a class="anchor" aria-label="anchor" href="#vectorization"></a>
</h2>
<hr class="half-width">
<p>One final thing to be aware of is that R is <em>vectorized</em>,
meaning that variables and functions can have vectors as values. In
contrast to physics and mathematics, a vector in R describes a set of
values in a certain order of the same data type. For example:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  2  4  8 16 32</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="fl">2</span><span class="op">^</span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  2  4  8 16 32</code></pre>
</div>
<p>This is incredibly powerful; we will discuss this further in an
upcoming lesson.</p>
</section><section id="managing-your-environment"><h2 class="section-heading">Managing your environment<a class="anchor" aria-label="anchor" href="#managing-your-environment"></a>
</h2>
<hr class="half-width">
<p>There are a few useful commands you can use to interact with the R
session.</p>
<p><code>ls</code> will list all of the variables and functions stored
in the global environment (your working R session):</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ls</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "x" "y"</code></pre>
</div>
<div id="tip-hidden-objects" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-hidden-objects" class="callout-inner">
<h3 class="callout-title">Tip: hidden objects<a class="anchor" aria-label="anchor" href="#tip-hidden-objects"></a>
</h3>
<div class="callout-content">
<p>Like in the shell, <code>ls</code> will hide any variables or
functions starting with a “.” by default. To list all objects, type
<code>ls(all.names=TRUE)</code> instead</p>
</div>
</div>
</div>
<p>Note here that we didn’t give any arguments to <code>ls</code>, but
we still needed to give the parentheses to tell R to call the
function.</p>
<p>If we type <code>ls</code> by itself, R prints a bunch of code
instead of a listing of objects.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ls</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function (name, pos = -1L, envir = as.environment(pos), all.names = FALSE, 
    pattern, sorted = TRUE) 
{
    if (!missing(name)) {
        pos &lt;- tryCatch(name, error = function(e) e)
        if (inherits(pos, "error")) {
            name &lt;- substitute(name)
            if (!is.character(name)) 
                name &lt;- deparse(name)
            warning(gettextf("%s converted to character string", 
                sQuote(name)), domain = NA)
            pos &lt;- name
        }
    }
    all.names &lt;- .Internal(ls(envir, all.names, sorted))
    if (!missing(pattern)) {
        if ((ll &lt;- length(grep("[", pattern, fixed = TRUE))) &amp;&amp; 
            ll != length(grep("]", pattern, fixed = TRUE))) {
            if (pattern == "[") {
                pattern &lt;- "\\["
                warning("replaced regular expression pattern '[' by  '\\\\['")
            }
            else if (length(grep("[^\\\\]\\[&lt;-", pattern))) {
                pattern &lt;- sub("\\[&lt;-", "\\\\\\[&lt;-", pattern)
                warning("replaced '[&lt;-' by '\\\\[&lt;-' in regular expression pattern")
            }
        }
        grep(pattern, all.names, value = TRUE)
    }
    else all.names
}
&lt;bytecode: 0x5625faa18908&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
<p>What’s going on here?</p>
<p>Like everything in R, <code>ls</code> is the name of an object, and
entering the name of an object by itself prints the contents of the
object. The object <code>x</code> that we created earlier contains 1, 2,
3, 4, 5:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5</code></pre>
</div>
<p>The object <code>ls</code> contains the R code that makes the
<code>ls</code> function work! We’ll talk more about how functions work
and start writing our own later.</p>
<p>You can use <code>rm</code> to delete objects you no longer need:</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rm</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<p>If you have lots of things in your environment and want to delete all
of them, you can pass the results of <code>ls</code> to the
<code>rm</code> function:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rm</span><span class="op">(</span>list <span class="op">=</span> <span class="fu">ls</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>In this case we’ve combined the two. Like the order of operations,
anything inside the innermost parentheses is evaluated first, and so
on.</p>
<p>In this case we’ve specified that the results of <code>ls</code>
should be used for the <code>list</code> argument in <code>rm</code>.
When assigning values to arguments by name, you <em>must</em> use the
<code>=</code> operator!!</p>
<p>If instead we use <code>&lt;-</code>, there will be unintended side
effects, or you may get an error message:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rm</span><span class="op">(</span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu">ls</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rm(list &lt;- ls()): ... must contain names or character strings</code></pre>
</div>
<div id="tip-warnings-vs.-errors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-warnings-vs.-errors" class="callout-inner">
<h3 class="callout-title">Tip: Warnings vs. Errors<a class="anchor" aria-label="anchor" href="#tip-warnings-vs.-errors"></a>
</h3>
<div class="callout-content">
<p>Pay attention when R does something unexpected! Errors, like above,
are thrown when R cannot proceed with a calculation. Warnings on the
other hand usually mean that the function has run, but it probably
hasn’t worked as expected.</p>
<p>In both cases, the message that R prints out usually give you clues
how to fix a problem.</p>
</div>
</div>
</div>
</section><section id="r-packages"><h2 class="section-heading">R Packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h2>
<hr class="half-width">
<p>It is possible to add functions to R by writing a package, or by
obtaining a package written by someone else. As of this writing, there
are over 10,000 packages available on CRAN (the comprehensive R archive
network). R and RStudio have functionality for managing packages:</p>
<ul>
<li>You can see what packages are installed by typing
<code>installed.packages()</code>
</li>
<li>You can install packages by typing
<code>install.packages("packagename")</code>, where
<code>packagename</code> is the package name, in quotes.</li>
<li>You can update installed packages by typing
<code>update.packages()</code>
</li>
<li>You can remove a package with
<code>remove.packages("packagename")</code>
</li>
<li>You can make a package available for use with
<code>library(packagename)</code>
</li>
</ul>
<p>Packages can also be viewed, loaded, and detached in the Packages tab
of the lower right panel in RStudio. Clicking on this tab will display
all of the installed packages with a checkbox next to them. If the box
next to a package name is checked, the package is loaded and if it is
empty, the package is not loaded. Click an empty box to load that
package and click a checked box to detach that package.</p>
<p>Packages can be installed and updated from the Package tab with the
Install and Update buttons at the top of the tab.</p>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>What will be the value of each variable after each statement in the
following program?</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">47.5</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">122</span></span>
<span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="va">mass</span> <span class="op">*</span> <span class="fl">2.3</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">47.5</span></span></code></pre>
</div>
<p>This will give a value of 47.5 for the variable mass</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">122</span></span></code></pre>
</div>
<p>This will give a value of 122 for the variable age</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="va">mass</span> <span class="op">*</span> <span class="fl">2.3</span></span></code></pre>
</div>
<p>This will multiply the existing value of 47.5 by 2.3 to give a new
value of 109.25 to the variable mass.</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span></span></code></pre>
</div>
<p>This will subtract 20 from the existing value of 122 to give a new
value of 102 to the variable age.</p>
</div>
</div>
</div>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Run the code from the previous challenge, and write a command to
compare mass to age. Is mass larger than age?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>One way of answering this question in R is to use the
<code>&gt;</code> to set up the following:</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&gt;</span> <span class="va">age</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<p>This should yield a boolean value of TRUE since 109.25 is greater
than 102.</p>
</div>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>Clean up your working environment by deleting the mass and age
variables.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to challenge 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>We can use the <code>rm</code> command to accomplish this task</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rm</span><span class="op">(</span><span class="va">age</span>, <span class="va">mass</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5<a class="anchor" aria-label="anchor" href="#challenge-5"></a>
</h3>
<div class="callout-content">
<p>Install the following packages: <code>ggplot2</code>,
<code>plyr</code>, <code>gapminder</code></p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to challenge 5</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>We can use the <code>install.packages()</code> command to install the
required packages.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"plyr"</span><span class="op">)</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"gapminder"</span><span class="op">)</span></span></code></pre>
</div>
<p>An alternate solution, to install multiple packages with a single
<code>install.packages()</code> command is:</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">"plyr"</span>, <span class="st">"gapminder"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use RStudio to write and run R programs.</li>
<li>R has the usual arithmetic operators and mathematical
functions.</li>
<li>Use <code>&lt;-</code> to assign values to variables.</li>
<li>Use <code>ls()</code> to list the variables in a program.</li>
<li>Use <code>rm()</code> to delete objects in a program.</li>
<li>Use <code>install.packages()</code> to install packages
(libraries).</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-project-intro"><p>Content from <a href="02-project-intro.html">Project Management With RStudio</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/02-project-intro.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I manage my projects in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create self-contained projects in RStudio</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The scientific process is naturally incremental, and many projects
start life as random notes, some code, then a manuscript, and eventually
everything is a bit mixed together.</p>
<blockquote class="twitter-tweet">
<p>
Managing your projects in a reproducible fashion doesn’t just make your
science reproducible, it makes your life easier.
</p>
— Vince Buffalo (<span class="citation">@vsbuffalo</span>)
<a href="https://twitter.com/vsbuffalo/status/323638476153167872" class="external-link">April
15, 2013</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>Most people tend to organize their projects like this:</p>
<figure><img src="fig/bad_layout.png" alt="Screenshot of file manager demonstrating bad project organisation" class="figure mx-auto d-block"></figure><p>There are many reasons why we should <em>ALWAYS</em> avoid this:</p>
<ol style="list-style-type: decimal">
<li>It is really hard to tell which version of your data is the original
and which is the modified;</li>
<li>It gets really messy because it mixes files with various extensions
together;</li>
<li>It probably takes you a lot of time to actually find things, and
relate the correct figures to the exact code that has been used to
generate it;</li>
</ol>
<p>A good project layout will ultimately make your life easier:</p>
<ul>
<li>It will help ensure the integrity of your data;</li>
<li>It makes it simpler to share your code with someone else (a
lab-mate, collaborator, or supervisor);</li>
<li>It allows you to easily upload your code with your manuscript
submission;</li>
<li>It makes it easier to pick the project back up after a break.</li>
</ul></section><section id="a-possible-solution"><h2 class="section-heading">A possible solution<a class="anchor" aria-label="anchor" href="#a-possible-solution"></a>
</h2>
<hr class="half-width">
<p>Fortunately, there are tools and packages which can help you manage
your work effectively.</p>
<p>One of the most powerful and useful aspects of RStudio is its project
management functionality. We’ll be using this today to create a
self-contained, reproducible project.</p>
<div id="challenge-1-creating-a-self-contained-project" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1-creating-a-self-contained-project" class="callout-inner">
<h3 class="callout-title">Challenge 1: Creating a self-contained
project<a class="anchor" aria-label="anchor" href="#challenge-1-creating-a-self-contained-project"></a>
</h3>
<div class="callout-content">
<p>We’re going to create a new project in RStudio:</p>
<ol style="list-style-type: decimal">
<li>Click the “File” menu button, then “New Project”.</li>
<li>Click “New Directory”.</li>
<li>Click “New Project”.</li>
<li>Type in the name of the directory to store your project,
e.g. “my_project”.</li>
<li>If available, select the checkbox for “Create a git
repository.”</li>
<li>Click the “Create Project” button.</li>
</ol>
</div>
</div>
</div>
<p>The simplest way to open an RStudio project once it has been created
is to click through your file system to get to the directory where it
was saved and double click on the <code>.Rproj</code> file. This will
open RStudio and start your R session in the same directory as the
<code>.Rproj</code> file. All your data, plots and scripts will now be
relative to the project directory. RStudio projects have the added
benefit of allowing you to open multiple projects at the same time each
open to its own project directory. This allows you to keep multiple
projects open without them interfering with each other.</p>
<div id="challenge-2-opening-an-rstudio-project-through-the-file-system" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-opening-an-rstudio-project-through-the-file-system" class="callout-inner">
<h3 class="callout-title">Challenge 2: Opening an RStudio project
through the file system<a class="anchor" aria-label="anchor" href="#challenge-2-opening-an-rstudio-project-through-the-file-system"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Exit RStudio.</li>
<li>Navigate to the directory where you created a project in Challenge
1.</li>
<li>Double click on the <code>.Rproj</code> file in that directory.</li>
</ol>
</div>
</div>
</div>
</section><section id="best-practices-for-project-organization"><h2 class="section-heading">Best practices for project organization<a class="anchor" aria-label="anchor" href="#best-practices-for-project-organization"></a>
</h2>
<hr class="half-width">
<p>Although there is no “best” way to lay out a project, there are some
general principles to adhere to that will make project management
easier:</p>
<div class="section level3">
<h3 id="treat-data-as-read-only">Treat data as read only<a class="anchor" aria-label="anchor" href="#treat-data-as-read-only"></a>
</h3>
<p>This is probably the most important goal of setting up a project.
Data is typically time consuming and/or expensive to collect. Working
with them interactively (e.g., in Excel) where they can be modified
means you are never sure of where the data came from, or how it has been
modified since collection. It is therefore a good idea to treat your
data as “read-only”.</p>
</div>
<div class="section level3">
<h3 id="data-cleaning">Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>In many cases your data will be “dirty”: it will need significant
preprocessing to get into a format R (or any other programming language)
will find useful. This task is sometimes called “data munging”. Storing
these scripts in a separate folder, and creating a second “read-only”
data folder to hold the “cleaned” data sets can prevent confusion
between the two sets.</p>
</div>
<div class="section level3">
<h3 id="treat-generated-output-as-disposable">Treat generated output as disposable<a class="anchor" aria-label="anchor" href="#treat-generated-output-as-disposable"></a>
</h3>
<p>Anything generated by your scripts should be treated as disposable:
it should all be able to be regenerated from your scripts.</p>
<p>There are lots of different ways to manage this output. Having an
output folder with different sub-directories for each separate analysis
makes it easier later. Since many analyses are exploratory and don’t end
up being used in the final project, and some of the analyses get shared
between projects.</p>
<div id="tip-good-enough-practices-for-scientific-computing" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-good-enough-practices-for-scientific-computing" class="callout-inner">
<h3 class="callout-title">Tip: Good Enough Practices for Scientific
Computing<a class="anchor" aria-label="anchor" href="#tip-good-enough-practices-for-scientific-computing"></a>
</h3>
<div class="callout-content">
<p><a href="https://github.com/swcarpentry/good-enough-practices-in-scientific-computing/blob/gh-pages/good-enough-practices-for-scientific-computing.pdf" class="external-link">Good
Enough Practices for Scientific Computing</a> gives the following
recommendations for project organization:</p>
<ol style="list-style-type: decimal">
<li>Put each project in its own directory, which is named after the
project.</li>
<li>Put text documents associated with the project in the
<code>doc</code> directory.</li>
<li>Put raw data and metadata in the <code>data</code> directory, and
files generated during cleanup and analysis in a <code>results</code>
directory.</li>
<li>Put source for the project’s scripts and programs in the
<code>src</code> directory, and programs brought in from elsewhere or
compiled locally in the <code>bin</code> directory.</li>
<li>Name all files to reflect their content or function.</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="separate-function-definition-and-application">Separate function definition and application<a class="anchor" aria-label="anchor" href="#separate-function-definition-and-application"></a>
</h3>
<p>One of the more effective ways to work with R is to start by writing
the code you want to run directly in a .R script, and then running the
selected lines (either using the keyboard shortcuts in RStudio or
clicking the “Run” button) in the interactive R console.</p>
<p>When your project is in its early stages, the initial .R script file
usually contains many lines of directly executed code. As it matures,
reusable chunks get pulled into their own functions. It’s a good idea to
separate these functions into two separate folders; one to store useful
functions that you’ll reuse across analyses and projects, and one to
store the analysis scripts.</p>
</div>
<div class="section level3">
<h3 id="save-the-data-in-the-data-directory">Save the data in the data directory<a class="anchor" aria-label="anchor" href="#save-the-data-in-the-data-directory"></a>
</h3>
<p>Now we have a good directory structure we will now place/save the
data file in the <code>data/</code> directory.</p>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Download the gapminder data from <a href="data/gapminder_data.csv">this link to a csv file</a>.</p>
<ol style="list-style-type: decimal">
<li>Download the file (right mouse click on the link above -&gt; “Save
link as” / “Save file as”, or click on the link and after the page
loads, press <kbd>Ctrl</kbd>+<kbd>S</kbd> or choose File -&gt; “Save
page as”)</li>
<li>Make sure it’s saved under the name
<code>gapminder_data.csv</code>
</li>
<li>Save the file in the <code>data/</code> folder within your
project.</li>
</ol>
<p>We will load and inspect these data later.</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>It is useful to get some general idea about the dataset, directly
from the command line, before loading it into R. Understanding the
dataset better will come in handy when making decisions on how to load
it in R. Use the command-line shell to answer the following
questions:</p>
<ol style="list-style-type: decimal">
<li>What is the size of the file?</li>
<li>How many rows of data does it contain?</li>
<li>What kinds of values are stored in this file?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Challenge 4</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>By running these commands in the shell:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lh</span> data/gapminder_data.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>-rw-r--r-- 1 runner docker 80K Mar 12 01:14 data/gapminder_data.csv</code></pre>
</div>
<p>The file size is 80K.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> data/gapminder_data.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>1705 data/gapminder_data.csv</code></pre>
</div>
<p>There are 1705 lines. The data looks like:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">head</span> data/gapminder_data.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>country,year,pop,continent,lifeExp,gdpPercap
Afghanistan,1952,8425333,Asia,28.801,779.4453145
Afghanistan,1957,9240934,Asia,30.332,820.8530296
Afghanistan,1962,10267083,Asia,31.997,853.10071
Afghanistan,1967,11537966,Asia,34.02,836.1971382
Afghanistan,1972,13079460,Asia,36.088,739.9811058
Afghanistan,1977,14880372,Asia,38.438,786.11336
Afghanistan,1982,12881816,Asia,39.854,978.0114388
Afghanistan,1987,13867957,Asia,40.822,852.3959448
Afghanistan,1992,16317921,Asia,41.674,649.3413952</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tip-command-line-in-rstudio" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-command-line-in-rstudio" class="callout-inner">
<h3 class="callout-title">Tip: command line in RStudio<a class="anchor" aria-label="anchor" href="#tip-command-line-in-rstudio"></a>
</h3>
<div class="callout-content">
<p>The Terminal tab in the console pane provides a convenient place
directly within RStudio to interact directly with the command line.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="working-directory">Working directory<a class="anchor" aria-label="anchor" href="#working-directory"></a>
</h3>
<p>Knowing R’s current working directory is important because when you
need to access other files (for example, to import a data file), R will
look for them relative to the current working directory.</p>
<p>Each time you create a new RStudio Project, it will create a new
directory for that project. When you open an existing
<code>.Rproj</code> file, it will open that project and set R’s working
directory to the folder that file is in.</p>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5<a class="anchor" aria-label="anchor" href="#challenge-5"></a>
</h3>
<div class="callout-content">
<p>You can check the current working directory with the
<code>getwd()</code> command, or by using the menus in RStudio.</p>
<ol style="list-style-type: decimal">
<li>In the console, type <code>getwd()</code> (“wd” is short for
“working directory”) and hit Enter.</li>
<li>In the Files pane, double click on the <code>data</code> folder to
open it (or navigate to any other folder you wish). To get the Files
pane back to the current working directory, click “More” and then select
“Go To Working Directory”.</li>
</ol>
<p>You can change the working directory with <code>setwd()</code>, or by
using RStudio menus.</p>
<ol style="list-style-type: decimal">
<li>In the console, type <code>setwd("data")</code> and hit Enter. Type
<code>getwd()</code> and hit Enter to see the new working
directory.</li>
<li>In the menus at the top of the RStudio window, click the “Session”
menu button, and then select “Set Working Directory” and then “Choose
Directory”. Next, in the windows navigator that opens, navigate back to
the project directory, and click “Open”. Note that a <code>setwd</code>
command will automatically appear in the console.</li>
</ol>
</div>
</div>
</div>
<div id="tip-file-does-not-exist-errors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-file-does-not-exist-errors" class="callout-inner">
<h3 class="callout-title">Tip: File does not exist errors<a class="anchor" aria-label="anchor" href="#tip-file-does-not-exist-errors"></a>
</h3>
<div class="callout-content">
<p>When you’re attempting to reference a file in your R code and you’re
getting errors saying the file doesn’t exist, it’s a good idea to check
your working directory. You need to either provide an absolute path to
the file, or you need to make sure the file is saved in the working
directory (or a subfolder of the working directory) and provide a
relative path.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="version-control">Version Control<a class="anchor" aria-label="anchor" href="#version-control"></a>
</h3>
<p>It is important to use version control with projects. Go <a href="https://swcarpentry.github.io/git-novice/14-supplemental-rstudio.html" class="external-link">here
for a good lesson which describes using Git with RStudio</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use RStudio to create and manage projects with consistent
layout.</li>
<li>Treat raw data as read-only.</li>
<li>Treat generated output as disposable.</li>
<li>Separate function definition and application.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-03-seeking-help"><p>Content from <a href="03-seeking-help.html">Seeking Help</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/03-seeking-help.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I get help in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To be able to read R help files for functions and special
operators.</li>
<li>To be able to use CRAN task views to identify packages to solve a
problem.</li>
<li>To be able to seek help from your peers.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="reading-help-files"><h2 class="section-heading">Reading Help Files<a class="anchor" aria-label="anchor" href="#reading-help-files"></a>
</h2>
<hr class="half-width">
<p>R, and every package, provide help files for functions. The general
syntax to search for help on any function, “function_name”, from a
specific function that is in a package loaded into your namespace (your
interactive R session) is:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">function_name</span></span>
<span><span class="fu">help</span><span class="op">(</span><span class="va">function_name</span><span class="op">)</span></span></code></pre>
</div>
<p>For example take a look at the help file for
<code>write.table()</code>, we will be using a similar function in an
upcoming episode.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">write.table</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>This will load up a help page in RStudio (or as plain text in R
itself).</p>
<p>Each help page is broken down into sections:</p>
<ul>
<li>Description: An extended description of what the function does.</li>
<li>Usage: The arguments of the function and their default values (which
can be changed).</li>
<li>Arguments: An explanation of the data each argument is
expecting.</li>
<li>Details: Any important details to be aware of.</li>
<li>Value: The data the function returns.</li>
<li>See Also: Any related functions you might find useful.</li>
<li>Examples: Some examples for how to use the function.</li>
</ul>
<p>Different functions might have different sections, but these are the
main ones you should be aware of.</p>
<p>Notice how related functions might call for the same help file:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">write.table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">?</span><span class="fu">write.csv</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>This is because these functions have very similar applicability and
often share the same arguments as inputs to the function, so package
authors often choose to document them together in a single help
file.</p>
<div id="tip-running-examples" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-running-examples" class="callout-inner">
<h3 class="callout-title">Tip: Running Examples<a class="anchor" aria-label="anchor" href="#tip-running-examples"></a>
</h3>
<div class="callout-content">
<p>From within the function help page, you can highlight code in the
Examples and hit <kbd>Ctrl</kbd>+<kbd>Return</kbd> to run it in RStudio
console. This gives you a quick way to get a feel for how a function
works.</p>
</div>
</div>
</div>
<div id="tip-reading-help-files" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-reading-help-files" class="callout-inner">
<h3 class="callout-title">Tip: Reading Help Files<a class="anchor" aria-label="anchor" href="#tip-reading-help-files"></a>
</h3>
<div class="callout-content">
<p>One of the most daunting aspects of R is the large number of
functions available. It would be prohibitive, if not impossible to
remember the correct usage for every function you use. Luckily, using
the help files means you don’t have to remember that!</p>
</div>
</div>
</div>
</section><section id="special-operators"><h2 class="section-heading">Special Operators<a class="anchor" aria-label="anchor" href="#special-operators"></a>
</h2>
<hr class="half-width">
<p>To seek help on special operators, use quotes or backticks:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="st">"&lt;-"</span></span>
<span><span class="op">?</span><span class="va">`&lt;-`</span></span></code></pre>
</div>
</section><section id="getting-help-with-packages"><h2 class="section-heading">Getting Help with Packages<a class="anchor" aria-label="anchor" href="#getting-help-with-packages"></a>
</h2>
<hr class="half-width">
<p>Many packages come with “vignettes”: tutorials and extended example
documentation. Without any arguments, <code>vignette()</code> will list
all vignettes for all installed packages;
<code>vignette(package="package-name")</code> will list all available
vignettes for <code>package-name</code>, and
<code>vignette("vignette-name")</code> will open the specified
vignette.</p>
<p>If a package doesn’t have any vignettes, you can usually find help by
typing <code>help("package-name")</code>.</p>
<p>RStudio also has a set of excellent <a href="https://rstudio.com/resources/cheatsheets/" class="external-link">cheatsheets</a> for
many packages.</p>
</section><section id="when-you-remember-part-of-the-function-name"><h2 class="section-heading">When You Remember Part of the Function Name<a class="anchor" aria-label="anchor" href="#when-you-remember-part-of-the-function-name"></a>
</h2>
<hr class="half-width">
<p>If you’re not sure what package a function is in or how it’s
specifically spelled, you can do a fuzzy search:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">function_name</span></span></code></pre>
</div>
<p>A fuzzy search is when you search for an approximate string match.
For example, you may remember that the function to set your working
directory includes “set” in its name. You can do a fuzzy search to help
you identify the function:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">set</span></span></code></pre>
</div>
</section><section id="when-you-have-no-idea-where-to-begin"><h2 class="section-heading">When You Have No Idea Where to Begin<a class="anchor" aria-label="anchor" href="#when-you-have-no-idea-where-to-begin"></a>
</h2>
<hr class="half-width">
<p>If you don’t know what function or package you need to use <a href="https://cran.at.r-project.org/web/views" class="external-link">CRAN Task Views</a> is a
specially maintained list of packages grouped into fields. This can be a
good starting point.</p>
</section><section id="when-your-code-doesnt-work-seeking-help-from-your-peers"><h2 class="section-heading">When Your Code Doesn’t Work: Seeking Help from Your Peers<a class="anchor" aria-label="anchor" href="#when-your-code-doesnt-work-seeking-help-from-your-peers"></a>
</h2>
<hr class="half-width">
<p>If you’re having trouble using a function, 9 times out of 10, the
answers you seek have already been answered on <a href="https://stackoverflow.com/" class="external-link">Stack Overflow</a>. You can search
using the <code>[r]</code> tag. Please make sure to see their page on <a href="https://stackoverflow.com/help/how-to-ask" class="external-link">how to ask a good
question.</a></p>
<p>If you can’t find the answer, there are a few useful functions to
help you ask your peers:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">dput</span></span></code></pre>
</div>
<p>Will dump the data you’re working with into a format that can be
copied and pasted by others into their own R session.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessionInfo</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.3.3 tools_4.3.3    yaml_2.3.8     knitr_1.45     xfun_0.41     
[6] renv_1.0.5     evaluate_0.23 </code></pre>
</div>
<p>Will print out your current version of R, as well as any packages you
have loaded. This can be useful for others to help reproduce and debug
your issue.</p>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Look at the help page for the <code>c</code> function. What kind of
vector do you expect will be created if you evaluate the following:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">c</span><span class="op">(</span><span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span><span class="op">)</span></span>
<span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="st">'f'</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The <code>c()</code> function creates a vector, in which all elements
are of the same type. In the first case, the elements are numeric, in
the second, they are characters, and in the third they are also
characters: the numeric values are “coerced” to be characters.</p>
</div>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Look at the help for the <code>paste</code> function. You will need
to use it later. What’s the difference between the <code>sep</code> and
<code>collapse</code> arguments?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>To look at the help for the <code>paste()</code> function, use:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">help</span><span class="op">(</span><span class="st">"paste"</span><span class="op">)</span></span>
<span><span class="op">?</span><span class="va">paste</span></span></code></pre>
</div>
<p>The difference between <code>sep</code> and <code>collapse</code> is
a little tricky. The <code>paste</code> function accepts any number of
arguments, each of which can be a vector of any length. The
<code>sep</code> argument specifies the string used between concatenated
terms — by default, a space. The result is a vector as long as the
longest argument supplied to <code>paste</code>. In contrast,
<code>collapse</code> specifies that after concatenation the elements
are <em>collapsed</em> together using the given separator, the result
being a single string.</p>
<p>It is important to call the arguments explicitly by typing out the
argument name e.g <code>sep = ","</code> so the function understands to
use the “,” as a separator and not a term to concatenate. e.g.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, <span class="st">"c"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a c" "b c"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, <span class="st">"c"</span>, <span class="st">","</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a c ," "b c ,"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, <span class="st">"c"</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a,c" "b,c"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, <span class="st">"c"</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a c|b c"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>, <span class="st">"c"</span>, sep <span class="op">=</span> <span class="st">","</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a,c|b,c"</code></pre>
</div>
<p>(For more information, scroll to the bottom of the
<code>?paste</code> help page and look at the examples, or try
<code>example('paste')</code>.)</p>
</div>
</div>
</div>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Use help to find a function (and its associated parameters) that you
could use to load data from a tabular file in which columns are
delimited with “\t” (tab) and the decimal point is a “.” (period). This
check for decimal separator is important, especially if you are working
with international colleagues, because different countries have
different conventions for the decimal point (i.e. comma vs period).
Hint: use <code>??"read table"</code> to look up functions related to
reading in tabular data.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The standard R function for reading tab-delimited files with a period
decimal separator is read.delim(). You can also do this with
<code>read.table(file, sep="\t")</code> (the period is the
<em>default</em> decimal separator for <code>read.table()</code>),
although you may have to change the <code>comment.char</code> argument
as well if your data file contains hash (#) characters.</p>
</div>
</div>
</div>
</div>
</section><section id="other-resources"><h2 class="section-heading">Other Resources<a class="anchor" aria-label="anchor" href="#other-resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://www.statmethods.net/" class="external-link">Quick R</a></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/" class="external-link">RStudio
cheat sheets</a></li>
<li><a href="https://www.cookbook-r.com/" class="external-link">Cookbook for R</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>help()</code> to get online help in R.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-data-structures-part1"><p>Content from <a href="04-data-structures-part1.html">Data Structures</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/04-data-structures-part1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I read data in R?</li>
<li>What are the basic data types in R?</li>
<li>How do I represent categorical information in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To be able to identify the 5 main data types.</li>
<li>To begin exploring data frames, and understand how they are related
to vectors and lists.</li>
<li>To be able to ask questions from R about the type, class, and
structure of an object.</li>
<li>To understand the information of the attributes “names”, “class”,
and “dim”.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>One of R’s most powerful features is its ability to deal with tabular
data - such as you may already have in a spreadsheet or a CSV file.
Let’s start by making a toy dataset in your <code>data/</code>
directory, called <code>feline-data.csv</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>coat <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"calico"</span>, <span class="st">"black"</span>, <span class="st">"tabby"</span><span class="op">)</span>,</span>
<span>                    weight <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2.1</span>, <span class="fl">5.0</span>, <span class="fl">3.2</span><span class="op">)</span>,</span>
<span>                    likes_string <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>We can now save <code>cats</code> as a CSV file. It is good practice
to call the argument names explicitly so the function knows what default
values you are changing. Here we are setting
<code>row.names = FALSE</code>. Recall you can use
<code>?write.csv</code> to pull up the help file to check out the
argument names and their default values.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.csv</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cats</span>, file <span class="op">=</span> <span class="st">"data/feline-data.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>The contents of the new file, <code>feline-data.csv</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>coat,weight,likes_string</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>calico,<span class="fl">2.1</span>,<span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>black,<span class="fl">5.0</span>,<span class="dv">0</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>tabby,<span class="fl">3.2</span>,<span class="dv">1</span></span></code></pre>
</div>
<div id="tip-editing-text-files-in-r" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-editing-text-files-in-r" class="callout-inner">
<h3 class="callout-title">Tip: Editing Text files in R<a class="anchor" aria-label="anchor" href="#tip-editing-text-files-in-r"></a>
</h3>
<div class="callout-content">
<p>Alternatively, you can create <code>data/feline-data.csv</code> using
a text editor (Nano), or within RStudio with the <strong>File -&gt; New
File -&gt; Text File</strong> menu item.</p>
</div>
</div>
</div>
<p>We can load this into R via the following:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/feline-data.csv"</span><span class="op">)</span></span>
<span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string
1 calico    2.1            1
2  black    5.0            0
3  tabby    3.2            1</code></pre>
</div>
<p>The <code>read.table</code> function is used for reading in tabular
data stored in a text file where the columns of data are separated by
punctuation characters such as CSV files (csv = comma-separated values).
Tabs and commas are the most common punctuation characters used to
separate or delimit data points in csv files. For convenience R provides
2 other versions of <code>read.table</code>. These are:
<code>read.csv</code> for files where the data are separated with commas
and <code>read.delim</code> for files where the data are separated with
tabs. Of these three functions <code>read.csv</code> is the most
commonly used. If needed it is possible to override the default
delimiting punctuation marks for both <code>read.csv</code> and
<code>read.delim</code>.</p>
<div id="check-your-data-for-factors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="check-your-data-for-factors" class="callout-inner">
<h3 class="callout-title">Check your data for factors<a class="anchor" aria-label="anchor" href="#check-your-data-for-factors"></a>
</h3>
<div class="callout-content">
<p>In recent times, the default way how R handles textual data has
changed. Text data was interpreted by R automatically into a format
called “factors”. But there is an easier format that is called
“character”. We will hear about factors later, and what to use them for.
For now, remember that in most cases, they are not needed and only
complicate your life, which is why newer R versions read in text as
“character”. Check now if your version of R has automatically created
factors and convert them to “character” format:</p>
<ol style="list-style-type: decimal">
<li>Check the data types of your input by typing
<code>str(cats)</code>
</li>
<li>In the output, look at the three-letter codes after the colons: If
you see only “num” and “chr”, you can continue with the lesson and skip
this box. If you find “fct”, continue to step 3.</li>
<li>Prevent R from automatically creating “factor” data. That can be
done by the following code:
<code>options(stringsAsFactors = FALSE)</code>. Then, re-read the cats
table for the change to take effect.</li>
<li>You must set this option every time you restart R. To not forget
this, include it in your analysis script before you read in any data,
for example in one of the first lines.</li>
<li>For R versions greater than 4.0.0, text data is no longer converted
to factors anymore. So you can install this or a newer version to avoid
this problem. If you are working on an institute or company computer,
ask your administrator to do it.</li>
</ol>
</div>
</div>
</div>
<p>We can begin exploring our dataset right away, pulling out columns by
specifying them using the <code>$</code> operator:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.1 5.0 3.2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">coat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico" "black"  "tabby" </code></pre>
</div>
<p>We can do other operations on the columns:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Say we discovered that the scale weighs two Kg light:</span></span>
<span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span> <span class="op">+</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.1 7.0 5.2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="st">"My cat is"</span>, <span class="va">cats</span><span class="op">$</span><span class="va">coat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "My cat is calico" "My cat is black"  "My cat is tabby" </code></pre>
</div>
<p>But what about</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span> <span class="op">+</span> <span class="va">cats</span><span class="op">$</span><span class="va">coat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in cats$weight + cats$coat: non-numeric argument to binary operator</code></pre>
</div>
<p>Understanding what happened here is key to successfully analyzing
data in R.</p>
<div class="section level3">
<h3 id="data-types">Data Types<a class="anchor" aria-label="anchor" href="#data-types"></a>
</h3>
<p>If you guessed that the last command will return an error because
<code>2.1</code> plus <code>"black"</code> is nonsense, you’re right -
and you already have some intuition for an important concept in
programming called <em>data types</em>. We can ask what type of data
something is:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<p>There are 5 main types: <code>double</code>, <code>integer</code>,
<code>complex</code>, <code>logical</code> and <code>character</code>.
For historic reasons, <code>double</code> is also called
<code>numeric</code>.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="fl">3.14</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span> <span class="co"># The L suffix forces the number to be an integer, since by default R uses float numbers</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1i</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "complex"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "logical"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="st">'banana'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>No matter how complicated our analyses become, all data in R is
interpreted as one of these basic data types. This strictness has some
really important consequences.</p>
<p>A user has added details of another cat. This information is in the
file <code>data/feline-data_v2.csv</code>.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">file.show</span><span class="op">(</span><span class="st">"data/feline-data_v2.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>coat,weight,likes_string</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>calico,<span class="fl">2.1</span>,<span class="dv">1</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>black,<span class="fl">5.0</span>,<span class="dv">0</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>tabby,<span class="fl">3.2</span>,<span class="dv">1</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>tabby,<span class="fl">2.3</span> or <span class="fl">2.4</span>,<span class="dv">1</span></span></code></pre>
</div>
<p>Load the new cats data like before, and check what type of data we
find in the <code>weight</code> column:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/feline-data_v2.csv"</span><span class="op">)</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>Oh no, our weights aren’t the double type anymore! If we try to do
the same math we did on them before, we run into trouble:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span> <span class="op">+</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in cats$weight + 2: non-numeric argument to binary operator</code></pre>
</div>
<p>What happened? The <code>cats</code> data we are working with is
something called a <em>data frame</em>. Data frames are one of the most
common and versatile types of <em>data structures</em> we will work with
in R. A given column in a data frame cannot be composed of different
data types. In this case, R does not read everything in the data frame
column <code>weight</code> as a <em>double</em>, therefore the entire
column data type changes to something that is suitable for everything in
the column.</p>
<p>When R reads a csv file, it reads it in as a <em>data frame</em>.
Thus, when we loaded the <code>cats</code> csv file, it is stored as a
data frame. We can recognize data frames by the first row that is
written by the <code>str()</code> function:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	4 obs. of  3 variables:
 $ coat        : chr  "calico" "black" "tabby" "tabby"
 $ weight      : chr  "2.1" "5" "3.2" "2.3 or 2.4"
 $ likes_string: int  1 0 1 1</code></pre>
</div>
<p><em>Data frames</em> are composed of rows and columns, where each
column has the same number of rows. Different columns in a data frame
can be made up of different data types (this is what makes them so
versatile), but everything in a given column needs to be the same type
(e.g., vector, factor, or list).</p>
<p>Let’s explore more about different data structures and how they
behave. For now, let’s remove that extra line from our cats data and
reload it, while we investigate this behavior further:</p>
<p>feline-data.csv:</p>
<pre><code>coat,weight,likes_string
calico,2.1,1
black,5.0,0
tabby,3.2,1</code></pre>
<p>And back in RStudio:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/feline-data.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="vectors-and-type-coercion">Vectors and Type Coercion<a class="anchor" aria-label="anchor" href="#vectors-and-type-coercion"></a>
</h3>
<p>To better understand this behavior, let’s meet another of the data
structures: the <em>vector</em>.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_vector</span> <span class="op">&lt;-</span> <span class="fu">vector</span><span class="op">(</span>length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">my_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE FALSE</code></pre>
</div>
<p>A vector in R is essentially an ordered list of things, with the
special condition that <em>everything in the vector must be the same
basic data type</em>. If you don’t choose the datatype, it’ll default to
<code>logical</code>; or, you can declare an empty vector of whatever
type you like.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">another_vector</span> <span class="op">&lt;-</span> <span class="fu">vector</span><span class="op">(</span>mode<span class="op">=</span><span class="st">'character'</span>, length<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">another_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "" "" ""</code></pre>
</div>
<p>You can check if something is a vector:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">another_vector</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "" "" ""</code></pre>
</div>
<p>The somewhat cryptic output from this command indicates the basic
data type found in this vector - in this case <code>chr</code>,
character; an indication of the number of things in the vector -
actually, the indexes of the vector, in this case <code>[1:3]</code>;
and a few examples of what’s actually in the vector - in this case empty
character strings. If we similarly do</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:3] 2.1 5 3.2</code></pre>
</div>
<p>we see that <code>cats$weight</code> is a vector, too - <em>the
columns of data we load into R data.frames are all vectors</em>, and
that’s the root of why R forces everything in a column to be the same
basic data type.</p>
<div id="discussion-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion-1" class="callout-inner">
<h3 class="callout-title">Discussion 1<a class="anchor" aria-label="anchor" href="#discussion-1"></a>
</h3>
<div class="callout-content">
<p>Why is R so opinionated about what we put in our columns of data? How
does this help us?</p>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Discussion 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>By keeping everything in a column the same, we allow ourselves to
make simple assumptions about our data; if you can interpret one entry
in the column as a number, then you can interpret <em>all</em> of them
as numbers, so we don’t have to check every time. This consistency is
what people mean when they talk about <em>clean data</em>; in the long
run, strict consistency goes a long way to making our lives easier in
R.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="coercion-by-combining-vectors">Coercion by combining vectors<a class="anchor" aria-label="anchor" href="#coercion-by-combining-vectors"></a>
</h4>
<p>You can also make vectors with explicit contents with the combine
function:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combine_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">combine_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 6 3</code></pre>
</div>
<p>Given what we’ve learned so far, what do you think the following will
produce?</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quiz_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span>,<span class="st">'3'</span><span class="op">)</span></span></code></pre>
</div>
<p>This is something called <em>type coercion</em>, and it is the source
of many surprises and the reason why we need to be aware of the basic
data types and how R will interpret them. When R encounters a mix of
types (here double and character) to be combined into a single vector,
it will force them all to be the same type. Consider:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coercion_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">coercion_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"    "TRUE"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">another_coercion_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">another_coercion_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 1</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="the-type-hierarchy">The type hierarchy<a class="anchor" aria-label="anchor" href="#the-type-hierarchy"></a>
</h4>
<p>The coercion rules go: <code>logical</code> -&gt;
<code>integer</code> -&gt; <code>double</code> (“<code>numeric</code>”)
-&gt; <code>complex</code> -&gt; <code>character</code>, where -&gt; can
be read as <em>are transformed into</em>. For example, combining
<code>logical</code> and <code>character</code> transforms the result to
<code>character</code>:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"    "TRUE"</code></pre>
</div>
<p>A quick way to recognize <code>character</code> vectors is by the
quotes that enclose them when they are printed.</p>
<p>You can try to force coercion against this flow using the
<code>as.</code> functions:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">character_vector_example</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'0'</span>,<span class="st">'2'</span>,<span class="st">'4'</span><span class="op">)</span></span>
<span><span class="va">character_vector_example</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "0" "2" "4"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">character_coerced_to_double</span> <span class="op">&lt;-</span> <span class="fu">as.double</span><span class="op">(</span><span class="va">character_vector_example</span><span class="op">)</span></span>
<span><span class="va">character_coerced_to_double</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 2 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">double_coerced_to_logical</span> <span class="op">&lt;-</span> <span class="fu">as.logical</span><span class="op">(</span><span class="va">character_coerced_to_double</span><span class="op">)</span></span>
<span><span class="va">double_coerced_to_logical</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE  TRUE  TRUE</code></pre>
</div>
<p>As you can see, some surprising things can happen when R forces one
basic data type into another! Nitty-gritty of type coercion aside, the
point is: if your data doesn’t look like what you thought it was going
to look like, type coercion may well be to blame; make sure everything
is the same type in your vectors and your columns of data.frames, or you
will get nasty surprises!</p>
<p>But coercion can also be very useful! For example, in our
<code>cats</code> data <code>likes_string</code> is numeric, but we know
that the 1s and 0s actually represent <code>TRUE</code> and
<code>FALSE</code> (a common way of representing them). We should use
the <code>logical</code> datatype here, which has two states:
<code>TRUE</code> or <code>FALSE</code>, which is exactly what our data
represents. We can ‘coerce’ this column to be <code>logical</code> by
using the <code>as.logical</code> function:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">likes_string</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 0 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">likes_string</span> <span class="op">&lt;-</span> <span class="fu">as.logical</span><span class="op">(</span><span class="va">cats</span><span class="op">$</span><span class="va">likes_string</span><span class="op">)</span></span>
<span><span class="va">cats</span><span class="op">$</span><span class="va">likes_string</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE FALSE  TRUE</code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>An important part of every data analysis is cleaning the input data.
If you know that the input data is all of the same format,
(e.g. numbers), your analysis is much easier! Clean the cat data set
from the chapter about type coercion.</p>
<div class="section level4">
<h4 id="copy-the-code-template">Copy the code template<a class="anchor" aria-label="anchor" href="#copy-the-code-template"></a>
</h4>
<p>Create a new script in RStudio and copy and paste the following code.
Then move on to the tasks below, which help you to fill in the gaps
(______).</p>
<pre><code># Read data
cats &lt;- read.csv("data/feline-data_v2.csv")

# 1. Print the data
_____

# 2. Show an overview of the table with all data types
_____(cats)

# 3. The "weight" column has the incorrect data type __________.
#    The correct data type is: ____________.

# 4. Correct the 4th weight data point with the mean of the two given values
cats$weight[4] &lt;- 2.35
#    print the data again to see the effect
cats

# 5. Convert the weight to the right data type
cats$weight &lt;- ______________(cats$weight)

#    Calculate the mean to test yourself
mean(cats$weight)

# If you see the correct mean value (and not NA), you did the exercise
# correctly!</code></pre>
</div>
<div class="section level3">
<h3 id="instructions-for-the-tasks">Instructions for the tasks<a class="anchor" aria-label="anchor" href="#instructions-for-the-tasks"></a>
</h3>
<div class="section level4">
<h4 id="print-the-data">1. Print the data<a class="anchor" aria-label="anchor" href="#print-the-data"></a>
</h4>
<p>Execute the first statement (<code>read.csv(...)</code>). Then print
the data to the console</p>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Tip 1.1</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Show the content of any variable by typing its name.</p>
<div class="section level3">
<h3 id="solution-to-challenge-1-1">Solution to Challenge 1.1<a class="anchor" aria-label="anchor" href="#solution-to-challenge-1-1"></a>
</h3>
<p>Two correct solutions:</p>
<pre><code><span><span class="va">cats</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="overview-of-the-data-types" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="overview-of-the-data-types" class="callout-inner">
<h3 class="callout-title">2. Overview of the data types<a class="anchor" aria-label="anchor" href="#overview-of-the-data-types"></a>
</h3>
<div class="callout-content">
<p>The data type of your data is as important as the data itself. Use a
function we saw earlier to print out the data types of all columns of
the <code>cats</code> table.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Tip 1.2</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>In the chapter “Data types” we saw two functions that can show data
types. One printed just a single word, the data type name. The other
printed a short form of the data type, and the first few values. We need
the second here.</p>
</div>
</div>
</div>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<em>(continued)</em><a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<blockquote>
<h3 id="solution-to-challenge-1.2">Solution to Challenge 1.2</h3>
<pre><code><span><span class="fu">str</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</blockquote>
<div class="section level4">
<h4 id="which-data-type-do-we-need">3. Which data type do we need?<a class="anchor" aria-label="anchor" href="#which-data-type-do-we-need"></a>
</h4>
<p>The shown data type is not the right one for this data (weight of a
cat). Which data type do we need?</p>
<ul>
<li>Why did the <code>read.csv()</code> function not choose the correct
data type?</li>
<li>Fill in the gap in the comment with the correct data type for cat
weight!</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Tip 1.3</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Scroll up to the section about the <a href="#the-type-hierarchy">type
hierarchy</a> to review the available data types</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to Challenge 1.3</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<ul>
<li>Weight is expressed on a continuous scale (real numbers). The R data
type for this is “double” (also known as “numeric”).</li>
<li>The fourth row has the value “2.3 or 2.4”. That is not a number but
two, and an english word. Therefore, the “character” data type is
chosen. The whole column is now text, because all values in the same
columns have to be the same data type.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="correct-the-problematic-value" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="correct-the-problematic-value" class="callout-inner">
<h3 class="callout-title">4. Correct the problematic value<a class="anchor" aria-label="anchor" href="#correct-the-problematic-value"></a>
</h3>
<div class="callout-content">
<p>The code to assign a new weight value to the problematic fourth row
is given. Think first and then execute it: What will be the data type
after assigning a number like in this example? You can check the data
type after executing to see if you were right.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Tip 1.4</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>Revisit the hierarchy of data types when two different data types are
combined.</p>
</div>
</div>
</div>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<em>(continued)</em><a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<blockquote>
<h3 id="solution-to-challenge-1.4">Solution to challenge 1.4</h3>
<p>The data type of the column “weight” is “character”. The assigned
data type is “double”. Combining two data types yields the data type
that is higher in the following hierarchy:</p>
<pre><code>logical &lt; integer &lt; double &lt; complex &lt; character</code></pre>
<p>Therefore, the column is still of type character! We need to manually
convert it to “double”. {: .solution}</p>
</blockquote>
<div class="section level4">
<h4 id="convert-the-column-weight-to-the-correct-data-type">5. Convert the column “weight” to the correct data type<a class="anchor" aria-label="anchor" href="#convert-the-column-weight-to-the-correct-data-type"></a>
</h4>
<p>Cat weight are numbers. But the column does not have this data type
yet. Coerce the column to floating point numbers.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Tip 1.5</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<p>The functions to convert data types start with <code>as.</code>. You
can look for the function further up in the manuscript or use the
RStudio auto-complete function: Type “<code>as.</code>” and then press
the TAB key.</p>
</div>
</div>
</div>
</div>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<em>(continued)</em><a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<blockquote>
<h3 id="solution-to-challenge-1.5">Solution to Challenge 1.5</h3>
<p>There are two functions that are synonymous for historic reasons:</p>
<pre><code><span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu">as.double</span><span class="op">(</span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span>
<span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">cats</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></code></pre>
</blockquote>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="some-basic-vector-functions">Some basic vector functions<a class="anchor" aria-label="anchor" href="#some-basic-vector-functions"></a>
</h3>
<p>The combine function, <code>c()</code>, will also append things to an
existing vector:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ab_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span><span class="op">)</span></span>
<span><span class="va">ab_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a" "b"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combine_example</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">ab_vector</span>, <span class="st">'SWC'</span><span class="op">)</span></span>
<span><span class="va">combine_example</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"   "b"   "SWC"</code></pre>
</div>
<p>You can also make series of numbers:</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySeries</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">mySeries</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1.0  1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9  2.0  2.1  2.2  2.3  2.4
[16]  2.5  2.6  2.7  2.8  2.9  3.0  3.1  3.2  3.3  3.4  3.5  3.6  3.7  3.8  3.9
[31]  4.0  4.1  4.2  4.3  4.4  4.5  4.6  4.7  4.8  4.9  5.0  5.1  5.2  5.3  5.4
[46]  5.5  5.6  5.7  5.8  5.9  6.0  6.1  6.2  6.3  6.4  6.5  6.6  6.7  6.8  6.9
[61]  7.0  7.1  7.2  7.3  7.4  7.5  7.6  7.7  7.8  7.9  8.0  8.1  8.2  8.3  8.4
[76]  8.5  8.6  8.7  8.8  8.9  9.0  9.1  9.2  9.3  9.4  9.5  9.6  9.7  9.8  9.9
[91] 10.0</code></pre>
</div>
<p>We can ask a few questions about vectors:</p>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequence_example</span> <span class="op">&lt;-</span> <span class="fl">20</span><span class="op">:</span><span class="fl">25</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">sequence_example</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 20 21</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tail</span><span class="op">(</span><span class="va">sequence_example</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 22 23 24 25</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">sequence_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">sequence_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
<p>We can get individual elements of a vector by using the bracket
notation:</p>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_element</span> <span class="op">&lt;-</span> <span class="va">sequence_example</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">first_element</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 20</code></pre>
</div>
<p>To change a single element, use the bracket on the other side of the
arrow:</p>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequence_example</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">sequence_example</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 30 21 22 23 24 25</code></pre>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Start by making a vector with the numbers 1 through 26. Then,
multiply the vector by 2.</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">Solution to Challenge 2</h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">26</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="lists">Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h3>
<p>Another data structure you’ll want in your bag of tricks is the
<code>list</code>. A list is simpler in some ways than the other types,
because you can put anything you want in it. Remember <em>everything in
the vector must be of the same basic data type</em>, but a list can have
different data types:</p>
<div class="codewrapper sourceCode" id="cb93">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_example</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"a"</span>, <span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">+</span><span class="fl">4i</span><span class="op">)</span></span>
<span><span class="va">list_example</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
[1] 1

[[2]]
[1] "a"

[[3]]
[1] TRUE

[[4]]
[1] 1+4i</code></pre>
</div>
<p>When printing the object structure with <code>str()</code>, we see
the data types of all elements:</p>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">list_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>List of 4
 $ : num 1
 $ : chr "a"
 $ : logi TRUE
 $ : cplx 1+4i</code></pre>
</div>
<p>What is the use of lists? They can <strong>organize data of different
types</strong>. For example, you can organize different tables that
belong together, similar to spreadsheets in Excel. But there are many
other uses, too.</p>
<p>We will see another example that will maybe surprise you in the next
chapter.</p>
<p>To retrieve one of the elements of a list, use the <strong>double
bracket</strong>:</p>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_example</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"</code></pre>
</div>
<p>The elements of lists also can have <strong>names</strong>, they can
be given by prepending them to the values, separated by an equals
sign:</p>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">another_list</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Numbers"</span>, numbers <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, data <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="va">another_list</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$title
[1] "Numbers"

$numbers
 [1]  1  2  3  4  5  6  7  8  9 10

$data
[1] TRUE</code></pre>
</div>
<p>This results in a <strong>named list</strong>. Now we have a new
function of our object! We can access single elements by an additional
way!</p>
<div class="codewrapper sourceCode" id="cb101">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">another_list</span><span class="op">$</span><span class="va">title</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Numbers"</code></pre>
</div>
</div>
<section id="names"><h2 class="section-heading">Names<a class="anchor" aria-label="anchor" href="#names"></a>
</h2>
<hr class="half-width">
<p>With names, we can give meaning to elements. It is the first time
that we do not only have the <strong>data</strong>, but also explaining
information. It is <em>metadata</em> that can be stuck to the object
like a label. In R, this is called an <strong>attribute</strong>. Some
attributes enable us to do more with our object, for example, like here,
accessing an element by a self-defined name.</p>
<div class="section level3">
<h3 id="accessing-vectors-and-lists-by-name">Accessing vectors and lists by name<a class="anchor" aria-label="anchor" href="#accessing-vectors-and-lists-by-name"></a>
</h3>
<p>We have already seen how to generate a named list. The way to
generate a named vector is very similar. You have seen this function
before:</p>
<div class="codewrapper sourceCode" id="cb103">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pizza_price</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span> pizzasubito <span class="op">=</span> <span class="fl">5.64</span>, pizzafresh <span class="op">=</span> <span class="fl">6.60</span>, callapizza <span class="op">=</span> <span class="fl">4.50</span> <span class="op">)</span></span></code></pre>
</div>
<p>The way to retrieve elements is different, though:</p>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pizza_price</span><span class="op">[</span><span class="st">"pizzasubito"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">pizzasubito</span> </span>
<span>       <span class="fl">5.64</span> </span></code></pre>
</div>
<p>The approach used for the list does not work:</p>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pizza_price</span><span class="op">$</span><span class="va">pizzafresh</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in pizza_price$pizzafresh: $ operator is invalid for atomic vectors</code></pre>
</div>
<p>It will pay off if you remember this error message, you will meet it
in your own analyses. It means that you have just tried accessing an
element like it was in a list, but it is actually in a vector.</p>
</div>
<div class="section level3">
<h3 id="accessing-and-changing-names">Accessing and changing names<a class="anchor" aria-label="anchor" href="#accessing-and-changing-names"></a>
</h3>
<p>If you are only interested in the names, use the <code>names()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">pizza_price</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "pizzasubito" "pizzafresh"  "callapizza" </code></pre>
</div>
<p>We have seen how to access and change single elements of a vector.
The same is possible for names:</p>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">pizza_price</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "callapizza"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">pizza_price</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"call-a-pizza"</span></span>
<span><span class="va">pizza_price</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> pizzasubito   pizzafresh call-a-pizza 
        5.64         6.60         4.50 </code></pre>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<ul>
<li>What is the data type of the names of <code>pizza_price</code>? You
can find out using the <code>str()</code> or <code>typeof()</code>
functions.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">Solution to Challenge 3</h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" data-bs-parent="#accordionSolution9" aria-labelledby="headingSolution9">
<div class="accordion-body">
<p>You get the names of an object by wrapping the object name inside
<code>names(...)</code>. Similarly, you get the data type of the names
by again wrapping the whole code in <code>typeof(...)</code>:</p>
<pre><code><span><span class="fu">typeof</span><span class="op">(</span><span class="fu">names</span><span class="op">(</span><span class="va">pizza</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>alternatively, use a new variable if this is easier for you to
read:</p>
<pre><code><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">names</span><span class="op">(</span><span class="va">pizza</span><span class="op">)</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>Instead of just changing some of the names a vector/list already has,
you can also set all names of an object by writing code like (replace
ALL CAPS text):</p>
<pre><code><span><span class="fu">names</span><span class="op">(</span> <span class="va">OBJECT</span> <span class="op">)</span> <span class="op">&lt;-</span>  <span class="va">CHARACTER_VECTOR</span></span></code></pre>
<p>Create a vector that gives the number for each letter in the
alphabet!</p>
<ol style="list-style-type: decimal">
<li>Generate a vector called <code>letter_no</code> with the sequence of
numbers from 1 to 26!</li>
<li>R has a built-in object called <code>LETTERS</code>. It is a
26-character vector, from A to Z. Set the names of the number sequence
to this 26 letters</li>
<li>Test yourself by calling <code>letter_no["B"]</code>, which should
give you the number 2!</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">Solution to Challenge 4</h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" data-bs-parent="#accordionSolution10" aria-labelledby="headingSolution10">
<div class="accordion-body">
<pre><code><span><span class="va">letter_no</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">26</span>   <span class="co"># or seq(1,26)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">letter_no</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span></span>
<span><span class="va">letter_no</span><span class="op">[</span><span class="st">"B"</span><span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="data-frames"><h2 class="section-heading">Data frames<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h2>
<hr class="half-width">
<p>We have data frames at the very beginning of this lesson, they
represent a table of data. We didn’t go much further into detail with
our example cat data frame:</p>
<div class="codewrapper sourceCode" id="cb118">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string
1 calico    2.1         TRUE
2  black    5.0        FALSE
3  tabby    3.2         TRUE</code></pre>
</div>
<p>We can now understand something a bit surprising in our data.frame;
what happens if we run:</p>
<div class="codewrapper sourceCode" id="cb120">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "list"</code></pre>
</div>
<p>We see that data.frames look like lists ‘under the hood’. Think again
what we heard about what lists can be used for:</p>
<blockquote>
<p>Lists organize data of different types</p>
</blockquote>
<p>Columns of a data frame are vectors of different types, that are
organized by belonging to the same table.</p>
<p>A data.frame is really a list of vectors. It is a special list in
which all the vectors must have the same length.</p>
<p>How is this “special”-ness written into the object, so that R does
not treat it like any other list, but as a table?</p>
<div class="codewrapper sourceCode" id="cb122">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data.frame"</code></pre>
</div>
<p>A <strong>class</strong>, just like names, is an attribute attached
to the object. It tells us what this object means for humans.</p>
<p>You might wonder: Why do we need another
what-type-of-object-is-this-function? We already have
<code>typeof()</code>? That function tells us how the object is
<strong>constructed in the computer</strong>. The <code>class</code> is
the <strong>meaning of the object for humans</strong>. Consequently,
what <code>typeof()</code> returns is <em>fixed</em> in R (mainly the
five data types), whereas the output of <code>class()</code> is
<em>diverse</em> and <em>extendable</em> by R packages.</p>
<p>In our <code>cats</code> example, we have an integer, a double and a
logical variable. As we have seen already, each column of data.frame is
a vector.</p>
<div class="codewrapper sourceCode" id="cb124">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">coat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico" "black"  "tabby" </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb126">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico" "black"  "tabby" </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb128">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">cats</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb130">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">cats</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "calico" "black" "tabby"</code></pre>
</div>
<p>Each row is an <em>observation</em> of different variables, itself a
data.frame, and thus can be composed of elements of different types.</p>
<div class="codewrapper sourceCode" id="cb132">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string
1 calico    2.1         TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb134">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">cats</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "list"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb136">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">cats</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	1 obs. of  3 variables:
 $ coat        : chr "calico"
 $ weight      : num 2.1
 $ likes_string: logi TRUE</code></pre>
</div>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5<a class="anchor" aria-label="anchor" href="#challenge-5"></a>
</h3>
<div class="callout-content">
<p>There are several subtly different ways to call variables,
observations and elements from data.frames:</p>
<ul>
<li><code>cats[1]</code></li>
<li><code>cats[[1]]</code></li>
<li><code>cats$coat</code></li>
<li><code>cats["coat"]</code></li>
<li><code>cats[1, 1]</code></li>
<li><code>cats[, 1]</code></li>
<li><code>cats[1, ]</code></li>
</ul>
<p>Try out these examples and explain what is returned by each one.</p>
<p><em>Hint:</em> Use the function <code>typeof()</code> to examine what
is returned in each case.</p>
</div>
</div>
</div>
<div id="accordionSolution11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution11" aria-expanded="false" aria-controls="collapseSolution11">
  <h4 class="accordion-header" id="headingSolution11">Solution to Challenge 5</h4>
</button>
<div id="collapseSolution11" class="accordion-collapse collapse" data-bs-parent="#accordionSolution11" aria-labelledby="headingSolution11">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb138">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat
1 calico
2  black
3  tabby</code></pre>
</div>
<p>We can think of a data frame as a list of vectors. The single brace
<code>[1]</code> returns the first slice of the list, as another list.
In this case it is the first column of the data frame.</p>
<div class="codewrapper sourceCode" id="cb140">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico" "black"  "tabby" </code></pre>
</div>
<p>The double brace <code>[[1]]</code> returns the contents of the list
item. In this case it is the contents of the first column, a
<em>vector</em> of type <em>character</em>.</p>
<div class="codewrapper sourceCode" id="cb142">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">$</span><span class="va">coat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico" "black"  "tabby" </code></pre>
</div>
<p>This example uses the <code>$</code> character to address items by
name. <em>coat</em> is the first column of the data frame, again a
<em>vector</em> of type <em>character</em>.</p>
<div class="codewrapper sourceCode" id="cb144">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span><span class="st">"coat"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat
1 calico
2  black
3  tabby</code></pre>
</div>
<p>Here we are using a single brace <code>["coat"]</code> replacing the
index number with the column name. Like example 1, the returned object
is a <em>list</em>.</p>
<div class="codewrapper sourceCode" id="cb146">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico"</code></pre>
</div>
<p>This example uses a single brace, but this time we provide row and
column coordinates. The returned object is the value in row 1, column 1.
The object is a <em>vector</em> of type <em>character</em>.</p>
<div class="codewrapper sourceCode" id="cb148">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "calico" "black"  "tabby" </code></pre>
</div>
<p>Like the previous example we use single braces and provide row and
column coordinates. The row coordinate is not specified, R interprets
this missing value as all the elements in this <em>column</em> and
returns them as a <em>vector</em>.</p>
<div class="codewrapper sourceCode" id="cb150">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string
1 calico    2.1         TRUE</code></pre>
</div>
<p>Again we use the single brace with row and column coordinates. The
column coordinate is not specified. The return value is a <em>list</em>
containing all the values in the first row.</p>
</div>
</div>
</div>
</div>
<div id="tip-renaming-data-frame-columns" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-renaming-data-frame-columns" class="callout-inner">
<h3 class="callout-title">Tip: Renaming data frame columns<a class="anchor" aria-label="anchor" href="#tip-renaming-data-frame-columns"></a>
</h3>
<div class="callout-content">
<p>Data frames have column names, which can be accessed with the
<code>names()</code> function.</p>
<div class="codewrapper sourceCode" id="cb152">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "coat"         "weight"       "likes_string"</code></pre>
</div>
<p>If you want to rename the second column of <code>cats</code>, you can
assign a new name to the second element of <code>names(cats)</code>.</p>
<div class="codewrapper sourceCode" id="cb154">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"weight_kg"</span></span>
<span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight_kg likes_string
1 calico       2.1         TRUE
2  black       5.0        FALSE
3  tabby       3.2         TRUE</code></pre>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="matrices">Matrices<a class="anchor" aria-label="anchor" href="#matrices"></a>
</h3>
<p>Last but not least is the matrix. We can declare a matrix full of
zeros:</p>
<div class="codewrapper sourceCode" id="cb156">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrix_example</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">0</span>, ncol<span class="op">=</span><span class="fl">6</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">matrix_example</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    0    0    0
[2,]    0    0    0    0    0    0
[3,]    0    0    0    0    0    0</code></pre>
</div>
<p>What makes it special is the <code>dim()</code> attribute:</p>
<div class="codewrapper sourceCode" id="cb158">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3 6</code></pre>
</div>
<p>And similar to other data structures, we can ask things about our
matrix:</p>
<div class="codewrapper sourceCode" id="cb160">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb162">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "matrix" "array" </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb164">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:3, 1:6] 0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb166">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nrow</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb168">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ncol</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6</code></pre>
</div>
<div id="challenge-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6<a class="anchor" aria-label="anchor" href="#challenge-6"></a>
</h3>
<div class="callout-content">
<p>What do you think will be the result of
<code>length(matrix_example)</code>? Try it. Were you right? Why / why
not?</p>
</div>
</div>
</div>
<div id="accordionSolution12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution12" aria-expanded="false" aria-controls="collapseSolution12">
  <h4 class="accordion-header" id="headingSolution12">Solution to Challenge 6</h4>
</button>
<div id="collapseSolution12" class="accordion-collapse collapse" data-bs-parent="#accordionSolution12" aria-labelledby="headingSolution12">
<div class="accordion-body">
<p>What do you think will be the result of
<code>length(matrix_example)</code>?</p>
<div class="codewrapper sourceCode" id="cb170">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrix_example</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">0</span>, ncol<span class="op">=</span><span class="fl">6</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">matrix_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 18</code></pre>
</div>
<p>Because a matrix is a vector with added dimension attributes,
<code>length</code> gives you the total number of elements in the
matrix.</p>
</div>
</div>
</div>
</div>
<div id="challenge-7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7" class="callout-inner">
<h3 class="callout-title">Challenge 7<a class="anchor" aria-label="anchor" href="#challenge-7"></a>
</h3>
<div class="callout-content">
<p>Make another matrix, this time containing the numbers 1:50, with 5
columns and 10 rows. Did the <code>matrix</code> function fill your
matrix by column, or by row, as its default behaviour? See if you can
figure out how to change this. (hint: read the documentation for
<code>matrix</code>!)</p>
</div>
</div>
</div>
<div id="accordionSolution13" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution13" aria-expanded="false" aria-controls="collapseSolution13">
  <h4 class="accordion-header" id="headingSolution13">Solution to Challenge 7</h4>
</button>
<div id="collapseSolution13" class="accordion-collapse collapse" data-bs-parent="#accordionSolution13" aria-labelledby="headingSolution13">
<div class="accordion-body">
<p>Make another matrix, this time containing the numbers 1:50, with 5
columns and 10 rows. Did the <code>matrix</code> function fill your
matrix by column, or by row, as its default behaviour? See if you can
figure out how to change this. (hint: read the documentation for
<code>matrix</code>!)</p>
<div class="codewrapper sourceCode" id="cb172">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, ncol<span class="op">=</span><span class="fl">5</span>, nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, ncol<span class="op">=</span><span class="fl">5</span>, nrow<span class="op">=</span><span class="fl">10</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># to fill by row</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-8" class="callout-inner">
<h3 class="callout-title">Challenge 8<a class="anchor" aria-label="anchor" href="#challenge-8"></a>
</h3>
<div class="callout-content">
<p>Create a list of length two containing a character vector for each of
the sections in this part of the workshop:</p>
<ul>
<li>Data types</li>
<li>Data structures</li>
</ul>
<p>Populate each character vector with the names of the data types and
data structures we’ve seen so far.</p>
</div>
</div>
</div>
<div id="accordionSolution14" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution14" aria-expanded="false" aria-controls="collapseSolution14">
  <h4 class="accordion-header" id="headingSolution14">Solution to Challenge 8</h4>
</button>
<div id="collapseSolution14" class="accordion-collapse collapse" data-bs-parent="#accordionSolution14" aria-labelledby="headingSolution14">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb173">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataTypes</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'double'</span>, <span class="st">'complex'</span>, <span class="st">'integer'</span>, <span class="st">'character'</span>, <span class="st">'logical'</span><span class="op">)</span></span>
<span><span class="va">dataStructures</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'data.frame'</span>, <span class="st">'vector'</span>, <span class="st">'list'</span>, <span class="st">'matrix'</span><span class="op">)</span></span>
<span><span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="va">dataTypes</span>, <span class="va">dataStructures</span><span class="op">)</span></span></code></pre>
</div>
<p>Note: it’s nice to make a list in big writing on the board or taped
to the wall listing all of these types and structures - leave it up for
the rest of the workshop to remind people of the importance of these
basics.</p>
</div>
</div>
</div>
</div>
<div id="challenge-9" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-9" class="callout-inner">
<h3 class="callout-title">Challenge 9<a class="anchor" aria-label="anchor" href="#challenge-9"></a>
</h3>
<div class="callout-content">
<p>Consider the R output of the matrix below:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2]
[1,]    4    1
[2,]    9    5
[3,]   10    7</code></pre>
</div>
<p>What was the correct command used to write this matrix? Examine each
command and try to figure out the correct one before typing them. Think
about what matrices the other commands will produce.</p>
<ol style="list-style-type: decimal">
<li><code>matrix(c(4, 1, 9, 5, 10, 7), nrow = 3)</code></li>
<li><code>matrix(c(4, 9, 10, 1, 5, 7), ncol = 2, byrow = TRUE)</code></li>
<li><code>matrix(c(4, 9, 10, 1, 5, 7), nrow = 2)</code></li>
<li><code>matrix(c(4, 1, 9, 5, 10, 7), ncol = 2, byrow = TRUE)</code></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution15" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution15" aria-expanded="false" aria-controls="collapseSolution15">
  <h4 class="accordion-header" id="headingSolution15">Solution to Challenge 9</h4>
</button>
<div id="collapseSolution15" class="accordion-collapse collapse" data-bs-parent="#accordionSolution15" aria-labelledby="headingSolution15">
<div class="accordion-body">
<p>Consider the R output of the matrix below:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2]
[1,]    4    1
[2,]    9    5
[3,]   10    7</code></pre>
</div>
<p>What was the correct command used to write this matrix? Examine each
command and try to figure out the correct one before typing them. Think
about what matrices the other commands will produce.</p>
<div class="codewrapper sourceCode" id="cb176">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">7</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>read.csv</code> to read tabular data in R.</li>
<li>The basic data types in R are double, integer, complex, logical, and
character.</li>
<li>Data structures such as data frames or matrices are built on top of
lists and vectors, with some added attributes.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-data-structures-part2"><p>Content from <a href="05-data-structures-part2.html">Exploring Data Frames</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/05-data-structures-part2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I manipulate a data frame?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Add and remove rows or columns.</li>
<li>Append two data frames.</li>
<li>Display basic properties of data frames including size and class of
the columns, names, and first few rows.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>At this point, you’ve seen it all: in the last lesson, we toured all
the basic data types and data structures in R. Everything you do will be
a manipulation of those tools. But most of the time, the star of the
show is the data frame—the table that we created by loading information
from a csv file. In this lesson, we’ll learn a few more things about
working with data frames.</p>
<section id="adding-columns-and-rows-in-data-frames"><h2 class="section-heading">Adding columns and rows in data frames<a class="anchor" aria-label="anchor" href="#adding-columns-and-rows-in-data-frames"></a>
</h2>
<hr class="half-width">
<p>We already learned that the columns of a data frame are vectors, so
that our data are consistent in type throughout the columns. As such, if
we want to add a new column, we can start by making a new vector:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string
1 calico    2.1            1
2  black    5.0            0
3  tabby    3.2            1</code></pre>
</div>
<p>We can then add this as a column via:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cbind</span><span class="op">(</span><span class="va">cats</span>, <span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string age
1 calico    2.1            1   2
2  black    5.0            0   3
3  tabby    3.2            1   5</code></pre>
</div>
<p>Note that if we tried to add a vector of ages with a different number
of entries than the number of rows in the data frame, it would fail:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu">cbind</span><span class="op">(</span><span class="va">cats</span>, <span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data.frame(..., check.names = FALSE): arguments imply differing number of rows: 3, 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">cbind</span><span class="op">(</span><span class="va">cats</span>, <span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data.frame(..., check.names = FALSE): arguments imply differing number of rows: 3, 2</code></pre>
</div>
<p>Why didn’t this work? Of course, R wants to see one element in our
new column for every row in the table:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nrow</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<p>So for it to work we need to have <code>nrow(cats)</code> =
<code>length(age)</code>. Let’s overwrite the content of cats with our
new data frame.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">cats</span>, <span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<p>Now how about adding rows? We already know that the rows of a data
frame are lists:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newRow</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="st">"tortoiseshell"</span>, <span class="fl">3.3</span>, <span class="cn">TRUE</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">cats</span>, <span class="va">newRow</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s confirm that our new row was added correctly.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           coat weight likes_string age
1        calico    2.1            1   2
2         black    5.0            0   3
3         tabby    3.2            1   5
4 tortoiseshell    3.3            1   9</code></pre>
</div>
</section><section id="removing-rows"><h2 class="section-heading">Removing rows<a class="anchor" aria-label="anchor" href="#removing-rows"></a>
</h2>
<hr class="half-width">
<p>We now know how to add rows and columns to our data frame in R. Now
let’s learn to remove rows.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           coat weight likes_string age
1        calico    2.1            1   2
2         black    5.0            0   3
3         tabby    3.2            1   5
4 tortoiseshell    3.3            1   9</code></pre>
</div>
<p>We can ask for a data frame minus the last row:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    coat weight likes_string age
1 calico    2.1            1   2
2  black    5.0            0   3
3  tabby    3.2            1   5</code></pre>
</div>
<p>Notice the comma with nothing after it to indicate that we want to
drop the entire fourth row.</p>
<p>Note: we could also remove several rows at once by putting the row
numbers inside of a vector, for example:
<code>cats[c(-3,-4), ]</code></p>
</section><section id="removing-columns"><h2 class="section-heading">Removing columns<a class="anchor" aria-label="anchor" href="#removing-columns"></a>
</h2>
<hr class="half-width">
<p>We can also remove columns in our data frame. What if we want to
remove the column “age”. We can remove it in two ways, by variable
number or by index.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span><span class="op">[</span>,<span class="op">-</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           coat weight likes_string
1        calico    2.1            1
2         black    5.0            0
3         tabby    3.2            1
4 tortoiseshell    3.3            1</code></pre>
</div>
<p>Notice the comma with nothing before it, indicating we want to keep
all of the rows.</p>
<p>Alternatively, we can drop the column by using the index name and the
<code>%in%</code> operator. The <code>%in%</code> operator goes through
each element of its left argument, in this case the names of
<code>cats</code>, and asks, “Does this element occur in the second
argument?”</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drop</span> <span class="op">&lt;-</span> <span class="fu">names</span><span class="op">(</span><span class="va">cats</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span></span>
<span><span class="va">cats</span><span class="op">[</span>,<span class="op">!</span><span class="va">drop</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           coat weight likes_string
1        calico    2.1            1
2         black    5.0            0
3         tabby    3.2            1
4 tortoiseshell    3.3            1</code></pre>
</div>
<p>We will cover subsetting with logical operators like
<code>%in%</code> in more detail in the next episode. See the section <a href="06-data-subsetting.html">Subsetting through other logical
operations</a></p>
</section><section id="appending-to-a-data-frame"><h2 class="section-heading">Appending to a data frame<a class="anchor" aria-label="anchor" href="#appending-to-a-data-frame"></a>
</h2>
<hr class="half-width">
<p>The key to remember when adding data to a data frame is that
<em>columns are vectors and rows are lists.</em> We can also glue two
data frames together with <code>rbind</code>:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">cats</span>, <span class="va">cats</span><span class="op">)</span></span>
<span><span class="va">cats</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           coat weight likes_string age
1        calico    2.1            1   2
2         black    5.0            0   3
3         tabby    3.2            1   5
4 tortoiseshell    3.3            1   9
5        calico    2.1            1   2
6         black    5.0            0   3
7         tabby    3.2            1   5
8 tortoiseshell    3.3            1   9</code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>You can create a new data frame right from within R with the
following syntax:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>id <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>                 x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Make a data frame that holds the following information for
yourself:</p>
<ul>
<li>first name</li>
<li>last name</li>
<li>lucky number</li>
</ul>
<p>Then use <code>rbind</code> to add an entry for the people sitting
beside you. Finally, use <code>cbind</code> to add a column with each
person’s answer to the question, “Is it time for coffee break?”</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>first <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Grace"</span><span class="op">)</span>,</span>
<span>                 last <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Hopper"</span><span class="op">)</span>,</span>
<span>                 lucky_number <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">df</span>, <span class="fu">list</span><span class="op">(</span><span class="st">"Marie"</span>, <span class="st">"Curie"</span>, <span class="fl">238</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">df</span>, coffeetime <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="realistic-example"><h2 class="section-heading">Realistic example<a class="anchor" aria-label="anchor" href="#realistic-example"></a>
</h2>
<hr class="half-width">
<p>So far, you have seen the basics of manipulating data frames with our
cat data; now let’s use those skills to digest a more realistic dataset.
Let’s read in the <code>gapminder</code> dataset that we downloaded
previously:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/gapminder_data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div id="miscellaneous-tips" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="miscellaneous-tips" class="callout-inner">
<h3 class="callout-title">Miscellaneous Tips<a class="anchor" aria-label="anchor" href="#miscellaneous-tips"></a>
</h3>
<div class="callout-content">
<ul>
<li><p>Another type of file you might encounter are tab-separated value
files (.tsv). To specify a tab as a separator, use <code>"\\t"</code> or
<code>read.delim()</code>.</p></li>
<li><p>Files can also be downloaded directly from the Internet into a
local folder of your choice onto your computer using the
<code>download.file</code> function. The <code>read.csv</code> function
can then be executed to read the downloaded file from the download
location, for example,</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/swcarpentry/r-novice-gapminder/main/episodes/data/gapminder_data.csv"</span>, destfile <span class="op">=</span> <span class="st">"data/gapminder_data.csv"</span><span class="op">)</span></span>
<span><span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/gapminder_data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>Alternatively, you can also read in files directly into R from the
Internet by replacing the file paths with a web address in
<code>read.csv</code>. One should note that in doing this no local copy
of the csv file is first saved onto your computer. For example,</li>
</ul>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/swcarpentry/r-novice-gapminder/main/episodes/data/gapminder_data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li><p>You can read directly from excel spreadsheets without converting
them to plain text first by using the <a href="https://cran.r-project.org/package=readxl" class="external-link">readxl</a>
package.</p></li>
<li><p>The argument “stringsAsFactors” can be useful to tell R how to
read strings either as factors or as character strings. In R versions
after 4.0, all strings are read-in as characters by default, but in
earlier versions of R, strings are read-in as factors by default. For
more information, see the call-out in <a href="https://swcarpentry.github.io/r-novice-gapminder/04-data-structures-part1.html#check-your-data-for-factors" class="external-link">the
previous episode</a>.</p></li>
</ul>
</div>
</div>
</div>
<p>Let’s investigate gapminder a bit; the first thing we should always
do is check out what the data looks like with <code>str</code>:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	1704 obs. of  6 variables:
 $ country  : chr  "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...
 $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ pop      : num  8425333 9240934 10267083 11537966 13079460 ...
 $ continent: chr  "Asia" "Asia" "Asia" "Asia" ...
 $ lifeExp  : num  28.8 30.3 32 34 36.1 ...
 $ gdpPercap: num  779 821 853 836 740 ...</code></pre>
</div>
<p>An additional method for examining the structure of gapminder is to
use the <code>summary</code> function. This function can be used on
various objects in R. For data frames, <code>summary</code> yields a
numeric, tabular, or descriptive summary of each column. Numeric or
integer columns are described by the descriptive statistics (quartiles
and mean), and character columns by its length, class, and mode.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   country               year           pop             continent        
 Length:1704        Min.   :1952   Min.   :6.001e+04   Length:1704       
 Class :character   1st Qu.:1966   1st Qu.:2.794e+06   Class :character  
 Mode  :character   Median :1980   Median :7.024e+06   Mode  :character  
                    Mean   :1980   Mean   :2.960e+07                     
                    3rd Qu.:1993   3rd Qu.:1.959e+07                     
                    Max.   :2007   Max.   :1.319e+09                     
    lifeExp        gdpPercap       
 Min.   :23.60   Min.   :   241.2  
 1st Qu.:48.20   1st Qu.:  1202.1  
 Median :60.71   Median :  3531.8  
 Mean   :59.47   Mean   :  7215.3  
 3rd Qu.:70.85   3rd Qu.:  9325.5  
 Max.   :82.60   Max.   :113523.1  </code></pre>
</div>
<p>Along with the <code>str</code> and <code>summary</code> functions,
we can examine individual columns of the data frame with our
<code>typeof</code> function:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:1704] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...</code></pre>
</div>
<p>We can also interrogate the data frame for information about its
dimensions; remembering that <code>str(gapminder)</code> said there were
1704 observations of 6 variables in gapminder, what do you think the
following will produce, and why?</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6</code></pre>
</div>
<p>A fair guess would have been to say that the length of a data frame
would be the number of rows it has (1704), but this is not the case;
remember, a data frame is a <em>list of vectors and factors</em>:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "list"</code></pre>
</div>
<p>When <code>length</code> gave us 6, it’s because gapminder is built
out of a list of 6 columns. To get the number of rows and columns in our
dataset, try:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nrow</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1704</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ncol</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6</code></pre>
</div>
<p>Or, both at once:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1704    6</code></pre>
</div>
<p>We’ll also likely want to know what the titles of all the columns
are, so we can ask for them later:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "country"   "year"      "pop"       "continent" "lifeExp"   "gdpPercap"</code></pre>
</div>
<p>At this stage, it’s important to ask ourselves if the structure R is
reporting matches our intuition or expectations; do the basic data types
reported for each column make sense? If not, we need to sort any
problems out now before they turn into bad surprises down the road,
using what we’ve learned about how R interprets data, and the importance
of <em>strict consistency</em> in how we record our data.</p>
<p>Once we’re happy that the data types and structures seem reasonable,
it’s time to start digging into our data proper. Check out the first few
lines:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap
1 Afghanistan 1952  8425333      Asia  28.801  779.4453
2 Afghanistan 1957  9240934      Asia  30.332  820.8530
3 Afghanistan 1962 10267083      Asia  31.997  853.1007
4 Afghanistan 1967 11537966      Asia  34.020  836.1971
5 Afghanistan 1972 13079460      Asia  36.088  739.9811
6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>It’s good practice to also check the last few lines of your data and
some in the middle. How would you do this?</p>
<p>Searching for ones specifically in the middle isn’t too hard, but we
could ask for a few lines at random. How would you code this?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>To check the last few lines it’s relatively simple as R already has a
function for this:</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tail</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span>
<span><span class="fu">tail</span><span class="op">(</span><span class="va">gapminder</span>, n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre>
</div>
<p>What about a few arbitrary rows just in case something is odd in the
middle?</p>
<div class="section level2">
<h2 id="tip-there-are-several-ways-to-achieve-this-">Tip: There are several ways to achieve this.<a class="anchor" aria-label="anchor" href="#tip-there-are-several-ways-to-achieve-this-"></a>
</h2>
<p>The solution here presents one form of using nested functions, i.e. a
function passed as an argument to another function. This might sound
like a new concept, but you are already using it! Remember
my_dataframe[rows, cols] will print to screen your data frame with the
number of rows and columns you asked for (although you might have asked
for a range or named columns for example). How would you get the last
row if you don’t know how many rows your data frame has? R has a
function for this. What about getting a (pseudorandom) sample? R also
has a function for this.</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span><span class="fu">sample</span><span class="op">(</span><span class="fu">nrow</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p>To make sure our analysis is reproducible, we should put the code
into a script file so we can come back to it later.</p>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Go to file -&gt; new file -&gt; R script, and write an R script to
load in the gapminder dataset. Put it in the <code>scripts/</code>
directory and add it to version control.</p>
<p>Run the script using the <code>source</code> function, using the file
path as its argument (or by pressing the “source” button in
RStudio).</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The <code>source</code> function can be used to use a script within a
script. Assume you would like to load the same type of file over and
over again and therefore you need to specify the arguments to fit the
needs of your file. Instead of writing the necessary argument again and
again you could just write it once and save it as a script. Then, you
can use <code>source("Your_Script_containing_the_load_function")</code>
in a new script to use the function of that script without writing
everything again. Check out <code>?source</code> to find out more.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/swcarpentry/r-novice-gapminder/main/episodes/data/gapminder_data.csv"</span>, destfile <span class="op">=</span> <span class="st">"data/gapminder_data.csv"</span><span class="op">)</span></span>
<span><span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/gapminder_data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>To run the script and load the data into the <code>gapminder</code>
variable:</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">source</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"scripts/load-gapminder.R"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>Read the output of <code>str(gapminder)</code> again; this time, use
what you’ve learned about lists and vectors, as well as the output of
functions like <code>colnames</code> and <code>dim</code> to explain
what everything that <code>str</code> prints out for gapminder means. If
there are any parts you can’t interpret, discuss with your
neighbors!</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to Challenge 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>The object <code>gapminder</code> is a data frame with columns</p>
<ul>
<li>
<code>country</code> and <code>continent</code> are character
strings.</li>
<li>
<code>year</code> is an integer vector.</li>
<li>
<code>pop</code>, <code>lifeExp</code>, and <code>gdpPercap</code>
are numeric vectors.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>cbind()</code> to add a new column to a data frame.</li>
<li>Use <code>rbind()</code> to add a new row to a data frame.</li>
<li>Remove rows from a data frame.</li>
<li>Use <code>str()</code>, <code>summary()</code>, <code>nrow()</code>,
<code>ncol()</code>, <code>dim()</code>, <code>colnames()</code>,
<code>head()</code>, and <code>typeof()</code> to understand the
structure of a data frame.</li>
<li>Read in a csv file using <code>read.csv()</code>.</li>
<li>Understand what <code>length()</code> of a data frame
represents.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-06-data-subsetting"><p>Content from <a href="06-data-subsetting.html">Subsetting Data</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/06-data-subsetting.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I work with subsets of data in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To be able to subset vectors, factors, matrices, lists, and data
frames</li>
<li>To be able to extract individual and multiple elements: by index, by
name, using comparison operations</li>
<li>To be able to skip and remove elements from various data
structures.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>R has many powerful subset operators. Mastering them will allow you
to easily perform complex operations on any kind of dataset.</p>
<p>There are six different ways we can subset any kind of object, and
three different subsetting operators for the different data
structures.</p>
<p>Let’s start with the workhorse of R: a simple numeric vector.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.4</span>, <span class="fl">6.2</span>, <span class="fl">7.1</span>, <span class="fl">4.8</span>, <span class="fl">7.5</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   b   c   d   e 
5.4 6.2 7.1 4.8 7.5 </code></pre>
</div>
<div id="atomic-vectors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="atomic-vectors" class="callout-inner">
<h3 class="callout-title">Atomic vectors<a class="anchor" aria-label="anchor" href="#atomic-vectors"></a>
</h3>
<div class="callout-content">
<p>In R, simple vectors containing character strings, numbers, or
logical values are called <em>atomic</em> vectors because they can’t be
further simplified.</p>
</div>
</div>
</div>
<p>So now that we’ve created a dummy vector to play with, how do we get
at its contents?</p>
<section id="accessing-elements-using-their-indices"><h2 class="section-heading">Accessing elements using their indices<a class="anchor" aria-label="anchor" href="#accessing-elements-using-their-indices"></a>
</h2>
<hr class="half-width">
<p>To extract elements of a vector we can give their corresponding
index, starting from one:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>  <span class="va">a</span> </span>
<span><span class="fl">5.4</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>  <span class="va">d</span> </span>
<span><span class="fl">4.8</span> </span></code></pre>
</div>
<p>It may look different, but the square brackets operator is a
function. For vectors (and matrices), it means “get me the nth
element”.</p>
<p>We can ask for multiple elements at once:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   c 
5.4 7.1 </code></pre>
</div>
<p>Or slices of the vector:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   b   c   d 
5.4 6.2 7.1 4.8 </code></pre>
</div>
<p>the <code>:</code> operator creates a sequence of numbers from the
left element to the right.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4</code></pre>
</div>
<p>We can ask for the same element multiple times:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   a   c 
5.4 5.4 7.1 </code></pre>
</div>
<p>If we ask for an index beyond the length of the vector, R will return
a missing value:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;NA&gt; 
  NA </code></pre>
</div>
<p>This is a vector of length one containing an <code>NA</code>, whose
name is also <code>NA</code>.</p>
<p>If we ask for the 0th element, we get an empty vector:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>named numeric(0)</code></pre>
</div>
<div id="vector-numbering-in-r-starts-at-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="vector-numbering-in-r-starts-at-1" class="callout-inner">
<h3 class="callout-title">Vector numbering in R starts at 1<a class="anchor" aria-label="anchor" href="#vector-numbering-in-r-starts-at-1"></a>
</h3>
<div class="callout-content">
<p>In many programming languages (C and Python, for example), the first
element of a vector has an index of 0. In R, the first element is 1.</p>
</div>
</div>
</div>
</section><section id="skipping-and-removing-elements"><h2 class="section-heading">Skipping and removing elements<a class="anchor" aria-label="anchor" href="#skipping-and-removing-elements"></a>
</h2>
<hr class="half-width">
<p>If we use a negative number as the index of a vector, R will return
every element <em>except</em> for the one specified:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   c   d   e 
5.4 7.1 4.8 7.5 </code></pre>
</div>
<p>We can skip multiple elements:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>  <span class="co"># or x[-c(1,5)]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d 
6.2 7.1 4.8 </code></pre>
</div>
<div id="tip-order-of-operations" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-order-of-operations" class="callout-inner">
<h3 class="callout-title">Tip: Order of operations<a class="anchor" aria-label="anchor" href="#tip-order-of-operations"></a>
</h3>
<div class="callout-content">
<p>A common trip up for novices occurs when trying to skip slices of a
vector. It’s natural to try to negate a sequence like so:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<p>This gives a somewhat cryptic error:</p>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in x[-1:3]: only 0's may be mixed with negative subscripts</code></pre>
</div>
<p>But remember the order of operations. <code>:</code> is really a
function. It takes its first argument as -1, and its second as 3, so
generates the sequence of numbers: <code>c(-1, 0, 1, 2, 3)</code>.</p>
<p>The correct solution is to wrap that function call in brackets, so
that the <code>-</code> operator applies to the result:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  d   e 
4.8 7.5 </code></pre>
</div>
</div>
</div>
</div>
<p>To remove elements from a vector, we need to assign the result back
into the variable:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   b   c   e 
5.4 6.2 7.1 7.5 </code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Given the following code:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.4</span>, <span class="fl">6.2</span>, <span class="fl">7.1</span>, <span class="fl">4.8</span>, <span class="fl">7.5</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   b   c   d   e 
5.4 6.2 7.1 4.8 7.5 </code></pre>
</div>
<p>Come up with at least 2 different commands that will produce the
following output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d 
6.2 7.1 4.8 </code></pre>
</div>
<p>After you find 2 different commands, compare notes with your
neighbour. Did you have different strategies?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d 
6.2 7.1 4.8 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d 
6.2 7.1 4.8 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d 
6.2 7.1 4.8 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="subsetting-by-name"><h2 class="section-heading">Subsetting by name<a class="anchor" aria-label="anchor" href="#subsetting-by-name"></a>
</h2>
<hr class="half-width">
<p>We can extract elements by using their name, instead of extracting by
index:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>a<span class="op">=</span><span class="fl">5.4</span>, b<span class="op">=</span><span class="fl">6.2</span>, c<span class="op">=</span><span class="fl">7.1</span>, d<span class="op">=</span><span class="fl">4.8</span>, e<span class="op">=</span><span class="fl">7.5</span><span class="op">)</span> <span class="co"># we can name a vector 'on the fly'</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   c 
5.4 7.1 </code></pre>
</div>
<p>This is usually a much more reliable way to subset objects: the
position of various elements can often change when chaining together
subsetting operations, but the names will always remain the same!</p>
</section><section id="logical-operations"><h2 class="section-heading">Subsetting through other logical operations<a class="anchor" aria-label="anchor" href="#logical-operations"></a>
</h2>
<hr class="half-width">
<p>We can also use any logical vector to subset:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  c   e 
7.1 7.5 </code></pre>
</div>
<p>Since comparison operators (e.g. <code>&gt;</code>,
<code>&lt;</code>, <code>==</code>) evaluate to logical vectors, we can
also use them to succinctly subset vectors: the following statement
gives the same result as the previous one.</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  c   e 
7.1 7.5 </code></pre>
</div>
<p>Breaking it down, this statement first evaluates <code>x&gt;7</code>,
generating a logical vector
<code>c(FALSE, FALSE, TRUE, FALSE, TRUE)</code>, and then selects the
elements of <code>x</code> corresponding to the <code>TRUE</code>
values.</p>
<p>We can use <code>==</code> to mimic the previous method of indexing
by name (remember you have to use <code>==</code> rather than
<code>=</code> for comparisons):</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>  <span class="va">a</span> </span>
<span><span class="fl">5.4</span> </span></code></pre>
</div>
<div id="tip-combining-logical-conditions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-combining-logical-conditions" class="callout-inner">
<h3 class="callout-title">Tip: Combining logical conditions<a class="anchor" aria-label="anchor" href="#tip-combining-logical-conditions"></a>
</h3>
<div class="callout-content">
<p>We often want to combine multiple logical criteria. For example, we
might want to find all the countries that are located in Asia
<strong>or</strong> Europe <strong>and</strong> have life expectancies
within a certain range. Several operations for combining logical vectors
exist in R:</p>
<ul>
<li>
<code>&amp;</code>, the “logical AND” operator: returns
<code>TRUE</code> if both the left and right are <code>TRUE</code>.</li>
<li>
<code>|</code>, the “logical OR” operator: returns
<code>TRUE</code>, if either the left or right (or both) are
<code>TRUE</code>.</li>
</ul>
<p>You may sometimes see <code>&amp;&amp;</code> and <code>||</code>
instead of <code>&amp;</code> and <code>|</code>. These two-character
operators only look at the first element of each vector and ignore the
remaining elements. In general you should not use the two-character
operators in data analysis; save them for programming, i.e. deciding
whether to execute a statement.</p>
<ul>
<li>
<code>!</code>, the “logical NOT” operator: converts
<code>TRUE</code> to <code>FALSE</code> and <code>FALSE</code> to
<code>TRUE</code>. It can negate a single logical condition (eg
<code>!TRUE</code> becomes <code>FALSE</code>), or a whole vector of
conditions(eg <code>!c(TRUE, FALSE)</code> becomes
<code>c(FALSE, TRUE)</code>).</li>
</ul>
<p>Additionally, you can compare the elements within a single vector
using the <code>all</code> function (which returns <code>TRUE</code> if
every element of the vector is <code>TRUE</code>) and the
<code>any</code> function (which returns <code>TRUE</code> if one or
more elements of the vector are <code>TRUE</code>).</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Given the following code:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.4</span>, <span class="fl">6.2</span>, <span class="fl">7.1</span>, <span class="fl">4.8</span>, <span class="fl">7.5</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   b   c   d   e 
5.4 6.2 7.1 4.8 7.5 </code></pre>
</div>
<p>Write a subsetting command to return the values in x that are greater
than 4 and less than 7.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_subset</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">&gt;</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">x_subset</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a   b   d 
5.4 6.2 4.8 </code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tip-non-unique-names" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-non-unique-names" class="callout-inner">
<h3 class="callout-title">Tip: Non-unique names<a class="anchor" aria-label="anchor" href="#tip-non-unique-names"></a>
</h3>
<div class="callout-content">
<p>You should be aware that it is possible for multiple elements in a
vector to have the same name. (For a data frame, columns can have the
same name — although R tries to avoid this — but row names must be
unique.) Consider these examples:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'a'</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a a a 
1 2 3 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="st">'a'</span><span class="op">]</span>  <span class="co"># only returns first value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">a</span> </span>
<span><span class="fl">1</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="st">'a'</span><span class="op">]</span>  <span class="co"># returns all three values</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a a a 
1 2 3 </code></pre>
</div>
</div>
</div>
</div>
<div id="tip-getting-help-for-operators" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-getting-help-for-operators" class="callout-inner">
<h3 class="callout-title">Tip: Getting help for operators<a class="anchor" aria-label="anchor" href="#tip-getting-help-for-operators"></a>
</h3>
<div class="callout-content">
<p>Remember you can search for help on operators by wrapping them in
quotes: <code>help("%in%")</code> or <code>?"%in%"</code>.</p>
</div>
</div>
</div>
</section><section id="skipping-named-elements"><h2 class="section-heading">Skipping named elements<a class="anchor" aria-label="anchor" href="#skipping-named-elements"></a>
</h2>
<hr class="half-width">
<p>Skipping or removing named elements is a little harder. If we try to
skip one named element by negating the string, R complains (slightly
obscurely) that it doesn’t know how to take the negative of a
string:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>a<span class="op">=</span><span class="fl">5.4</span>, b<span class="op">=</span><span class="fl">6.2</span>, c<span class="op">=</span><span class="fl">7.1</span>, d<span class="op">=</span><span class="fl">4.8</span>, e<span class="op">=</span><span class="fl">7.5</span><span class="op">)</span> <span class="co"># we start again by naming a vector 'on the fly'</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="st">"a"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in -"a": invalid argument to unary operator</code></pre>
</div>
<p>However, we can use the <code>!=</code> (not-equals) operator to
construct a logical vector that will do what we want:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"a"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d   e 
6.2 7.1 4.8 7.5 </code></pre>
</div>
<p>Skipping multiple named indices is a little bit harder still. Suppose
we want to drop the <code>"a"</code> and <code>"c"</code> elements, so
we try this:</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">!=</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"c"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in names(x) != c("a", "c"): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   c   d   e 
6.2 7.1 4.8 7.5 </code></pre>
</div>
<p>R did <em>something</em>, but it gave us a warning that we ought to
pay attention to - and it apparently <em>gave us the wrong answer</em>
(the <code>"c"</code> element is still included in the vector)!</p>
<p>So what does <code>!=</code> actually do in this case? That’s an
excellent question.</p>
<div class="section level3">
<h3 id="recycling">Recycling<a class="anchor" aria-label="anchor" href="#recycling"></a>
</h3>
<p>Let’s take a look at the comparison component of this code:</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in names(x) != c("a", "c"): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE  TRUE  TRUE  TRUE  TRUE</code></pre>
</div>
<p>Why does R give <code>TRUE</code> as the third element of this
vector, when <code>names(x)[3] != "c"</code> is obviously false? When
you use <code>!=</code>, R tries to compare each element of the left
argument with the corresponding element of its right argument. What
happens when you compare vectors of different lengths?</p>
<figure><img src="fig/06-rmd-inequality.1.png" alt="Inequality testing" class="figure mx-auto d-block"></figure><p>When one vector is shorter than the other, it gets
<em>recycled</em>:</p>
<figure><img src="fig/06-rmd-inequality.2.png" alt="Inequality testing: results of recycling" class="figure mx-auto d-block"></figure><p>In this case R <strong>repeats</strong> <code>c("a", "c")</code> as
many times as necessary to match <code>names(x)</code>, i.e. we get
<code>c("a","c","a","c","a")</code>. Since the recycled <code>"a"</code>
doesn’t match the third element of <code>names(x)</code>, the value of
<code>!=</code> is <code>TRUE</code>. Because in this case the longer
vector length (5) isn’t a multiple of the shorter vector length (2), R
printed a warning message. If we had been unlucky and
<code>names(x)</code> had contained six elements, R would
<em>silently</em> have done the wrong thing (i.e., not what we intended
it to do). This recycling rule can can introduce hard-to-find and subtle
bugs!</p>
<p>The way to get R to do what we really want (match <em>each</em>
element of the left argument with <em>all</em> of the elements of the
right argument) it to use the <code>%in%</code> operator. The
<code>%in%</code> operator goes through each element of its left
argument, in this case the names of <code>x</code>, and asks, “Does this
element occur in the second argument?”. Here, since we want to
<em>exclude</em> values, we also need a <code>!</code> operator to
change “in” to “not in”:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="op">!</span> <span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"c"</span><span class="op">)</span> <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  b   d   e 
6.2 4.8 7.5 </code></pre>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Selecting elements of a vector that match any of a list of components
is a very common data analysis task. For example, the gapminder data set
contains <code>country</code> and <code>continent</code> variables, but
no information between these two scales. Suppose we want to pull out
information from southeast Asia: how do we set up an operation to
produce a logical vector that is <code>TRUE</code> for all of the
countries in southeast Asia and <code>FALSE</code> otherwise?</p>
<p>Suppose you have these data:</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seAsia</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Myanmar"</span>,<span class="st">"Thailand"</span>,<span class="st">"Cambodia"</span>,<span class="st">"Vietnam"</span>,<span class="st">"Laos"</span><span class="op">)</span></span>
<span><span class="co">## read in the gapminder data that we downloaded in episode 2</span></span>
<span><span class="va">gapminder</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/gapminder_data.csv"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## extract the `country` column from a data frame (we'll see this later);</span></span>
<span><span class="co">## convert from a factor to a character;</span></span>
<span><span class="co">## and get just the non-repeated elements</span></span>
<span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="fu">unique</span><span class="op">(</span><span class="fu">as.character</span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>There’s a wrong way (using only <code>==</code>), which will give you
a warning; a clunky way (using the logical operators <code>==</code> and
<code>|</code>); and an elegant way (using <code>%in%</code>). See
whether you can come up with all three and explain how they (don’t)
work.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ul>
<li>The <strong>wrong</strong> way to do this problem is
<code>countries==seAsia</code>. This gives a warning
(<code>"In countries == seAsia : longer object length is not a multiple of shorter object length"</code>)
and the wrong answer (a vector of all <code>FALSE</code> values),
because none of the recycled values of <code>seAsia</code> happen to
line up correctly with matching values in <code>country</code>.</li>
<li>The <strong>clunky</strong> (but technically correct) way to do this
problem is</li>
</ul>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="op">(</span><span class="va">countries</span><span class="op">==</span><span class="st">"Myanmar"</span> <span class="op">|</span> <span class="va">countries</span><span class="op">==</span><span class="st">"Thailand"</span> <span class="op">|</span></span>
<span> <span class="va">countries</span><span class="op">==</span><span class="st">"Cambodia"</span> <span class="op">|</span> <span class="va">countries</span> <span class="op">==</span> <span class="st">"Vietnam"</span> <span class="op">|</span> <span class="va">countries</span><span class="op">==</span><span class="st">"Laos"</span><span class="op">)</span></span></code></pre>
</div>
<p>(or <code>countries==seAsia[1] | countries==seAsia[2] | ...</code>).
This gives the correct values, but hopefully you can see how awkward it
is (what if we wanted to select countries from a much longer list?).</p>
<ul>
<li>The best way to do this problem is
<code>countries %in% seAsia</code>, which is both correct and easy to
type (and read).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section><section id="handling-special-values"><h2 class="section-heading">Handling special values<a class="anchor" aria-label="anchor" href="#handling-special-values"></a>
</h2>
<hr class="half-width">
<p>At some point you will encounter functions in R that cannot handle
missing, infinite, or undefined data.</p>
<p>There are a number of special functions you can use to filter out
this data:</p>
<ul>
<li>
<code>is.na</code> will return all positions in a vector, matrix, or
data.frame containing <code>NA</code> (or <code>NaN</code>)</li>
<li>likewise, <code>is.nan</code>, and <code>is.infinite</code> will do
the same for <code>NaN</code> and <code>Inf</code>.</li>
<li>
<code>is.finite</code> will return all positions in a vector,
matrix, or data.frame that do not contain <code>NA</code>,
<code>NaN</code> or <code>Inf</code>.</li>
<li>
<code>na.omit</code> will filter out all missing values from a
vector</li>
</ul></section><section id="factor-subsetting"><h2 class="section-heading">Factor subsetting<a class="anchor" aria-label="anchor" href="#factor-subsetting"></a>
</h2>
<hr class="half-width">
<p>Now that we’ve explored the different ways to subset vectors, how do
we subset the other data structures?</p>
<p>Factor subsetting works the same way as vector subsetting.</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span><span class="op">[</span><span class="va">f</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] a a
Levels: a b c d</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">[</span><span class="va">f</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] b c c
Levels: a b c d</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] a a b
Levels: a b c d</code></pre>
</div>
<p>Skipping elements will not remove the level even if no more of that
category exists in the factor:</p>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] a a c c d
Levels: a b c d</code></pre>
</div>
</section><section id="matrix-subsetting"><h2 class="section-heading">Matrix subsetting<a class="anchor" aria-label="anchor" href="#matrix-subsetting"></a>
</h2>
<hr class="half-width">
<p>Matrices are also subsetted using the <code>[</code> function. In
this case it takes two arguments: the first applying to the rows, the
second to its columns:</p>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">6</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, nrow<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">m</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            [,1]       [,2]
[1,]  1.12493092 -0.8356286
[2,] -0.04493361  1.5952808</code></pre>
</div>
<p>You can leave the first or second arguments blank to retrieve all the
rows or columns respectively:</p>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            [,1]        [,2]
[1,] -0.62124058  0.82122120
[2,] -2.21469989  0.59390132
[3,]  1.12493092  0.91897737
[4,] -0.04493361  0.78213630
[5,] -0.01619026  0.07456498
[6,]  0.94383621 -1.98935170</code></pre>
</div>
<p>If we only access one row or column, R will automatically convert the
result to a vector:</p>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.8356286  0.5757814  1.1249309  0.9189774</code></pre>
</div>
<p>If you want to keep the output as a matrix, you need to specify a
<em>third</em> argument; <code>drop = FALSE</code>:</p>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span><span class="fl">3</span>, , drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           [,1]      [,2]     [,3]      [,4]
[1,] -0.8356286 0.5757814 1.124931 0.9189774</code></pre>
</div>
<p>Unlike vectors, if we try to access a row or column outside of the
matrix, R will throw an error:</p>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in m[, c(3, 6)]: subscript out of bounds</code></pre>
</div>
<div id="tip-higher-dimensional-arrays" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-higher-dimensional-arrays" class="callout-inner">
<h3 class="callout-title">Tip: Higher dimensional arrays<a class="anchor" aria-label="anchor" href="#tip-higher-dimensional-arrays"></a>
</h3>
<div class="callout-content">
<p>when dealing with multi-dimensional arrays, each argument to
<code>[</code> corresponds to a dimension. For example, a 3D array, the
first three arguments correspond to the rows, columns, and depth
dimension.</p>
</div>
</div>
</div>
<p>Because matrices are vectors, we can also subset using only one
argument:</p>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3295078</code></pre>
</div>
<p>This usually isn’t useful, and often confusing to read. However it is
useful to note that matrices are laid out in <em>column-major
format</em> by default. That is the elements of the vector are arranged
column-wise:</p>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6</code></pre>
</div>
<p>If you wish to populate the matrix by row, use
<code>byrow=TRUE</code>:</p>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6</code></pre>
</div>
<p>Matrices can also be subsetted using their rownames and column names
instead of their row and column indices.</p>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>Given the following code:</p>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    4    7   10   13   16
[2,]    2    5    8   11   14   17
[3,]    3    6    9   12   15   18</code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Which of the following commands will extract the values 11 and
14?</li>
</ol>
<p>A. <code>m[2,4,2,5]</code></p>
<p>B. <code>m[2:5]</code></p>
<p>C. <code>m[4:5,2]</code></p>
<p>D. <code>m[2,c(4,5)]</code></p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to challenge 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>D</p>
</div>
</div>
</div>
</div>
</section><section id="list-subsetting"><h2 class="section-heading">List subsetting<a class="anchor" aria-label="anchor" href="#list-subsetting"></a>
</h2>
<hr class="half-width">
<p>Now we’ll introduce some new subsetting operators. There are three
functions used to subset lists. We’ve already seen these when learning
about atomic vectors and matrices: <code>[</code>, <code>[[</code>, and
<code>$</code>.</p>
<p>Using <code>[</code> will always return a list. If you want to
<em>subset</em> a list, but not <em>extract</em> an element, then you
will likely use <code>[</code>.</p>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>a <span class="op">=</span> <span class="st">"Software Carpentry"</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, data <span class="op">=</span> <span class="fu">head</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xlist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$a
[1] "Software Carpentry"</code></pre>
</div>
<p>This returns a <em>list with one element</em>.</p>
<p>We can subset elements of a list exactly the same way as atomic
vectors using <code>[</code>. Comparison operations however won’t work
as they’re not recursive, they will try to condition on the data
structures in each element of the list, not the individual elements
within those data structures.</p>
<div class="codewrapper sourceCode" id="cb102">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$a
[1] "Software Carpentry"

$b
 [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<p>To extract individual elements of a list, you need to use the
double-square bracket function: <code>[[</code>.</p>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Software Carpentry"</code></pre>
</div>
<p>Notice that now the result is a vector, not a list.</p>
<p>You can’t extract more than one element at once:</p>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in xlist[[1:2]]: subscript out of bounds</code></pre>
</div>
<p>Nor use it to skip elements:</p>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in xlist[[-1]]: invalid negative subscript in get1index &lt;real&gt;</code></pre>
</div>
<p>But you can use names to both subset and extract elements:</p>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[[</span><span class="st">"a"</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Software Carpentry"</code></pre>
</div>
<p>The <code>$</code> function is a shorthand way for extracting
elements by name:</p>
<div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">$</span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5<a class="anchor" aria-label="anchor" href="#challenge-5"></a>
</h3>
<div class="callout-content">
<p>Given the following list:</p>
<div class="codewrapper sourceCode" id="cb114">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>a <span class="op">=</span> <span class="st">"Software Carpentry"</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, data <span class="op">=</span> <span class="fu">head</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Using your knowledge of both list and vector subsetting, extract the
number 2 from xlist. Hint: the number 2 is contained within the “b” item
in the list.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to challenge 5</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb115">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb117">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb119">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span><span class="op">[[</span><span class="st">"b"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6<a class="anchor" aria-label="anchor" href="#challenge-6"></a>
</h3>
<div class="callout-content">
<p>Given a linear model:</p>
<div class="codewrapper sourceCode" id="cb121">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">pop</span> <span class="op">~</span> <span class="va">lifeExp</span>, data<span class="op">=</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<p>Extract the residual degrees of freedom (hint:
<code>attributes()</code> will help you)</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Solution to challenge 6</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb122">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">attributes</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="co">## `df.residual` is one of the names of `mod`</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb123">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">df.residual</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="data-frames"><h2 class="section-heading">Data frames<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h2>
<hr class="half-width">
<p>Remember the data frames are lists underneath the hood, so similar
rules apply. However they are also two dimensional objects:</p>
<p><code>[</code> with one argument will act the same way as for lists,
where each list element corresponds to a column. The resulting object
will be a data frame:</p>
<div class="codewrapper sourceCode" id="cb124">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">gapminder</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       pop
1  8425333
2  9240934
3 10267083
4 11537966
5 13079460
6 14880372</code></pre>
</div>
<p>Similarly, <code>[[</code> will act to extract <em>a single
column</em>:</p>
<div class="codewrapper sourceCode" id="cb126">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">gapminder</span><span class="op">[[</span><span class="st">"lifeExp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 28.801 30.332 31.997 34.020 36.088 38.438</code></pre>
</div>
<p>And <code>$</code> provides a convenient shorthand to extract columns
by name:</p>
<div class="codewrapper sourceCode" id="cb128">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1952 1957 1962 1967 1972 1977</code></pre>
</div>
<p>With two arguments, <code>[</code> behaves the same way as for
matrices:</p>
<div class="codewrapper sourceCode" id="cb130">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap
1 Afghanistan 1952  8425333      Asia  28.801  779.4453
2 Afghanistan 1957  9240934      Asia  30.332  820.8530
3 Afghanistan 1962 10267083      Asia  31.997  853.1007</code></pre>
</div>
<p>If we subset a single row, the result will be a data frame (because
the elements are mixed types):</p>
<div class="codewrapper sourceCode" id="cb132">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap
3 Afghanistan 1962 10267083      Asia  31.997  853.1007</code></pre>
</div>
<p>But for a single column the result will be a vector (this can be
changed with the third argument, <code>drop = FALSE</code>).</p>
<div id="challenge-7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7" class="callout-inner">
<h3 class="callout-title">Challenge 7<a class="anchor" aria-label="anchor" href="#challenge-7"></a>
</h3>
<div class="callout-content">
<p>Fix each of the following common data frame subsetting errors:</p>
<ol style="list-style-type: decimal">
<li>Extract observations collected for the year 1957</li>
</ol>
<div class="codewrapper sourceCode" id="cb134">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>gapminder[gapminder<span class="sc">$</span>year <span class="ot">=</span> <span class="dv">1957</span>,]</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Extract all columns except 1 through to 4</li>
</ol>
<div class="codewrapper sourceCode" id="cb135">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Extract the rows where the life expectancy is longer the 80
years</li>
</ol>
<div class="codewrapper sourceCode" id="cb136">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">lifeExp</span> <span class="op">&gt;</span> <span class="fl">80</span><span class="op">]</span></span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Extract the first row, and the fourth and fifth columns
(<code>continent</code> and <code>lifeExp</code>).</li>
</ol>
<div class="codewrapper sourceCode" id="cb137">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">]</span></span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Advanced: extract rows that contain information for the years 2002
and 2007</li>
</ol>
<div class="codewrapper sourceCode" id="cb138">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2002</span> <span class="op">|</span> <span class="fl">2007</span>,<span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Solution to challenge 7</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<p>Fix each of the following common data frame subsetting errors:</p>
<ol style="list-style-type: decimal">
<li>Extract observations collected for the year 1957</li>
</ol>
<div class="codewrapper sourceCode" id="cb139">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gapminder[gapminder$year = 1957,]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1957</span>,<span class="op">]</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Extract all columns except 1 through to 4</li>
</ol>
<div class="codewrapper sourceCode" id="cb140">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gapminder[,-1:4]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Extract the rows where the life expectancy is longer than 80
years</li>
</ol>
<div class="codewrapper sourceCode" id="cb141">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gapminder[gapminder$lifeExp &gt; 80]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">lifeExp</span> <span class="op">&gt;</span> <span class="fl">80</span>,<span class="op">]</span></span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Extract the first row, and the fourth and fifth columns
(<code>continent</code> and <code>lifeExp</code>).</li>
</ol>
<div class="codewrapper sourceCode" id="cb142">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gapminder[1, 4, 5]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="fl">1</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Advanced: extract rows that contain information for the years 2002
and 2007</li>
</ol>
<div class="codewrapper sourceCode" id="cb143">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gapminder[gapminder$year == 2002 | 2007,]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2002</span> <span class="op">|</span> <span class="va">gapminder</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2007</span>,<span class="op">]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2002</span>, <span class="fl">2007</span><span class="op">)</span>,<span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-8" class="callout-inner">
<h3 class="callout-title">Challenge 8<a class="anchor" aria-label="anchor" href="#challenge-8"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Why does <code>gapminder[1:20]</code> return an error? How does
it differ from <code>gapminder[1:20, ]</code>?</p></li>
<li><p>Create a new <code>data.frame</code> called
<code>gapminder_small</code> that only contains rows 1 through 9 and 19
through 23. You can do this in one or two steps.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">Solution to challenge 8</h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p><code>gapminder</code> is a data.frame so needs to be subsetted
on two dimensions. <code>gapminder[1:20, ]</code> subsets the data to
give the first 20 rows and all columns.</p></li>
<li>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb144">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder_small</span> <span class="op">&lt;-</span> <span class="va">gapminder</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">19</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span>,<span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Indexing in R starts at 1, not 0.</li>
<li>Access individual values by location using <code>[]</code>.</li>
<li>Access slices of data using <code>[low:high]</code>.</li>
<li>Access arbitrary sets of data using <code>[c(...)]</code>.</li>
<li>Use logical operations and logical vectors to access subsets of
data.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-07b-control-flow"><p>Content from <a href="07b-control-flow.html">Control Flow--if() and for()</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/07b-control-flow.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I get R to assess a situation and respond differently to
different circumstances?</li>
<li>How can I get R to repeat the same or similar operations instead of
copy-pasting the same code over and over?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognize when and how to make the COMPUTER do your tedious,
complex, and repetitive data tasks.</li>
<li>Practice indexing and logical tests in the context of solving a
frustrating data management problem.</li>
<li>Demystify the structure and syntax of the dreaded “for loop.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="intro"><h2 class="section-heading">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<hr class="half-width">
<p>In this unit, we’re going to start by creating a <em>fake</em> and
<em>annoying</em> data management problem that we will <em>then</em> get
to solve <strong>easily</strong> using two powerful programming tools.
Let’s create that annoying problem first.</p>
<p>The basic idea is that we will need to find and respond to a complex
pattern in our data–something we need to do <em>all the time</em> when
working with real data sets! So, we’ll need to generate some complex
data first, which we will do using random sampling.</p>
<p>However, because it would be nice if we <em>all</em> had the
<em>same</em> random data to work with (so we all get the same
answers!), we can first use a little “cheat code.” In R, you can make
random things “predictably random” by first setting a specific
<em>seed</em> for R’s random number generator to use. Doing so will
ensure we all get the same “answers,” so don’t skip this step!</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co">#Ensures that all random processes will "start from the same place."</span></span></code></pre>
</div>
<p>Next, let’s begin by making a giant random <em>vector</em> full of
values. To do this, we can use the <code>sample()</code> function. Here,
we’ll provide <code>sample()</code> with three inputs: an
<code>x</code>, a <code>size</code>, and a <code>replace</code>. See if
you can guess what each input does!</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rand_vec1</span> <span class="op">=</span> <span class="fu">sample</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>We can see the first 100 values of <code>rand_vec1</code> by using
indexing.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rand_vec1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span> <span class="co">#Extract values 1 thru 100.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] 0 0 0 1 0 1 1 1 0 0 1 1 1 0 1 0 1 0 0 0 0 1 0 0 0 0 1 1 0 1 0 1 0 1 1 0 0
 [38] 0 0 1 0 1 1 0 0 0 0 1 0 0 1 0 0 0 0 1 1 0 1 0 0 1 1 0 0 1 0 0 0 0 1 0 0 0
 [75] 0 1 1 0 1 1 1 1 0 1 1 1 0 0 1 0 1 1 0 1 1 0 0 1 0 0</code></pre>
</div>
<p>Here, we see that we drew randomly from the values 0 and 1
(<code>x</code> is the “pool” of values we draw from) 10,000 times
(<code>size</code> is the number of draws to do) with replacement
(<code>replace = TRUE</code>).</p>
<p>Let’s do the exact same thing again to create a second vector,
<code>rand_vec2</code>, that will be randomly different from the first
one we made.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rand_vec2</span> <span class="op">=</span> <span class="fu">sample</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>We’ll then create a <em>data frame</em> (table) with these two random
vectors as columns, which we’ll call <code>a</code> and <code>b</code>
for simplicity.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset1</span> <span class="op">=</span> <span class="fu">data.frame</span><span class="op">(</span>a <span class="op">=</span> <span class="va">rand_vec1</span>, </span>
<span>                      b <span class="op">=</span> <span class="va">rand_vec2</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="establishing-our-problem"><h2 class="section-heading">Establishing our problem<a class="anchor" aria-label="anchor" href="#establishing-our-problem"></a>
</h2>
<hr class="half-width">
<p>Ok, now that we’ve created our “fake, random data set,” let me
explain the annoying data problem involving it that we’ll need to
solve.</p>
<p>We have two columns, <code>a</code> and <code>b</code>. Imagine that,
for our analyses, we need to create a new, third column, <code>c</code>,
that equals <code>0</code> except whenever the current value in column
<code>a</code> is equal to <code>1</code> and ALSO the <em>previous</em>
value in column <code>b</code> is also equal to <code>1</code>. All
other times, <code>c</code> should equal <code>0</code> though.</p>
<p>For example, in the sample table below, the value of <code>c</code>
in row 2 would be 1 (column <code>a</code>’s second value is 1 and
column <code>b</code>’s first value is also 1) but 0 in row 3 (because
<code>a</code>’s value is 0) and row 4 (because <code>b</code>’s
previous value is 0):</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a b
1 0 1
2 1 1
3 0 0
4 1 1</code></pre>
</div>
<p>What an <strong>annoying</strong> pattern to have to spot, right?
Finding patterns like these is something we often have to do when
analyzing real-world data. Imagine trying to hunt for this pattern
<em>by eye</em>, perhaps in Microsoft Excel, by going row by row. It’d
be <strong>torture</strong>, it’d take <em>forever</em>, and we’d
probably make a lot of mistakes.</p>
<p>Instead, we can “teach” R how to find this pattern for us! To do
that, though, we need to harness two powerful functions that control how
R “goes with the flow” and makes “decisions”: <code>if()</code> and
<code>for()</code>.</p>
</section><section id="if-statements"><h2 class="section-heading">If statements<a class="anchor" aria-label="anchor" href="#if-statements"></a>
</h2>
<hr class="half-width">
<p>We’ll start with <code>if()</code> because it’s the simpler of the
two functions to learn. Even still, if you are not an experienced
programmer, <code>if()</code> will probably feel very “programming-y” to
you at first.</p>
<p>The good news is that you have probably experienced an “if statement”
in your real life! For example:</p>
<figure><img src="fig/thistalltoride.jpeg" alt="photo of amusement park barrier to entrance" class="figure mx-auto d-block"><div class="figcaption">If you’ve been to an amusement park, you’ve
probably seen a sign like this one before. It may not seem like it at
first, but this sign is an “if statement!”</div>
</figure><p>In life, we often encounter “rules.” If we pass or satisfy the rule,
we get to do stuff (like ride a roller coaster) and, if we don’t pass or
satisfy the rule, we have to do nothing.</p>
<p><code>if()</code> works the exact same way! We provide it a “rule” as
an input and then also “stuff” (code) that will execute if and only if
that “rule” passes.</p>
<p>To see what I mean, let’s create an object called <code>x</code> and
set its value to a known value of <code>10</code>.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">10</span> </span></code></pre>
</div>
<p>Now, let’s write an <code>if()</code> statement involving
<code>x</code>. In <code>if()</code>’s parentheses, we provide a
<em>logical test</em>, which consists of an object who’s value we will
check (here, that’s <code>x</code>), a <em>logical operator</em> (I’ll
use <code>&lt;</code> or “less than” below), and a “benchmark” to check
that value against (below, I use the value <code>20</code>).</p>
<p>Then, in <code>if()</code>’s <em>curly braces</em>, we put code that
should only execute if the <em>logical test</em> passes.</p>
<p>Putting all this together in the example below, I check to see if the
value of <code>x</code> is less than <code>20</code>, which we know that
it is, so the code in the <em>curly braces</em> will run.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Yes"</code></pre>
</div>
<p>What happens if the <em>logical test</em> fails instead? To see,
change the <em>logical operator</em> to “greater than”
(<code>&gt;</code>) instead. What do you get, and why?</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>As we’ve used it so far, <code>if()</code> only gets R to do
something if the <em>logical test</em> we’ve provided passes. What if
you wanted to do something either way (whether the test passes or
fails)–what could you do in this situation?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Your first temptation might be to put multiple <code>if()</code>s in
a row to catch all possible outcomes, such as by using the two
<code>if()</code> calls we’ve already written back to back to catch when
<code>x</code> is greater than 20 and when it’s less than 20. This
works, but if there are only two possible outcomes, there’s an easier
way…</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="ifelse-statements">If/else statements<a class="anchor" aria-label="anchor" href="#ifelse-statements"></a>
</h3>
<p><code>if()</code> has a companion function, <code>else</code>, that
you can pair it with so that something happens when the <em>logical
test</em> passes and something <em>different</em> happens when the
<em>logical test</em> fails. Here’s what this looks like:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> </span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"No"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "No"</code></pre>
</div>
<p>In the example above, <code>"No"</code> gets printed. Why? Well, the
<em>logical test</em> failed, so R skipped over the operations given to
<code>if()</code> and instead executed the operations given to
<code>else</code>.</p>
<p>Notice that <code>else</code> gets <em>curly braces</em> but not
parentheses. Why? Remember that <em>logical tests</em> must be
<strong>mutally exclusive</strong>, meaning they are either
<code>TRUE</code> (they pass) or <code>FALSE</code> (they fail). A
single <em>logical test</em> can yield either outcome, so the one
<em>logical test</em> we give to <code>if()</code> can serve as the
necessary input for both <code>if()</code> and <code>else</code>.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p><strong>Important</strong>: This means that an <code>else</code> is
<em>fundamentally dependent</em> on the <code>if()</code> it goes with.
As a result, an <code>else</code> must always start on the same line as
its <code>if()</code> ends on. For example, the code below would trigger
an error:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">&gt;</span> <span class="dv">20</span>) {</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Yes"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>} </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="cf">else</span> { </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>}</span></code></pre>
</div>
<p>This is an example of how line breaks do <em>occasionally</em> matter
in R.</p>
</div>
</div>
</div>
<p>For simplicity, we won’t show it here, but if you had a situation
where there were more than 2 possible outcomes and you wanted to do
something different in each one, you can stack <code>if()</code>s and
<code>else</code>s inside of each other to create as complex a “decision
tree” as you need to!</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>How does knowing <code>if()</code> help us solve our annoying data
problem involving columns <code>a</code> through <code>c</code> that we
set up earlier, do you think?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Recall that we want the value in column <code>c</code> to be equal to
<code>1</code> only <em>if</em> two specific conditions are met. So, we
can’t even talk about our data problem without using the word “if.”
That’s not an accident–<code>if()</code> will help us ensure that we do
the right thing whenever those conditions are met and something
<em>else</em> if they aren’t.</p>
</div>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Let’s practice trying to use <code>if()</code> and <code>else</code>
to start solving our data problem by using them to check to see what the
correct value for column <code>c</code> should be in row 2 of our data
set.</p>
<p>Write an if/else pair that checks if the <em>SECOND</em> value in
column <code>a</code> is equal to <code>1</code> (use <code>==</code> as
the <em>logical operator</em> to check for equality!) and the
<em>FIRST</em> value in column <code>b</code> is also equal to
<code>1</code>.</p>
<p>Inside your <em>curly braces</em>, make an object called
<code>c</code> and set its value to <code>1</code> if both conditions
are met and to <code>0</code> if not.</p>
<p>Hint: You can put two FULL <em>logical rules</em> inside of
<code>if()</code>’s parentheses and separate them with an
<code>&amp;</code> (“and”) if you want <code>if()</code> to check
against two rules instead of just one.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Here’s what this could look like:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">dataset1</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span></span>
<span>   <span class="va">dataset1</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>What happens when we run the code above–what does <code>c</code>
become? Let’s check:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<p>It became <code>0</code>. Is that what should have happened? Let’s
look at the first two rows of our data set to confirm that our code did
what we wanted it to do:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span> <span class="co">#Rows 1 and 2, all columns</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  a b
1 0 0
2 0 1</code></pre>
</div>
<p>Yes, <code>0</code> is the right value because <strong>both</strong>
conditions we were checking against were <code>FALSE</code> in this
case.</p>
<p>Nice! We can now have R perform this kind of check for us and it will
do it flawlessly <em>every single time</em>, unlike us humans who might
mess it up sometimes!</p>
</div>
</div>
</div>
</div>
</div>
</section><section id="for-loops-to-repeat-operations"><h2 class="section-heading">For loops to repeat operations<a class="anchor" aria-label="anchor" href="#for-loops-to-repeat-operations"></a>
</h2>
<hr class="half-width">
<p>If you did the challenge above (at least view the answer before
continuing!), you saw that we can use <code>if()</code> and
<code>else</code> to check whether row 2 in our data set passes both of
our conditions for when to put a <code>1</code> in column
<code>c</code>.</p>
<p>…Now, we’d just need to do this same check for the 9998 remaining
rows, right? Get ready to copy-paste <em>a lot</em> of code!</p>
<p>…No, I’m just kidding! Let’s definitely <strong>not</strong> do it
that way. Instead, we should just get R to <strong>repeat</strong> this
check the rest of the times we need to do it. Fortunately, repeating
tasks is exactly what the <code>for()</code> function is for.</p>
<p>Again, if you don’t have a programming background, <code>for()</code>
will probably look very “programming-y” to you. However, once again, the
good news is that you have probably experienced a “real-life for loop”
at least once! For example:</p>
<figure><img src="fig/ticketsystem.jpeg" alt="photo of ticketing systems at delis and the DMV" class="figure mx-auto d-block"><div class="figcaption">If you’ve ever been to a deli counter or the
DMV, you’ve probably seen a ticket system like this one. This is just a
for loop!</div>
</figure><p>If you’ve been to a deli counter that uses a ticket system like the
one above, you probably already know how the system works:</p>
<ol style="list-style-type: decimal">
<li><p>Everyone who wants some meat or cheese takes a ticket with a
unique number on it.</p></li>
<li><p>The worker behind the counter calls out the number of the next
ticket, putting that number up on a display board so everyone can see
which ticket we’re on.</p></li>
<li><p>The customer with that ticket number comes up to the counter and
places their order.</p></li>
<li><p>The worker then processes that order in <em>roughly</em> the same
way every time (gets the selection out, cuts it, places the slices in a
baggie, cleans the slicer, etc.).</p></li>
</ol>
<p>Then, the process repeats for the next customer and ticket number
until all the tickets are gone. This process of repeating the same set
of operations over and over again (even if the specifics actually change
somewhat each time!) all while keeping track of which “repeat” we’re on
is exactly how <code>for()</code> works too!</p>
<p>Let’s write out a “fake” <code>for()</code> call so we can see the
basic parts and how they match up with the story I just told:</p>
<blockquote>
<p>for(current_ticket in pool_of_ticket_values) {<br>
–code for R to repeat for every ticket–<br>
}</p>
</blockquote>
<p>Inside the parentheses above, we first have an object holding the
“current ticket number” that we’re on called
<code>current_ticket</code>. That object is exactly like the digital
“Now serving ticket #X” sign in our deli counter example.</p>
<p>Then, we have a connector function called <code>in</code>, which we
can safely ignore (as long as we don’t forget to include it!).</p>
<p>Then, we have another object called
<code>pool_of_ticket_values</code> that holds all possible ticket values
we will need to go through, one by one, until we are “done” serving our
customers.</p>
<p>Then, just as with <code>if()</code>, <code>for()</code> has
<em>curly braces</em>. Inside these, we have code that will run, from
top to bottom, the same exact way for each ticket value we draw from our
pool. In our story, these are the steps the worker goes through for each
customer. Each customer might want slightly different things, so the
“inputs” for these operations may change, but what gets done and when is
roughly the same every time.</p>
<p>Said differently, each time the operations inside the <em>curly
braces</em> begin, <code>current_ticket</code> will first become equal
to the next available value in the <code>pool_of_ticket_values</code>.
Then, all the operations inside the <em>curly braces</em> will run once
from top to bottom. That process will then repeat (or “loop”) until the
ticket pool is empty and there are no more new values to set
<code>current_ticket</code> equal to.</p>
<p>We can demonstrate this order of events using a working (albeit dumb)
example <em>for loop</em>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">ticket</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span></span>
<span>    <span class="fu">paste0</span><span class="op">(</span><span class="st">"Now serving ticket number: "</span>,</span>
<span>           <span class="va">ticket</span><span class="op">)</span></span>
<span>   <span class="op">)</span> </span>
<span>  <span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Now serving ticket number: 1"
[1] "Now serving ticket number: 2"
[1] "Now serving ticket number: 3"
[1] "Now serving ticket number: 4"
[1] "Now serving ticket number: 5"
[1] "Now serving ticket number: 6"
[1] "Now serving ticket number: 7"
[1] "Now serving ticket number: 8"
[1] "Now serving ticket number: 9"
[1] "Now serving ticket number: 10"</code></pre>
</div>
<p>What’s going on here? R is printing the message “Now serving ticket
number: X” 10 times, with X changing each time. How did this happen?</p>
<p>R starts to execute this code by first taking the first value in our
pool (which here is <code>1</code>), and makes <code>ticket</code> equal
to that value. It then executes the code in the <em>curly braces</em>,
which tells it to print a message.</p>
<p>However, specifically, we’ve asked it to use the current value of
<code>ticket</code> inside our message, like we’re having it read off
the “digital display board” to adjust its behavior depending on what
ticket we’re currently on. <strong>The fact that we can use
<code>ticket</code> inside our operations to “do work” is
important!</strong></p>
<p>The process then repeats until our pool is empty, which in this case
happens after we’ve used the last value in our pool, which is
<code>10</code> here.</p>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>How does knowing <code>for()</code> help us solve our annoying data
challenge, do you think?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>To fill out all 10,000 rows of our <code>c</code> column, we need to
do the same check <em>for each row</em>. Again, we can’t even discuss
our problem without using the word “for.” That’s not an accident! We can
use <code>for()</code> to repeat the check for every row and respond
accordingly even as the exact “inputs” change from one row to the
next.</p>
</div>
</div>
</div>
</div>
</section><section id="solving-our-annoying-data-challenge"><h2 class="section-heading">Solving our annoying data challenge<a class="anchor" aria-label="anchor" href="#solving-our-annoying-data-challenge"></a>
</h2>
<hr class="half-width">
<p>We’re <em>nearly</em> ready to solve our frustrating data management
challenge, but we just need to do a couple of preparation steps
first.</p>
<p>Since we’re going to need a <code>c</code> column in our data set but
there isn’t one yet, let’s make one and fill it with <code>NA</code>
values to start with (since we don’t yet know what those values should
be).</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset1</span><span class="op">$</span><span class="va">c</span> <span class="op">=</span> <span class="cn">NA</span></span></code></pre>
</div>
<p>The above command adds a new column called <code>c</code> to our data
set (if our data set already had a column called <code>c</code>, it
would replace that column instead). It then fills that column with
<code>NA</code>.</p>
<p>This step is called “pre-allocating.” We’re preparing a space for all
the new values we’re about to place in that <code>c</code> column! It’s
not strictly necessary to pre-allocate space for new stuff you want to
create using a <em>for loop</em>, but <em>for loops</em> can get
<strong>really</strong> slow if you <em>don’t</em> do it!</p>
<p>We can now build our <em>for loop</em>! To start, we have to pick a
name for our “current ticket” object because, as we saw in our earlier
example, it can be called whatever we want. I prefer names that have
meaning in the context of what I’m trying to accomplish. Here, because
we are repeating operations for each new <strong>row</strong> we want to
check, I will helpfully name this object <code>current_row</code>.</p>
<p>Then, I place <code>in</code> and then I need a pool of values that
will ensure the loop repeats the proper number of times. Because our
data set is 10,000 rows long, because we want to perform our check for
every row, and because the first row can <em>never</em> pass our tests
(there is no previous value for column <code>b</code> for row 1), we can
make our pool of the values ranging from <code>2</code> up to
<code>10000</code>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">current_row</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">#Operations will go here...</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Inside the <em>curly braces</em>, I now just need to tell R to check
the appropriate values in columns <code>a</code> and <code>b</code> and
set the appropriate values in column <code>c</code> accordingly.</p>
<p>We already wrote <em>more or less</em> the code needed to perform
this check in an earlier challenge:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">dataset1</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span></span>
<span>   <span class="va">dataset2</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>The only problem is that the above code only works to check the 2nd
row of column <code>a</code> and the 1st row of column <code>b</code>.
In other words, it’s too specific–we’ll need it to be more generic here
so that it can work for whatever row of our data set we’re currently
on.</p>
<p>Here’s where we can take advantage of the <code>current_row</code>
object:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">dataset1</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span></span>
<span>   <span class="va">dataset1</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">current_row</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Now, we’re telling R “<strong>whatever the current row is</strong>,
check the appropriate values and set the value of <code>c</code> in that
row accordingly.” As R works through the pool of values in
<code>2:10000</code>, <code>current_row</code> will become those values,
one at a time, so it will start out being <code>2</code>, then
<code>3</code>, and so on. So, we can use that to point R to a new row
each time through the loop!</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout2"></a>
</h3>
<div class="callout-content">
<p>Notice we can also do math inside <em>square brackets</em> to access
the <em>previous</em> value in column <code>b</code>–that’s a handy
trick!</p>
</div>
</div>
</div>
<p>If we put all this together, this is our final <em>for loop</em>:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">current_row</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">dataset1</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span></span>
<span>   <span class="va">dataset1</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">current_row</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span> <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>And now, the all-important question: Did it work? Let’s examine the
first 20 rows–see if you can determine whether column <code>c</code>
looks as it should or not:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   a b  c
1  0 0 NA
2  0 1  0
3  0 0  0
4  1 1  0
5  0 1  0
6  1 1  1
7  1 0  1
8  1 1  0
9  0 1  0
10 0 0  0
11 1 0  0
12 1 0  0
13 1 1  0
14 0 1  0
15 1 1  1
16 0 0  0
17 1 1  0
18 0 1  0
19 0 0  0
20 0 0  0</code></pre>
</div>
<p>The short answer: Yes, it does! This means we just had R do literally
<strong>hours</strong> of <strong>torturous</strong> work in just
<em>seconds</em>, flawlessly, with just eight lines of code! You’ll
<strong>never</strong> have to do something like this in Excel “by eye”
ever again!</p>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p>Add a fourth column, <code>d</code>, to our data set. Set
<code>d</code> equal to <code>1</code> whenever the current value of
<strong>either</strong> column <code>a</code> <strong>or</strong> column
<code>b</code> is <code>0</code> and make <code>d</code> equal to
<code>0</code> all other times. Hint: If you want to check to see if one
<em>logical test</em> <strong>or</strong> another passes, use
<code>|</code> (“or”) instead of <code>&amp;</code> (“and”) to connect
the two tests.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>Here’s one valid way to do this, though there are others! Don’t
forget to preallocate column <code>d</code> first!</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset1</span><span class="op">$</span><span class="va">d</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">current_row</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span> <span class="co">#We can check row 1 here if we want to!</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">dataset1</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="co">#Note the use of the or operator, |.</span></span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">{</span> <span class="co">#No need to use math in the square brackets this time.</span></span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>     <span class="va">dataset1</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="va">current_row</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span> <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>if</code> and <code>else</code> to have R make choices on
the fly for you with respect to what operations it should do.</li>
<li>Use <code>for</code> to repeat operations many times.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-08-plot-ggplot2"><p>Content from <a href="08-plot-ggplot2.html">Creating Publication-Quality Graphics with ggplot2</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/08-plot-ggplot2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I create publication-quality graphics in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To be able to use ggplot2 to generate publication-quality
graphics.</li>
<li>To apply geometry, aesthetic, and statistics layers to a ggplot
plot.</li>
<li>To manipulate the aesthetics of a plot using different colors,
shapes, and lines.</li>
<li>To improve data visualization through transforming scales and
paneling by group.</li>
<li>To save a plot created with ggplot to disk.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Plotting our data is one of the best ways to quickly explore it and
the various relationships between variables.</p>
<p>There are three main plotting systems in R, the <a href="https://www.statmethods.net/graphs/index.html" class="external-link">base plotting
system</a>, the <a href="https://www.statmethods.net/advgraphs/trellis.html" class="external-link">lattice</a>
package, and the <a href="https://www.statmethods.net/advgraphs/ggplot2.html" class="external-link">ggplot2</a>
package.</p>
<p>Today we’ll be learning about the ggplot2 package, because it is the
most effective for creating publication-quality graphics.</p>
<p>ggplot2 is built on the grammar of graphics, the idea that any plot
can be built from the same set of components: a <strong>data
set</strong>, <strong>mapping aesthetics</strong>, and graphical
<strong>layers</strong>:</p>
<ul>
<li><p><strong>Data sets</strong> are the data that you, the user,
provide.</p></li>
<li><p><strong>Mapping aesthetics</strong> are what connect the data to
the graphics. They tell ggplot2 how to use your data to affect how the
graph looks, such as changing what is plotted on the X or Y axis, or the
size or color of different data points.</p></li>
<li><p><strong>Layers</strong> are the actual graphical output from
ggplot2. Layers determine what kinds of plot are shown (scatterplot,
histogram, etc.), the coordinate system used (rectangular, polar,
others), and other important aspects of the plot. The idea of layers of
graphics may be familiar to you if you have used image editing programs
like Photoshop, Illustrator, or Inkscape.</p></li>
</ul>
<p>Let’s start off building an example using the gapminder data from
earlier. The most basic function is <code>ggplot</code>, which lets R
know that we’re creating a new plot. Any of the arguments we give the
<code>ggplot</code> function are the <em>global</em> options for the
plot: they apply to all layers on the plot.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-blank-ggplot-1.png" alt="Blank plot, before adding any mapping aesthetics to ggplot()." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Here we called <code>ggplot</code> and told it what data we want to
show on our figure. This is not enough information for
<code>ggplot</code> to actually draw anything. It only creates a blank
slate for other elements to be added to.</p>
<p>Now we’re going to add in the <strong>mapping aesthetics</strong>
using the <code>aes</code> function. <code>aes</code> tells
<code>ggplot</code> how variables in the <strong>data</strong> map to
<em>aesthetic</em> properties of the figure, such as which columns of
the data should be used for the <strong>x</strong> and
<strong>y</strong> locations.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-ggplot-with-aes-1.png" alt="Plotting area with axes for a scatter plot of life expectancy vs GDP, with no data points visible." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Here we told <code>ggplot</code> we want to plot the “gdpPercap”
column of the gapminder data frame on the x-axis, and the “lifeExp”
column on the y-axis. Notice that we didn’t need to explicitly pass
<code>aes</code> these columns
(e.g. <code>x = gapminder[, "gdpPercap"]</code>), this is because
<code>ggplot</code> is smart enough to know to look in the
<strong>data</strong> for that column!</p>
<p>The final part of making our plot is to tell <code>ggplot</code> how
we want to visually represent the data. We do this by adding a new
<strong>layer</strong> to the plot using one of the
<strong>geom</strong> functions.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lifeExp-vs-gdpPercap-scatter-1.png" alt="Scatter plot of life expectancy vs GDP per capita, now showing the data points." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Here we used <code>geom_point</code>, which tells <code>ggplot</code>
we want to visually represent the relationship between
<strong>x</strong> and <strong>y</strong> as a scatterplot of
points.</p>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Modify the example so that the figure shows how life expectancy has
changed over time:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Hint: the gapminder dataset has a column called “year”, which should
appear on the x-axis.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Here is one possible solution:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="fig/08-plot-ggplot2-rendered-ch1-sol-1.png" alt="Binned scatterplot of life expectancy versus year showing how life expectancy has increased over time" class="figure mx-auto d-block"><figcaption>
Binned scatterplot of life expectancy versus year showing how life
expectancy has increased over time
</figcaption></figure>
</div>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>In the previous examples and challenge we’ve used the
<code>aes</code> function to tell the scatterplot <strong>geom</strong>
about the <strong>x</strong> and <strong>y</strong> locations of each
point. Another <em>aesthetic</em> property we can modify is the point
<em>color</em>. Modify the code from the previous challenge to
<strong>color</strong> the points by the “continent” column. What trends
do you see in the data? Are they what you expected?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The solution presented below adds <code>color=continent</code> to the
call of the <code>aes</code> function. The general trend seems to
indicate an increased life expectancy over the years. On continents with
stronger economies we find a longer life expectancy.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="fig/08-plot-ggplot2-rendered-ch2-sol-1.png" alt="Binned scatterplot of life expectancy vs year with color-coded continents showing value of 'aes' function" class="figure mx-auto d-block"><figcaption>
Binned scatterplot of life expectancy vs year with color-coded
continents showing value of ‘aes’ function
</figcaption></figure>
</div>
</div>
</div>
</div>
<section id="layers"><h2 class="section-heading">Layers<a class="anchor" aria-label="anchor" href="#layers"></a>
</h2>
<hr class="half-width">
<p>Using a scatterplot probably isn’t the best for visualizing change
over time. Instead, let’s tell <code>ggplot</code> to visualize the data
as a line plot:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lifeExp-line-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Instead of adding a <code>geom_point</code> layer, we’ve added a
<code>geom_line</code> layer.</p>
<p>However, the result doesn’t look quite as we might have expected: it
seems to be jumping around a lot in each continent. Let’s try to
separate the data by country, plotting one line for each country:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, group<span class="op">=</span><span class="va">country</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lifeExp-line-by-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We’ve added the <strong>group</strong> <em>aesthetic</em>, which
tells <code>ggplot</code> to draw a line for each country.</p>
<p>But what if we want to visualize both lines and points on the plot?
We can add another layer to the plot:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, group<span class="op">=</span><span class="va">country</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lifeExp-line-point-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>It’s important to note that each layer is drawn on top of the
previous layer. In this example, the points have been drawn <em>on top
of</em> the lines. Here’s a demonstration:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, group<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lifeExp-layer-example-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In this example, the <em>aesthetic</em> mapping of
<strong>color</strong> has been moved from the global plot options in
<code>ggplot</code> to the <code>geom_line</code> layer so it no longer
applies to the points. Now we can clearly see that the points are drawn
on top of the lines.</p>
<div id="tip-setting-an-aesthetic-to-a-value-instead-of-a-mapping" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-setting-an-aesthetic-to-a-value-instead-of-a-mapping" class="callout-inner">
<h3 class="callout-title">Tip: Setting an aesthetic to a value instead
of a mapping<a class="anchor" aria-label="anchor" href="#tip-setting-an-aesthetic-to-a-value-instead-of-a-mapping"></a>
</h3>
<div class="callout-content">
<p>So far, we’ve seen how to use an aesthetic (such as
<strong>color</strong>) as a <em>mapping</em> to a variable in the data.
For example, when we use
<code>geom_line(mapping = aes(color=continent))</code>, ggplot will give
a different color to each continent. But what if we want to change the
color of all lines to blue? You may think that
<code>geom_line(mapping = aes(color="blue"))</code> should work, but it
doesn’t. Since we don’t want to create a mapping to a specific variable,
we can move the color specification outside of the <code>aes()</code>
function, like this: <code>geom_line(color="blue")</code>.</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Switch the order of the point and line layers from the previous
example. What happened?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The lines now get drawn over the points!</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, group<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-ch3-sol-1.png" alt="Scatter plot of life expectancy vs GDP per capita with a trend line summarising the relationship between variables. The plot illustrates the possibilities for styling visualisations in ggplot2 with data points enlarged, coloured orange, and displayed without transparency." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="transformations-and-statistics"><h2 class="section-heading">Transformations and statistics<a class="anchor" aria-label="anchor" href="#transformations-and-statistics"></a>
</h2>
<hr class="half-width">
<p>ggplot2 also makes it easy to overlay statistical models over the
data. To demonstrate we’ll go back to our first example:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lifeExp-vs-gdpPercap-scatter3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Currently it’s hard to see the relationship between the points due to
some strong outliers in GDP per capita. We can change the scale of units
on the x axis using the <em>scale</em> functions. These control the
mapping between the data values and visual values of an aesthetic. We
can also modify the transparency of the points, using the <em>alpha</em>
function, which is especially helpful when you have a large amount of
data which is very clustered.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="fig/08-plot-ggplot2-rendered-axis-scale-1.png" alt="Scatterplot of GDP vs life expectancy showing logarithmic x-axis data spread" class="figure mx-auto d-block"><figcaption>
Scatterplot of GDP vs life expectancy showing logarithmic x-axis data
spread
</figcaption></figure><p>The <code>scale_x_log10</code> function applied a transformation to
the coordinate system of the plot, so that each multiple of 10 is evenly
spaced from left to right. For example, a GDP per capita of 1,000 is the
same horizontal distance away from a value of 10,000 as the 10,000 value
is from 100,000. This helps to visualize the spread of the data along
the x-axis.</p>
<div id="tip-reminder-setting-an-aesthetic-to-a-value-instead-of-a-mapping" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-reminder-setting-an-aesthetic-to-a-value-instead-of-a-mapping" class="callout-inner">
<h3 class="callout-title">Tip Reminder: Setting an aesthetic to a value
instead of a mapping<a class="anchor" aria-label="anchor" href="#tip-reminder-setting-an-aesthetic-to-a-value-instead-of-a-mapping"></a>
</h3>
<div class="callout-content">
<p>Notice that we used <code>geom_point(alpha = 0.5)</code>. As the
previous tip mentioned, using a setting outside of the
<code>aes()</code> function will cause this value to be used for all
points, which is what we want in this case. But just like any other
aesthetic setting, <em>alpha</em> can also be mapped to a variable in
the data. For example, we can give a different transparency to each
continent with
<code>geom_point(mapping = aes(alpha = continent))</code>.</p>
</div>
</div>
</div>
<p>We can fit a simple relationship to the data by adding another layer,
<code>geom_smooth</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lm-fit-1.png" alt="Scatter plot of life expectancy vs GDP per capita with a blue trend line summarising the relationship between variables, and gray shaded area indicating 95% confidence intervals for that trend line." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can make the line thicker by <em>setting</em> the
<strong>size</strong> aesthetic in the <code>geom_smooth</code>
layer:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-lm-fit2-1.png" alt="Scatter plot of life expectancy vs GDP per capita with a trend line summarising the relationship between variables. The blue trend line is slightly thicker than in the previous figure." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>There are two ways an <em>aesthetic</em> can be specified. Here we
<em>set</em> the <strong>size</strong> aesthetic by passing it as an
argument to <code>geom_smooth</code>. Previously in the lesson we’ve
used the <code>aes</code> function to define a <em>mapping</em> between
data variables and their visual representation.</p>
<div id="challenge-4a" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4a" class="callout-inner">
<h3 class="callout-title">Challenge 4a<a class="anchor" aria-label="anchor" href="#challenge-4a"></a>
</h3>
<div class="callout-content">
<p>Modify the color and size of the points on the point layer in the
previous example.</p>
<p>Hint: do not use the <code>aes</code> function.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to challenge 4a</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Here a possible solution: Notice that the <code>color</code> argument
is supplied outside of the <code>aes()</code> function. This means that
it applies to all data points on the graph and is not related to a
specific variable.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, color<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-ch4a-sol-1.png" alt="Scatter plot of life expectancy vs GDP per capita with a trend line summarising the relationship between variables. The plot illustrates the possibilities for styling visualisations in ggplot2 with data points enlarged, coloured orange, and displayed without transparency." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="challenge-4b" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4b" class="callout-inner">
<h3 class="callout-title">Challenge 4b<a class="anchor" aria-label="anchor" href="#challenge-4b"></a>
</h3>
<div class="callout-content">
<p>Modify your solution to Challenge 4a so that the points are now a
different shape and are colored by continent with new trendlines. Hint:
The color argument can be used inside the aesthetic.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to challenge 4b</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>Here is a possible solution: Notice that supplying the
<code>color</code> argument inside the <code>aes()</code> functions
enables you to connect it to a certain variable. The <code>shape</code>
argument, as you can see, modifies all data points the same way (it is
outside the <code>aes()</code> call) while the <code>color</code>
argument which is placed inside the <code>aes()</code> call modifies a
point’s color based on its continent value.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdpPercap</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, shape<span class="op">=</span><span class="fl">17</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-ch4b-sol-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="multi-panel-figures"><h2 class="section-heading">Multi-panel figures<a class="anchor" aria-label="anchor" href="#multi-panel-figures"></a>
</h2>
<hr class="half-width">
<p>Earlier we visualized the change in life expectancy over time across
all countries in one plot. Alternatively, we can split this out over
multiple panels by adding a layer of <strong>facet</strong> panels.</p>
<div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip"></a>
</h3>
<div class="callout-content">
<p>We start by making a subset of data including only countries located
in the Americas. This includes 25 countries, which will begin to clutter
the figure. Note that we apply a “theme” definition to rotate the x-axis
labels to maintain readability. Nearly everything in ggplot2 is
customizable.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">americas</span> <span class="op">&lt;-</span> <span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Americas"</span>,<span class="op">]</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">americas</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-facet-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>facet_wrap</code> layer took a “formula” as its argument,
denoted by the tilde (~). This tells R to draw a panel for each unique
value in the country column of the gapminder dataset.</p>
</section><section id="modifying-text"><h2 class="section-heading">Modifying text<a class="anchor" aria-label="anchor" href="#modifying-text"></a>
</h2>
<hr class="half-width">
<p>To clean this figure up for a publication we need to change some of
the text elements. The x-axis is too cluttered, and the y axis should
read “Life expectancy”, rather than the column name in the data
frame.</p>
<p>We can do this by adding a couple of different layers. The
<strong>theme</strong> layer controls the axis text, and overall text
size. Labels for the axes, plot title and any legend can be set using
the <code>labs</code> function. Legend titles are set using the same
names we used in the <code>aes</code> specification. Thus below the
color legend title is set using <code>color = "Continent"</code>, while
the title of a fill legend would be set using
<code>fill = "MyTitle"</code>.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">americas</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,              <span class="co"># x axis title</span></span>
<span>    y <span class="op">=</span> <span class="st">"Life expectancy"</span>,   <span class="co"># y axis title</span></span>
<span>    title <span class="op">=</span> <span class="st">"Figure 1"</span>,      <span class="co"># main title of figure</span></span>
<span>    color <span class="op">=</span> <span class="st">"Continent"</span>      <span class="co"># title of legend</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-theme-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="exporting-the-plot"><h2 class="section-heading">Exporting the plot<a class="anchor" aria-label="anchor" href="#exporting-the-plot"></a>
</h2>
<hr class="half-width">
<p>The <code>ggsave()</code> function allows you to export a plot
created with ggplot. You can specify the dimension and resolution of
your plot by adjusting the appropriate arguments (<code>width</code>,
<code>height</code> and <code>dpi</code>) to create high quality
graphics for publication. In order to save the plot from above, we first
assign it to a variable <code>lifeExp_plot</code>, then tell
<code>ggsave</code> to save that plot in <code>png</code> format to a
directory called <code>results</code>. (Make sure you have a
<code>results/</code> folder in your working directory.)</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lifeExp_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">americas</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, color<span class="op">=</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span> <span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,              <span class="co"># x axis title</span></span>
<span>    y <span class="op">=</span> <span class="st">"Life expectancy"</span>,   <span class="co"># y axis title</span></span>
<span>    title <span class="op">=</span> <span class="st">"Figure 1"</span>,      <span class="co"># main title of figure</span></span>
<span>    color <span class="op">=</span> <span class="st">"Continent"</span>      <span class="co"># title of legend</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"results/lifeExp.png"</span>, plot <span class="op">=</span> <span class="va">lifeExp_plot</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">10</span>, dpi <span class="op">=</span> <span class="fl">300</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code></pre>
</div>
<p>There are two nice things about <code>ggsave</code>. First, it
defaults to the last plot, so if you omit the <code>plot</code> argument
it will automatically save the last plot you created with
<code>ggplot</code>. Secondly, it tries to determine the format you want
to save your plot in from the file extension you provide for the
filename (for example <code>.png</code> or <code>.pdf</code>). If you
need to, you can specify the format explicitly in the
<code>device</code> argument.</p>
<p>This is a taste of what you can do with ggplot2. RStudio provides a
really useful <a href="https://www.rstudio.org/links/data_visualization_cheat_sheet" class="external-link">cheat
sheet</a> of the different layers available, and more extensive
documentation is available on the <a href="https://ggplot2.tidyverse.org/reference/" class="external-link">ggplot2 website</a>. All
RStudio cheat sheets are available from the <a href="https://www.rstudio.com/resources/cheatsheets/" class="external-link">RStudio
website</a>. Finally, if you have no idea how to change something, a
quick Google search will usually send you to a relevant question and
answer on Stack Overflow with reusable code to modify!</p>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5<a class="anchor" aria-label="anchor" href="#challenge-5"></a>
</h3>
<div class="callout-content">
<p>Generate boxplots to compare life expectancy between the different
continents during the available years.</p>
<p>Advanced:</p>
<ul>
<li>Rename y axis as Life Expectancy.</li>
<li>Remove x axis labels.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Solution to Challenge 5</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>Here a possible solution: <code>xlab()</code> and <code>ylab()</code>
set labels for the x and y axes, respectively The axis title, text and
ticks are attributes of the theme and must be modified within a
<code>theme()</code> call.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">continent</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, fill <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Life Expectancy"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">theme</span><span class="op">(</span>axis.title.x<span class="op">=</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>       axis.text.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>       axis.ticks.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/08-plot-ggplot2-rendered-ch5-sol-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>ggplot2</code> to create plots.</li>
<li>Think about graphics in layers: aesthetics, geometry, statistics,
scale transformation, and grouping.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-09-vectorization"><p>Content from <a href="09-vectorization.html">Vectorization</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/09-vectorization.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I operate on all the elements of a vector at once?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To understand vectorized operations in R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Most of R’s functions are vectorized, meaning that the function will
operate on all elements of a vector without needing to loop through and
act on each element one at a time. This makes writing code more concise,
easy to read, and less error prone.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 4 6 8</code></pre>
</div>
<p>The multiplication happened to each element of the vector.</p>
<p>We can also add two vectors together:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">6</span><span class="op">:</span><span class="fl">9</span></span>
<span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  7  9 11 13</code></pre>
</div>
<p>Each element of <code>x</code> was added to its corresponding element
of <code>y</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>x<span class="sc">:</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>y<span class="sc">:</span>  <span class="dv">6</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="sc">---------------</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="dv">7</span>  <span class="dv">9</span> <span class="dv">11</span> <span class="dv">13</span></span></code></pre>
</div>
<p>Here is how we would add two vectors together using a for loop:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output_vector</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">output_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  7  9 11 13</code></pre>
</div>
<p>Compare this to the output using vectorised operations.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sum_xy</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="va">sum_xy</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  7  9 11 13</code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Let’s try this on the <code>pop</code> column of the
<code>gapminder</code> dataset.</p>
<p>Make a new column in the <code>gapminder</code> data frame that
contains population in units of millions of people. Check the head or
tail of the data frame to make sure it worked.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Let’s try this on the <code>pop</code> column of the
<code>gapminder</code> dataset.</p>
<p>Make a new column in the <code>gapminder</code> data frame that
contains population in units of millions of people. Check the head or
tail of the data frame to make sure it worked.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span><span class="op">$</span><span class="va">pop_millions</span> <span class="op">&lt;-</span> <span class="va">gapminder</span><span class="op">$</span><span class="va">pop</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap pop_millions
1 Afghanistan 1952  8425333      Asia  28.801  779.4453     8.425333
2 Afghanistan 1957  9240934      Asia  30.332  820.8530     9.240934
3 Afghanistan 1962 10267083      Asia  31.997  853.1007    10.267083
4 Afghanistan 1967 11537966      Asia  34.020  836.1971    11.537966
5 Afghanistan 1972 13079460      Asia  36.088  739.9811    13.079460
6 Afghanistan 1977 14880372      Asia  38.438  786.1134    14.880372</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>On a single graph, plot population, in millions, against year, for
all countries. Do not worry about identifying which country is
which.</p>
<p>Repeat the exercise, graphing only for China, India, and Indonesia.
Again, do not worry about which is which.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Refresh your plotting skills by plotting population in millions
against year.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">pop_millions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/09-vectorization-rendered-ch2-sol-1.png" alt="Scatter plot showing populations in the millions against the year for China, India, and Indonesia, countries are not labeled." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">countryset</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"China"</span>,<span class="st">"India"</span>,<span class="st">"Indonesia"</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span> <span class="op">%in%</span> <span class="va">countryset</span>,<span class="op">]</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">pop_millions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/09-vectorization-rendered-ch2-sol-2.png" alt="Scatter plot showing populations in the millions against the year for China, India, and Indonesia, countries are not labeled." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Comparison operators, logical operators, and many functions are also
vectorized:</p>
<p><strong>Comparison operators</strong></p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE  TRUE  TRUE</code></pre>
</div>
<p><strong>Logical operators</strong></p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">3</span>  <span class="co"># or, for clarity, a &lt;- (x &gt; 3)</span></span>
<span><span class="va">a</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE FALSE  TRUE</code></pre>
</div>
<div id="tip-some-useful-functions-for-logical-vectors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-some-useful-functions-for-logical-vectors" class="callout-inner">
<h3 class="callout-title">Tip: some useful functions for logical
vectors<a class="anchor" aria-label="anchor" href="#tip-some-useful-functions-for-logical-vectors"></a>
</h3>
<div class="callout-content">
<p><code>any()</code> will return <code>TRUE</code> if <em>any</em>
element of a vector is <code>TRUE</code>.<br><code>all()</code> will return <code>TRUE</code> if <em>all</em>
elements of a vector are <code>TRUE</code>.</p>
</div>
</div>
</div>
<p>Most functions also operate element-wise on vectors:</p>
<p><strong>Functions</strong></p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="fu">log</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.0000000 0.6931472 1.0986123 1.3862944</code></pre>
</div>
<p>Vectorized operations work element-wise on matrices:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]   -1   -4   -7  -10
[2,]   -2   -5   -8  -11
[3,]   -3   -6   -9  -12</code></pre>
</div>
<div id="tip-element-wise-vs.-matrix-multiplication" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-element-wise-vs.-matrix-multiplication" class="callout-inner">
<h3 class="callout-title">Tip: element-wise vs. matrix
multiplication<a class="anchor" aria-label="anchor" href="#tip-element-wise-vs.-matrix-multiplication"></a>
</h3>
<div class="callout-content">
<p>Very important: the operator <code>*</code> gives you element-wise
multiplication! To do matrix multiplication, we need to use the
<code>%*%</code> operator:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">%*%</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="fl">4</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1]
[1,]   22
[2,]   26
[3,]   30</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1]
[1,]   30</code></pre>
</div>
<p>For more on matrix algebra, see the <a href="https://www.statmethods.net/advstats/matrix.html" class="external-link">Quick-R
reference guide</a></p>
</div>
</div>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Given the following matrix:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">m</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    2    5    8   11
[3,]    3    6    9   12</code></pre>
</div>
<p>Write down what you think will happen when you run:</p>
<ol style="list-style-type: decimal">
<li><code>m ^ -1</code></li>
<li><code>m * c(1, 0, -1)</code></li>
<li><code>m &gt; c(0, 20)</code></li>
<li><code>m * c(1, 0, -1, 2)</code></li>
</ol>
<p>Did you get the output you expected? If not, ask a helper!</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Given the following matrix:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">m</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    2    5    8   11
[3,]    3    6    9   12</code></pre>
</div>
<p>Write down what you think will happen when you run:</p>
<ol style="list-style-type: decimal">
<li><code>m ^ -1</code></li>
</ol>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          [,1]      [,2]      [,3]       [,4]
[1,] 1.0000000 0.2500000 0.1428571 0.10000000
[2,] 0.5000000 0.2000000 0.1250000 0.09090909
[3,] 0.3333333 0.1666667 0.1111111 0.08333333</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li><code>m * c(1, 0, -1)</code></li>
</ol>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    0    0    0    0
[3,]   -3   -6   -9  -12</code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li><code>m &gt; c(0, 20)</code></li>
</ol>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      [,1]  [,2]  [,3]  [,4]
[1,]  TRUE FALSE  TRUE FALSE
[2,] FALSE  TRUE FALSE  TRUE
[3,]  TRUE FALSE  TRUE FALSE</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>We’re interested in looking at the sum of the following sequence of
fractions:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">3</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<p>This would be tedious to type out, and impossible for high values of
n. Use vectorisation to compute x when n=100. What is the sum when
n=10,000?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Challenge 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>We’re interested in looking at the sum of the following sequence of
fractions:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">3</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<p>This would be tedious to type out, and impossible for high values of
n. Can you use vectorisation to compute x, when n=100? How about when
n=10,000?</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sum</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.634984</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sum</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1e04</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.644834</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="fu">sum</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.644834</code></pre>
</div>
<p>We can also obtain the same results using a function:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inverse_sum_of_squares</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sum</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">inverse_sum_of_squares</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.634984</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">inverse_sum_of_squares</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.644834</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="fu">inverse_sum_of_squares</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.644834</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tip-operations-on-vectors-of-unequal-length" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-operations-on-vectors-of-unequal-length" class="callout-inner">
<h3 class="callout-title">Tip: Operations on vectors of unequal
length<a class="anchor" aria-label="anchor" href="#tip-operations-on-vectors-of-unequal-length"></a>
</h3>
<div class="callout-content">
<p>Operations can also be performed on vectors of unequal length,
through a process known as <em>recycling</em>. This process
automatically repeats the smaller vector until it matches the length of
the larger vector. R will provide a warning if the larger vector is not
a multiple of the smaller vector.</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in x + y: longer object length is not a multiple of shorter object
length</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 4 6 5 7 9 8</code></pre>
</div>
<p>Vector <code>x</code> was recycled to match the length of vector
<code>y</code></p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>x<span class="sc">:</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">1</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>    <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span>  <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>y<span class="sc">:</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="sc">-----------------------</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>    <span class="dv">2</span>  <span class="dv">4</span>  <span class="dv">6</span>  <span class="dv">5</span>  <span class="dv">7</span>  <span class="dv">9</span>  <span class="dv">8</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use vectorized operations instead of loops.</li>
</ul>
</div>
</div>
</div></section><section id="aio-10-functions"><p>Content from <a href="10-functions.html">Functions Explained</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/10-functions.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I write a new function in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define a function that takes arguments.</li>
<li>Return a value from a function.</li>
<li>Check argument conditions with <code>stopifnot()</code> in
functions.</li>
<li>Test a function.</li>
<li>Set default values for function arguments.</li>
<li>Explain why we should divide programs into small, single-purpose
functions.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>If we only had one data set to analyze, it would probably be faster
to load the file into a spreadsheet and use that to plot simple
statistics. However, the gapminder data is updated periodically, and we
may want to pull in that new information later and re-run our analysis
again. We may also obtain similar data from a different source in the
future.</p>
<p>In this lesson, we’ll learn how to write a function so that we can
repeat several operations with a single command.</p>
<div id="what-is-a-function" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-is-a-function" class="callout-inner">
<h3 class="callout-title">What is a function?<a class="anchor" aria-label="anchor" href="#what-is-a-function"></a>
</h3>
<div class="callout-content">
<p>Functions gather a sequence of operations into a whole, preserving it
for ongoing use. Functions provide:</p>
<ul>
<li>a name we can remember and invoke it by</li>
<li>relief from the need to remember the individual operations</li>
<li>a defined set of inputs and expected outputs</li>
<li>rich connections to the larger programming environment</li>
</ul>
<p>As the basic building block of most programming languages,
user-defined functions constitute “programming” as much as any single
abstraction can. If you have written a function, you are a computer
programmer.</p>
</div>
</div>
</div>
<section id="defining-a-function"><h2 class="section-heading">Defining a function<a class="anchor" aria-label="anchor" href="#defining-a-function"></a>
</h2>
<hr class="half-width">
<p>Let’s open a new R script file in the <code>functions/</code>
directory and call it functions-lesson.R.</p>
<p>The general structure of a function is:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># perform action</span></span>
<span>  <span class="co"># return value</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Let’s define a function <code>fahr_to_kelvin()</code> that converts
temperatures from Fahrenheit to Kelvin:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We define <code>fahr_to_kelvin()</code> by assigning it to the output
of <code>function</code>. The list of argument names are contained
within parentheses. Next, the <a href="reference.html#body">body</a> of
the function–the statements that are executed when it runs–is contained
within curly braces (<code>{}</code>). The statements in the body are
indented by two spaces. This makes the code easier to read but does not
affect how the code operates.</p>
<p>It is useful to think of creating functions like writing a cookbook.
First you define the “ingredients” that your function needs. In this
case, we only need one ingredient to use our function: “temp”. After we
list our ingredients, we then say what we will do with them, in this
case, we are taking our ingredient and applying a set of mathematical
operators to it.</p>
<p>When we call the function, the values we pass to it as arguments are
assigned to those variables so that we can use them inside the function.
Inside the function, we use a <a href="reference.html#return-statement">return statement</a> to send a
result back to whoever asked for it.</p>
<div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip"></a>
</h3>
<div class="callout-content">
<p>One feature unique to R is that the return statement is not required.
R automatically returns whichever variable is on the last line of the
body of the function. But for clarity, we will explicitly define the
return statement.</p>
</div>
</div>
</div>
<p>Let’s try running our function. Calling our own function is no
different from calling any other function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># freezing point of water</span></span>
<span><span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 273.15</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># boiling point of water</span></span>
<span><span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="fl">212</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 373.15</code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Write a function called <code>kelvin_to_celsius()</code> that takes a
temperature in Kelvin and returns that temperature in Celsius.</p>
<p>Hint: To convert from Kelvin to Celsius you subtract 273.15</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Write a function called <code>kelvin_to_celsius</code> that takes a
temperature in Kelvin and returns that temperature in Celsius</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kelvin_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="va">celsius</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">273.15</span></span>
<span> <span class="kw">return</span><span class="op">(</span><span class="va">celsius</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="combining-functions"><h2 class="section-heading">Combining functions<a class="anchor" aria-label="anchor" href="#combining-functions"></a>
</h2>
<hr class="half-width">
<p>The real power of functions comes from mixing, matching and combining
them into ever-larger chunks to get the effect we want.</p>
<p>Let’s define two functions that will convert temperature from
Fahrenheit to Kelvin, and Kelvin to Celsius:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">kelvin_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">celsius</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">celsius</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Define the function to convert directly from Fahrenheit to Celsius,
by reusing the two functions above (or using your own functions if you
prefer).</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Define the function to convert directly from Fahrenheit to Celsius,
by reusing these two functions above</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_k</span> <span class="op">&lt;-</span> <span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">kelvin_to_celsius</span><span class="op">(</span><span class="va">temp_k</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="interlude-defensive-programming"><h2 class="section-heading">Interlude: Defensive Programming<a class="anchor" aria-label="anchor" href="#interlude-defensive-programming"></a>
</h2>
<hr class="half-width">
<p>Now that we’ve begun to appreciate how writing functions provides an
efficient way to make R code re-usable and modular, we should note that
it is important to ensure that functions only work in their intended
use-cases. Checking function parameters is related to the concept of
<em>defensive programming</em>. Defensive programming encourages us to
frequently check conditions and throw an error if something is wrong.
These checks are referred to as assertion statements because we want to
assert some condition is <code>TRUE</code> before proceeding. They make
it easier to debug because they give us a better idea of where the
errors originate.</p>
<div class="section level3">
<h3 id="checking-conditions-with-stopifnot">Checking conditions with <code>stopifnot()</code>
<a class="anchor" aria-label="anchor" href="#checking-conditions-with-stopifnot"></a>
</h3>
<p>Let’s start by re-examining <code>fahr_to_kelvin()</code>, our
function for converting temperatures from Fahrenheit to Kelvin. It was
defined like so:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>For this function to work as intended, the argument <code>temp</code>
must be a <code>numeric</code> value; otherwise, the mathematical
procedure for converting between the two temperature scales will not
work. To create an error, we can use the function <code>stop()</code>.
For example, since the argument <code>temp</code> must be a
<code>numeric</code> vector, we could check for this condition with an
<code>if</code> statement and throw an error if the condition was
violated. We could augment our function above like so:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.numeric</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">stop</span><span class="op">(</span><span class="st">"temp must be a numeric vector."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>If we had multiple conditions or arguments to check, it would take
many lines of code to check all of them. Luckily R provides the
convenience function <code>stopifnot()</code>. We can list as many
requirements that should evaluate to <code>TRUE</code>;
<code>stopifnot()</code> throws an error if it finds one that is
<code>FALSE</code>. Listing these conditions also serves a secondary
purpose as extra documentation for the function.</p>
<p>Let’s try out defensive programming with <code>stopifnot()</code> by
adding assertions to check the input to our function
<code>fahr_to_kelvin()</code>.</p>
<p>We want to assert the following: <code>temp</code> is a numeric
vector. We may do that like so:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">stopifnot</span><span class="op">(</span><span class="fu">is.numeric</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">kelvin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">kelvin</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>It still works when given proper input.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># freezing point of water</span></span>
<span><span class="fu">fahr_to_kelvin</span><span class="op">(</span>temp <span class="op">=</span> <span class="fl">32</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 273.15</code></pre>
</div>
<p>But fails instantly if given improper input.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Metric is a factor instead of numeric</span></span>
<span><span class="fu">fahr_to_kelvin</span><span class="op">(</span>temp <span class="op">=</span> <span class="fu">as.factor</span><span class="op">(</span><span class="fl">32</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in fahr_to_kelvin(temp = as.factor(32)): is.numeric(temp) is not TRUE</code></pre>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Use defensive programming to ensure that our
<code>fahr_to_celsius()</code> function throws an error immediately if
the argument <code>temp</code> is specified inappropriately.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Extend our previous definition of the function by adding in an
explicit call to <code>stopifnot()</code>. Since
<code>fahr_to_celsius()</code> is a composition of two other functions,
checking inside here makes adding checks to the two component functions
redundant.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahr_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">stopifnot</span><span class="op">(</span><span class="fu">is.numeric</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">temp_k</span> <span class="op">&lt;-</span> <span class="fu">fahr_to_kelvin</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">kelvin_to_celsius</span><span class="op">(</span><span class="va">temp_k</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="more-on-combining-functions"><h2 class="section-heading">More on combining functions<a class="anchor" aria-label="anchor" href="#more-on-combining-functions"></a>
</h2>
<hr class="half-width">
<p>Now, we’re going to define a function that calculates the Gross
Domestic Product of a nation from the data available in our dataset:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Takes a dataset and multiplies the population column</span></span>
<span><span class="co"># with the GDP per capita column.</span></span>
<span><span class="va">calcGDP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="va">dat</span><span class="op">$</span><span class="va">gdpPercap</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We define <code>calcGDP()</code> by assigning it to the output of
<code>function</code>. The list of argument names are contained within
parentheses. Next, the body of the function -- the statements executed
when you call the function – is contained within curly braces
(<code>{}</code>).</p>
<p>We’ve indented the statements in the body by two spaces. This makes
the code easier to read but does not affect how it operates.</p>
<p>When we call the function, the values we pass to it are assigned to
the arguments, which become variables inside the body of the
function.</p>
<p>Inside the function, we use the <code>return()</code> function to
send back the result. This <code>return()</code> function is optional: R
will automatically return the results of whatever command is executed on
the last line of the function.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">calcGDP</span><span class="op">(</span><span class="fu">head</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  6567086330  7585448670  8758855797  9648014150  9678553274 11697659231</code></pre>
</div>
<p>That’s not very informative. Let’s add some more arguments so we can
extract that per year and country.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Takes a dataset and multiplies the population column</span></span>
<span><span class="co"># with the GDP per capita column.</span></span>
<span><span class="va">calcGDP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">year</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">country</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">year</span> <span class="op">%in%</span> <span class="va">year</span>, <span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">country</span> <span class="op">%in%</span> <span class="va">country</span>,<span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="va">dat</span><span class="op">$</span><span class="va">gdpPercap</span></span>
<span></span>
<span>  <span class="va">new</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">dat</span>, gdp<span class="op">=</span><span class="va">gdp</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>If you’ve been writing these functions down into a separate R script
(a good idea!), you can load in the functions into our R session by
using the <code>source()</code> function:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">source</span><span class="op">(</span><span class="st">"functions/functions-lesson.R"</span><span class="op">)</span></span></code></pre>
</div>
<p>Ok, so there’s a lot going on in this function now. In plain English,
the function now subsets the provided data by year if the year argument
isn’t empty, then subsets the result by country if the country argument
isn’t empty. Then it calculates the GDP for whatever subset emerges from
the previous two steps. The function then adds the GDP as a new column
to the subsetted data and returns this as the final result. You can see
that the output is much more informative than a vector of numbers.</p>
<p>Let’s take a look at what happens when we specify the year:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, year<span class="op">=</span><span class="fl">2007</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       country year      pop continent lifeExp  gdpPercap          gdp
12 Afghanistan 2007 31889923      Asia  43.828   974.5803  31079291949
24     Albania 2007  3600523    Europe  76.423  5937.0295  21376411360
36     Algeria 2007 33333216    Africa  72.301  6223.3675 207444851958
48      Angola 2007 12420476    Africa  42.731  4797.2313  59583895818
60   Argentina 2007 40301927  Americas  75.320 12779.3796 515033625357
72   Australia 2007 20434176   Oceania  81.235 34435.3674 703658358894</code></pre>
</div>
<p>Or for a specific country:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, country<span class="op">=</span><span class="st">"Australia"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     country year      pop continent lifeExp gdpPercap          gdp
61 Australia 1952  8691212   Oceania  69.120  10039.60  87256254102
62 Australia 1957  9712569   Oceania  70.330  10949.65 106349227169
63 Australia 1962 10794968   Oceania  70.930  12217.23 131884573002
64 Australia 1967 11872264   Oceania  71.100  14526.12 172457986742
65 Australia 1972 13177000   Oceania  71.930  16788.63 221223770658
66 Australia 1977 14074100   Oceania  73.490  18334.20 258037329175
67 Australia 1982 15184200   Oceania  74.740  19477.01 295742804309
68 Australia 1987 16257249   Oceania  76.320  21888.89 355853119294
69 Australia 1992 17481977   Oceania  77.560  23424.77 409511234952
70 Australia 1997 18565243   Oceania  78.830  26997.94 501223252921
71 Australia 2002 19546792   Oceania  80.370  30687.75 599847158654
72 Australia 2007 20434176   Oceania  81.235  34435.37 703658358894</code></pre>
</div>
<p>Or both:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, year<span class="op">=</span><span class="fl">2007</span>, country<span class="op">=</span><span class="st">"Australia"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     country year      pop continent lifeExp gdpPercap          gdp
72 Australia 2007 20434176   Oceania  81.235  34435.37 703658358894</code></pre>
</div>
<p>Let’s walk through the body of the function:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>calcGDP <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">year=</span><span class="cn">NULL</span>, <span class="at">country=</span><span class="cn">NULL</span>) {</span></code></pre>
</div>
<p>Here we’ve added two arguments, <code>year</code>, and
<code>country</code>. We’ve set <em>default arguments</em> for both as
<code>NULL</code> using the <code>=</code> operator in the function
definition. This means that those arguments will take on those values
unless the user specifies otherwise.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">year</span> <span class="op">%in%</span> <span class="va">year</span>, <span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">country</span> <span class="op">%in%</span> <span class="va">country</span>,<span class="op">]</span></span>
<span>  <span class="op">}</span></span></code></pre>
</div>
<p>Here, we check whether each additional argument is set to
<code>null</code>, and whenever they’re not <code>null</code> overwrite
the dataset stored in <code>dat</code> with a subset given by the
non-<code>null</code> argument.</p>
<p>Building these conditionals into the function makes it more flexible
for later. Now, we can use it to calculate the GDP for:</p>
<ul>
<li>The whole dataset;</li>
<li>A single year;</li>
<li>A single country;</li>
<li>A single combination of year and country.</li>
</ul>
<p>By using <code>%in%</code> instead, we can also give multiple years
or countries to those arguments.</p>
<div id="tip-pass-by-value" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-pass-by-value" class="callout-inner">
<h3 class="callout-title">Tip: Pass by value<a class="anchor" aria-label="anchor" href="#tip-pass-by-value"></a>
</h3>
<div class="callout-content">
<p>Functions in R almost always make copies of the data to operate on
inside of a function body. When we modify <code>dat</code> inside the
function we are modifying the copy of the gapminder dataset stored in
<code>dat</code>, not the original variable we gave as the first
argument.</p>
<p>This is called “pass-by-value” and it makes writing code much safer:
you can always be sure that whatever changes you make within the body of
the function, stay inside the body of the function.</p>
</div>
</div>
</div>
<div id="tip-function-scope" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-function-scope" class="callout-inner">
<h3 class="callout-title">Tip: Function scope<a class="anchor" aria-label="anchor" href="#tip-function-scope"></a>
</h3>
<div class="callout-content">
<p>Another important concept is scoping: any variables (or functions!)
you create or modify inside the body of a function only exist for the
lifetime of the function’s execution. When we call
<code>calcGDP()</code>, the variables <code>dat</code>, <code>gdp</code>
and <code>new</code> only exist inside the body of the function. Even if
we have variables of the same name in our interactive R session, they
are not modified in any way when executing a function.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>  gdp <span class="ot">&lt;-</span> dat<span class="sc">$</span>pop <span class="sc">*</span> dat<span class="sc">$</span>gdpPercap</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dat, <span class="at">gdp=</span>gdp)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">return</span>(new)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="er">}</span></span></code></pre>
</div>
<p>Finally, we calculated the GDP on our new subset, and created a new
data frame with that column added. This means when we call the function
later we can see the context for the returned GDP values, which is much
better than in our first attempt where we got a vector of numbers.</p>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>Test out your GDP function by calculating the GDP for New Zealand in
1987. How does this differ from New Zealand’s GDP in 1952?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to challenge 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span>, year <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1952</span>, <span class="fl">1987</span><span class="op">)</span>, country <span class="op">=</span> <span class="st">"New Zealand"</span><span class="op">)</span></span></code></pre>
</div>
<p>GDP for New Zealand in 1987: 65050008703</p>
<p>GDP for New Zealand in 1952: 21058193787</p>
</div>
</div>
</div>
</div>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5<a class="anchor" aria-label="anchor" href="#challenge-5"></a>
</h3>
<div class="callout-content">
<p>The <code>paste()</code> function can be used to combine text
together, e.g:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_practice</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Write"</span>, <span class="st">"programs"</span>, <span class="st">"for"</span>, <span class="st">"people"</span>, <span class="st">"not"</span>, <span class="st">"computers"</span><span class="op">)</span></span>
<span><span class="fu">paste</span><span class="op">(</span><span class="va">best_practice</span>, collapse<span class="op">=</span><span class="st">" "</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Write programs for people not computers"</code></pre>
</div>
<p>Write a function called <code>fence()</code> that takes two vectors
as arguments, called <code>text</code> and <code>wrapper</code>, and
prints out the text wrapped with the <code>wrapper</code>:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fence</span><span class="op">(</span>text<span class="op">=</span><span class="va">best_practice</span>, wrapper<span class="op">=</span><span class="st">"***"</span><span class="op">)</span></span></code></pre>
</div>
<p><em>Note:</em> the <code>paste()</code> function has an argument
called <code>sep</code>, which specifies the separator between text. The
default is a space: ” “. The default for <code>paste0()</code> is no
space”“.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to challenge 5</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>Write a function called <code>fence()</code> that takes two vectors
as arguments, called <code>text</code> and <code>wrapper</code>, and
prints out the text wrapped with the <code>wrapper</code>:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">text</span>, <span class="va">wrapper</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">text</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">wrapper</span>, <span class="va">text</span>, <span class="va">wrapper</span><span class="op">)</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">paste</span><span class="op">(</span><span class="va">text</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">best_practice</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Write"</span>, <span class="st">"programs"</span>, <span class="st">"for"</span>, <span class="st">"people"</span>, <span class="st">"not"</span>, <span class="st">"computers"</span><span class="op">)</span></span>
<span><span class="fu">fence</span><span class="op">(</span>text<span class="op">=</span><span class="va">best_practice</span>, wrapper<span class="op">=</span><span class="st">"***"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "*** Write programs for people not computers ***"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tip-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-1" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip-1"></a>
</h3>
<div class="callout-content">
<p>R has some unique aspects that can be exploited when performing more
complicated operations. We will not be writing anything that requires
knowledge of these more advanced concepts. In the future when you are
comfortable writing functions in R, you can learn more by reading the <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Environment-objects" class="external-link">R
Language Manual</a> or this <a href="https://adv-r.had.co.nz/Environments.html" class="external-link">chapter</a> from <a href="https://adv-r.had.co.nz/" class="external-link">Advanced R Programming</a> by Hadley
Wickham.</p>
</div>
</div>
</div>
<div id="tip-testing-and-documenting" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-testing-and-documenting" class="callout-inner">
<h3 class="callout-title">Tip: Testing and documenting<a class="anchor" aria-label="anchor" href="#tip-testing-and-documenting"></a>
</h3>
<div class="callout-content">
<p>It’s important to both test functions and document them:
Documentation helps you, and others, understand what the purpose of your
function is, and how to use it, and its important to make sure that your
function actually does what you think.</p>
<p>When you first start out, your workflow will probably look a lot like
this:</p>
<ol style="list-style-type: decimal">
<li>Write a function</li>
<li>Comment parts of the function to document its behaviour</li>
<li>Load in the source file</li>
<li>Experiment with it in the console to make sure it behaves as you
expect</li>
<li>Make any necessary bug fixes</li>
<li>Rinse and repeat.</li>
</ol>
<p>Formal documentation for functions, written in separate
<code>.Rd</code> files, gets turned into the documentation you see in
help files. The <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html" class="external-link">roxygen2</a>
package allows R coders to write documentation alongside the function
code and then process it into the appropriate <code>.Rd</code> files.
You will want to switch to this more formal method of writing
documentation when you start writing more complicated R projects. In
fact, packages are, in essence, bundles of functions with this formal
documentation. Loading your own functions through
<code>source("functions.R")</code> is equivalent to loading someone
else’s functions (or your own one day!) through
<code>library("package")</code>.</p>
<p>Formal automated tests can be written using the <a href="https://r-pkgs.had.co.nz/tests.html" class="external-link">testthat</a> package.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>function</code> to define a new function in R.</li>
<li>Use parameters to pass values into functions.</li>
<li>Use <code>stopifnot()</code> to flexibly check function arguments in
R.</li>
<li>Load functions into programs using <code>source()</code>.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-11-writing-data"><p>Content from <a href="11-writing-data.html">Writing Data</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/11-writing-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I save plots and data created in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To be able to write out plots and data from R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="saving-plots"><h2 class="section-heading">Saving plots<a class="anchor" aria-label="anchor" href="#saving-plots"></a>
</h2>
<hr class="half-width">
<p>You have already seen how to save the most recent plot you create in
<code>ggplot2</code>, using the command <code>ggsave</code>. As a
refresher:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"My_most_recent_plot.pdf"</span><span class="op">)</span></span></code></pre>
</div>
<p>You can save a plot from within RStudio using the ‘Export’ button in
the ‘Plot’ window. This will give you the option of saving as a .pdf or
as .png, .jpg or other image formats.</p>
<p>Sometimes you will want to save plots without creating them in the
‘Plot’ window first. Perhaps you want to make a pdf document with
multiple pages: each one a different plot, for example. Or perhaps
you’re looping through multiple subsets of a file, plotting data from
each subset, and you want to save each plot, but obviously can’t stop
the loop to click ‘Export’ for each one.</p>
<p>In this case you can use a more flexible approach. The function
<code>pdf</code> creates a new pdf device. You can control the size and
resolution using the arguments to this function.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pdf</span><span class="op">(</span><span class="st">"Life_Exp_vs_time.pdf"</span>, width<span class="op">=</span><span class="fl">12</span>, height<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">gapminder</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, colour<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># You then have to make sure to turn off the pdf device!</span></span>
<span></span>
<span><span class="fu">dev.off</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Open up this document and have a look.</p>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Rewrite your ‘pdf’ command to print a second page in the pdf, showing
a facet plot (hint: use <code>facet_grid</code>) of the same data with
one panel per continent.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pdf</span><span class="op">(</span><span class="st">"Life_Exp_vs_time.pdf"</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">lifeExp</span>, colour <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">continent</span><span class="op">)</span></span>
<span><span class="fu">dev.off</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The commands <code>jpeg</code>, <code>png</code> etc. are used
similarly to produce documents in different formats.</p>
</section><section id="writing-data"><h2 class="section-heading">Writing data<a class="anchor" aria-label="anchor" href="#writing-data"></a>
</h2>
<hr class="half-width">
<p>At some point, you’ll also want to write out data from R.</p>
<p>We can use the <code>write.table</code> function for this, which is
very similar to <code>read.table</code> from before.</p>
<p>Let’s create a data-cleaning script, for this analysis, we only want
to focus on the gapminder data for Australia:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aust_subset</span> <span class="op">&lt;-</span> <span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="st">"Australia"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu">write.table</span><span class="op">(</span><span class="va">aust_subset</span>,</span>
<span>  file<span class="op">=</span><span class="st">"cleaned-data/gapminder-aus.csv"</span>,</span>
<span>  sep<span class="op">=</span><span class="st">","</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s switch back to the shell to take a look at the data to make
sure it looks OK:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">head</span> cleaned-data/gapminder-aus.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>"country","year","pop","continent","lifeExp","gdpPercap"
"61","Australia",1952,8691212,"Oceania",69.12,10039.59564
"62","Australia",1957,9712569,"Oceania",70.33,10949.64959
"63","Australia",1962,10794968,"Oceania",70.93,12217.22686
"64","Australia",1967,11872264,"Oceania",71.1,14526.12465
"65","Australia",1972,13177000,"Oceania",71.93,16788.62948
"66","Australia",1977,14074100,"Oceania",73.49,18334.19751
"67","Australia",1982,15184200,"Oceania",74.74,19477.00928
"68","Australia",1987,16257249,"Oceania",76.32,21888.88903
"69","Australia",1992,17481977,"Oceania",77.56,23424.76683</code></pre>
</div>
<p>Hmm, that’s not quite what we wanted. Where did all these quotation
marks come from? Also the row numbers are meaningless.</p>
<p>Let’s look at the help file to work out how to change this
behaviour.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">write.table</span></span></code></pre>
</div>
<p>By default R will wrap character vectors with quotation marks when
writing out to file. It will also write out the row and column
names.</p>
<p>Let’s fix this:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.table</span><span class="op">(</span></span>
<span>  <span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="st">"Australia"</span>,<span class="op">]</span>,</span>
<span>  file<span class="op">=</span><span class="st">"cleaned-data/gapminder-aus.csv"</span>,</span>
<span>  sep<span class="op">=</span><span class="st">","</span>, quote<span class="op">=</span><span class="cn">FALSE</span>, row.names<span class="op">=</span><span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Now lets look at the data again using our shell skills:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">head</span> cleaned-data/gapminder-aus.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>country,year,pop,continent,lifeExp,gdpPercap
Australia,1952,8691212,Oceania,69.12,10039.59564
Australia,1957,9712569,Oceania,70.33,10949.64959
Australia,1962,10794968,Oceania,70.93,12217.22686
Australia,1967,11872264,Oceania,71.1,14526.12465
Australia,1972,13177000,Oceania,71.93,16788.62948
Australia,1977,14074100,Oceania,73.49,18334.19751
Australia,1982,15184200,Oceania,74.74,19477.00928
Australia,1987,16257249,Oceania,76.32,21888.88903
Australia,1992,17481977,Oceania,77.56,23424.76683</code></pre>
</div>
<p>That looks better!</p>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Write a data-cleaning script file that subsets the gapminder data to
include only data points collected since 1990.</p>
<p>Use this script to write out the new subset to a file in the
<code>cleaned-data/</code> directory.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.table</span><span class="op">(</span></span>
<span>  <span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1990</span>, <span class="op">]</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"cleaned-data/gapminder-after1990.csv"</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">","</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Save plots from RStudio using the ‘Export’ button.</li>
<li>Use <code>write.table</code> to save tabular data.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-12-plyr"><p>Content from <a href="12-plyr.html">Splitting and Combining Data Frames with plyr</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/12-plyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I do different calculations on different sets of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To be able to use the split-apply-combine strategy for data
analysis.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Previously we looked at how you can use functions to simplify your
code. We defined the <code>calcGDP</code> function, which takes the
gapminder dataset, and multiplies the population and GDP per capita
column. We also defined additional arguments so we could filter by
<code>year</code> and <code>country</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Takes a dataset and multiplies the population column</span></span>
<span><span class="co"># with the GDP per capita column.</span></span>
<span><span class="va">calcGDP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">year</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">country</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">year</span> <span class="op">%in%</span> <span class="va">year</span>, <span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">country</span> <span class="op">%in%</span> <span class="va">country</span>,<span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="va">dat</span><span class="op">$</span><span class="va">gdpPercap</span></span>
<span></span>
<span>  <span class="va">new</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">dat</span>, gdp<span class="op">=</span><span class="va">gdp</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>A common task you’ll encounter when working with data, is that you’ll
want to run calculations on different groups within the data. In the
above, we were calculating the GDP by multiplying two columns together.
But what if we wanted to calculated the mean GDP per continent?</p>
<p>We could run <code>calcGDP</code> and then take the mean of each
continent:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">withGDP</span> <span class="op">&lt;-</span> <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">withGDP</span><span class="op">[</span><span class="va">withGDP</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Africa"</span>, <span class="st">"gdp"</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 20904782844</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">withGDP</span><span class="op">[</span><span class="va">withGDP</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Americas"</span>, <span class="st">"gdp"</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 379262350210</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">withGDP</span><span class="op">[</span><span class="va">withGDP</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Asia"</span>, <span class="st">"gdp"</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 227233738153</code></pre>
</div>
<p>But this isn’t very <em>nice</em>. Yes, by using a function, you have
reduced a substantial amount of repetition. That <strong>is</strong>
nice. But there is still repetition. Repeating yourself will cost you
time, both now and later, and potentially introduce some nasty bugs.</p>
<p>We could write a new function that is flexible like
<code>calcGDP</code>, but this also takes a substantial amount of effort
and testing to get right.</p>
<p>The abstract problem we’re encountering here is know as
“split-apply-combine”:</p>
<figure><img src="fig/12-plyr-fig1.png" alt="Split apply combine" class="figure mx-auto d-block"></figure><p>We want to <em>split</em> our data into groups, in this case
continents, <em>apply</em> some calculations on that group, then
optionally <em>combine</em> the results together afterwards.</p>
<section id="the-plyr-package"><h2 class="section-heading">The <code>plyr</code> package<a class="anchor" aria-label="anchor" href="#the-plyr-package"></a>
</h2>
<hr class="half-width">
<p>For those of you who have used R before, you might be familiar with
the <code>apply</code> family of functions. While R’s built in functions
do work, we’re going to introduce you to another method for solving the
“split-apply-combine” problem. The <a href="https://had.co.nz/plyr/" class="external-link">plyr</a> package provides a set of
functions that we find more user friendly for solving this problem.</p>
<p>We installed this package in an earlier challenge. Let us load it
now:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"plyr"</span><span class="op">)</span></span></code></pre>
</div>
<p>Plyr has functions for operating on <code>lists</code>,
<code>data.frames</code> and <code>arrays</code> (matrices, or
n-dimensional vectors). Each function performs:</p>
<ol style="list-style-type: decimal">
<li>A <strong>split</strong>ting operation</li>
<li>
<strong>Apply</strong> a function on each split in turn.</li>
<li>Re<strong>combine</strong> output data as a single data object.</li>
</ol>
<p>The functions are named based on the data structure they expect as
input, and the data structure you want returned as output: [a]rray,
[l]ist, or [d]ata.frame. The first letter corresponds to the input data
structure, the second letter to the output data structure, and then the
rest of the function is named “ply”.</p>
<p>This gives us 9 core functions **ply. There are an additional three
functions which will only perform the split and apply steps, and not any
combine step. They’re named by their input data type and represent null
output by a <code>_</code> (see table)</p>
<p>Note here that plyr’s use of “array” is different to R’s, an array in
ply can include a vector or matrix.</p>
<figure><img src="fig/12-plyr-fig2.png" alt="Full apply suite" class="figure mx-auto d-block"></figure><p>Each of the xxply functions (<code>daply</code>, <code>ddply</code>,
<code>llply</code>, <code>laply</code>, …) has the same structure and
has 4 key features and structure:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xxply</span><span class="op">(</span><span class="va">.data</span>, <span class="va">.variables</span>, <span class="va">.fun</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>The first letter of the function name gives the input type and the
second gives the output type.</li>
<li>.data - gives the data object to be processed</li>
<li>.variables - identifies the splitting variables</li>
<li>.fun - gives the function to be called on each piece</li>
</ul>
<p>Now we can quickly calculate the mean GDP per continent:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ddply</span><span class="op">(</span></span>
<span> .data <span class="op">=</span> <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>,</span>
<span> .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span> .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gdp</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  continent           V1
1    Africa  20904782844
2  Americas 379262350210
3      Asia 227233738153
4    Europe 269442085301
5   Oceania 188187105354</code></pre>
</div>
<p>Let us walk through the previous code:</p>
<ul>
<li>The <code>ddply</code> function feeds in a <code>data.frame</code>
(function starts with <strong>d</strong>) and returns another
<code>data.frame</code> (2nd letter is a <strong>d</strong>)</li>
<li>the first argument we gave was the data.frame we wanted to operate
on: in this case the gapminder data. We called <code>calcGDP</code> on
it first so that it would have the additional <code>gdp</code> column
added to it.</li>
<li>The second argument indicated our split criteria: in this case the
“continent” column. Note that we gave the name of the column, not the
values of the column like we had done previously with subsetting. Plyr
takes care of these implementation details for you.</li>
<li>The third argument is the function we want to apply to each grouping
of the data. We had to define our own short function here: each subset
of the data gets stored in <code>x</code>, the first argument of our
function. This is an anonymous function: we haven’t defined it
elsewhere, and it has no name. It only exists in the scope of our call
to <code>ddply</code>.</li>
</ul>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Calculate the average life expectancy per continent. Which has the
longest? Which has the shortest?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ddply</span><span class="op">(</span></span>
<span> .data <span class="op">=</span> <span class="va">gapminder</span>,</span>
<span> .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span> .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Oceania has the longest and Africa the shortest.</p>
</div>
</div>
</div>
</div>
<p>What if we want a different type of output data structure?:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dlply</span><span class="op">(</span></span>
<span> .data <span class="op">=</span> <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>,</span>
<span> .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span> .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gdp</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$Africa
[1] 20904782844

$Americas
[1] 379262350210

$Asia
[1] 227233738153

$Europe
[1] 269442085301

$Oceania
[1] 188187105354

attr(,"split_type")
[1] "data.frame"
attr(,"split_labels")
  continent
1    Africa
2  Americas
3      Asia
4    Europe
5   Oceania</code></pre>
</div>
<p>We called the same function again, but changed the second letter to
an <code>l</code>, so the output was returned as a list.</p>
<p>We can specify multiple columns to group by:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ddply</span><span class="op">(</span></span>
<span> .data <span class="op">=</span> <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>,</span>
<span> .variables <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"continent"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span> .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gdp</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   continent year           V1
1     Africa 1952   5992294608
2     Africa 1957   7359188796
3     Africa 1962   8784876958
4     Africa 1967  11443994101
5     Africa 1972  15072241974
6     Africa 1977  18694898732
7     Africa 1982  22040401045
8     Africa 1987  24107264108
9     Africa 1992  26256977719
10    Africa 1997  30023173824
11    Africa 2002  35303511424
12    Africa 2007  45778570846
13  Americas 1952 117738997171
14  Americas 1957 140817061264
15  Americas 1962 169153069442
16  Americas 1967 217867530844
17  Americas 1972 268159178814
18  Americas 1977 324085389022
19  Americas 1982 363314008350
20  Americas 1987 439447790357
21  Americas 1992 489899820623
22  Americas 1997 582693307146
23  Americas 2002 661248623419
24  Americas 2007 776723426068
25      Asia 1952  34095762661
26      Asia 1957  47267432088
27      Asia 1962  60136869012
28      Asia 1967  84648519224
29      Asia 1972 124385747313
30      Asia 1977 159802590186
31      Asia 1982 194429049919
32      Asia 1987 241784763369
33      Asia 1992 307100497486
34      Asia 1997 387597655323
35      Asia 2002 458042336179
36      Asia 2007 627513635079
37    Europe 1952  84971341466
38    Europe 1957 109989505140
39    Europe 1962 138984693095
40    Europe 1967 173366641137
41    Europe 1972 218691462733
42    Europe 1977 255367522034
43    Europe 1982 279484077072
44    Europe 1987 316507473546
45    Europe 1992 342703247405
46    Europe 1997 383606933833
47    Europe 2002 436448815097
48    Europe 2007 493183311052
49   Oceania 1952  54157223944
50   Oceania 1957  66826828013
51   Oceania 1962  82336453245
52   Oceania 1967 105958863585
53   Oceania 1972 134112109227
54   Oceania 1977 154707711162
55   Oceania 1982 176177151380
56   Oceania 1987 209451563998
57   Oceania 1992 236319179826
58   Oceania 1997 289304255183
59   Oceania 2002 345236880176
60   Oceania 2007 403657044512</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">daply</span><span class="op">(</span></span>
<span> .data <span class="op">=</span> <span class="fu">calcGDP</span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>,</span>
<span> .variables <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"continent"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span> .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gdp</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          year
continent          1952         1957         1962         1967         1972
  Africa     5992294608   7359188796   8784876958  11443994101  15072241974
  Americas 117738997171 140817061264 169153069442 217867530844 268159178814
  Asia      34095762661  47267432088  60136869012  84648519224 124385747313
  Europe    84971341466 109989505140 138984693095 173366641137 218691462733
  Oceania   54157223944  66826828013  82336453245 105958863585 134112109227
          year
continent          1977         1982         1987         1992         1997
  Africa    18694898732  22040401045  24107264108  26256977719  30023173824
  Americas 324085389022 363314008350 439447790357 489899820623 582693307146
  Asia     159802590186 194429049919 241784763369 307100497486 387597655323
  Europe   255367522034 279484077072 316507473546 342703247405 383606933833
  Oceania  154707711162 176177151380 209451563998 236319179826 289304255183
          year
continent          2002         2007
  Africa    35303511424  45778570846
  Americas 661248623419 776723426068
  Asia     458042336179 627513635079
  Europe   436448815097 493183311052
  Oceania  345236880176 403657044512</code></pre>
</div>
<p>You can use these functions in place of <code>for</code> loops (and
it is usually faster to do so). To replace a for loop, put the code that
was in the body of the <code>for</code> loop inside an anonymous
function.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">d_ply</span><span class="op">(</span></span>
<span>  .data<span class="op">=</span><span class="va">gapminder</span>,</span>
<span>  .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span>  .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">meanGDPperCap</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gdpPercap</span><span class="op">)</span></span>
<span>    <span class="fu">print</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span></span>
<span>      <span class="st">"The mean GDP per capita for"</span>, <span class="fu">unique</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">continent</span><span class="op">)</span>,</span>
<span>      <span class="st">"is"</span>, <span class="fu">format</span><span class="op">(</span><span class="va">meanGDPperCap</span>, big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span></span>
<span>   <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "The mean GDP per capita for Africa is 2,193.755"
[1] "The mean GDP per capita for Americas is 7,136.11"
[1] "The mean GDP per capita for Asia is 7,902.15"
[1] "The mean GDP per capita for Europe is 14,469.48"
[1] "The mean GDP per capita for Oceania is 18,621.61"</code></pre>
</div>
<div id="tip-printing-numbers" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-printing-numbers" class="callout-inner">
<h3 class="callout-title">Tip: printing numbers<a class="anchor" aria-label="anchor" href="#tip-printing-numbers"></a>
</h3>
<div class="callout-content">
<p>The <code>format</code> function can be used to make numeric values
“pretty” for printing out in messages.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Calculate the average life expectancy per continent and year. Which
had the longest and shortest in 2007? Which had the greatest change in
between 1952 and 2007?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solution</span> <span class="op">&lt;-</span> <span class="fu">ddply</span><span class="op">(</span></span>
<span> .data <span class="op">=</span> <span class="va">gapminder</span>,</span>
<span> .variables <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"continent"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span> .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">mean</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">solution_2007</span> <span class="op">&lt;-</span> <span class="va">solution</span><span class="op">[</span><span class="va">solution</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2007</span>, <span class="op">]</span></span>
<span><span class="va">solution_2007</span></span></code></pre>
</div>
<p>Oceania had the longest average life expectancy in 2007 and Africa
the lowest.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solution_1952_2007</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">solution</span><span class="op">[</span><span class="va">solution</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1952</span>, <span class="op">]</span>, <span class="va">solution_2007</span><span class="op">)</span></span>
<span><span class="va">difference_1952_2007</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>continent <span class="op">=</span> <span class="va">solution_1952_2007</span><span class="op">$</span><span class="va">continent</span>,</span>
<span>                                   year_1957 <span class="op">=</span> <span class="va">solution_1952_2007</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                   year_2007 <span class="op">=</span> <span class="va">solution_1952_2007</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                   difference <span class="op">=</span> <span class="va">solution_1952_2007</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">solution_1952_2007</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">difference_1952_2007</span></span></code></pre>
</div>
<p>Asia had the greatest difference, and Oceania the least.</p>
</div>
</div>
</div>
</div>
<div id="alternate-challenge" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="alternate-challenge" class="callout-inner">
<h3 class="callout-title">Alternate Challenge<a class="anchor" aria-label="anchor" href="#alternate-challenge"></a>
</h3>
<div class="callout-content">
<p>Without running them, which of the following will calculate the
average life expectancy per continent:</p>
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ddply</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">gapminder</span>,</span>
<span>  .variables <span class="op">=</span> <span class="va">gapminder</span><span class="op">$</span><span class="va">continent</span>,</span>
<span>  .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">)</span> <span class="op">{</span></span>
<span>     <span class="fu">mean</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">$</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ddply</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">gapminder</span>,</span>
<span>  .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span>  .fun <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">$</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ddply</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">gapminder</span>,</span>
<span>  .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span>  .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">)</span> <span class="op">{</span></span>
<span>     <span class="fu">mean</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">$</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">adply</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">gapminder</span>,</span>
<span>  .variables <span class="op">=</span> <span class="st">"continent"</span>,</span>
<span>  .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">)</span> <span class="op">{</span></span>
<span>     <span class="fu">mean</span><span class="op">(</span><span class="va">dataGroup</span><span class="op">$</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Alternative Challenge</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Answer 3 will calculate the average life expectancy per
continent.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use the <code>plyr</code> package to split data, apply functions to
subsets, and combine the results.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-13b-dplyr"><p>Content from <a href="13b-dplyr.html">Data Frame Manipulation with dplyr</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/13b-dplyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the most common types of operations performed on data
sets?</li>
<li>How can you perform these operations efficiently and clearly?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>SUBSET a data set to a specific subset of rows and/or columns.</li>
<li>SORT or RENAME columns.</li>
<li>MAKE NEW COLUMNS, perhaps using old columns as inputs.</li>
<li>Generate SUMMARIES of our data set.</li>
<li>Use PIPES to string multiple operations on the same data set
together.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="preparation-and-setup"><h2 class="section-heading">Preparation and setup<a class="anchor" aria-label="anchor" href="#preparation-and-setup"></a>
</h2>
<hr class="half-width">
<p>Note: This lesson uses the <strong>gapminder data set</strong>. This
data set can be downloaded <a href="https://drive.google.com/file/d/1sBkIJlC_6fImNZhyV0XfsllyUD-hSmoS/view?usp=sharing" class="external-link">here</a>.
Make sure to load the data set into your global environment before
continuing.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap</span> <span class="op">=</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/gapminder_data.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>Also, this lesson will revolve around use of the optional “add-on”
package <code>dplyr</code>. <code>dplyr</code> is a package in the
“tidyverse”–an array of useful tools that are designed to look similar
and work well together and that make R much more powerful to use but
also a lot different than “Base R.” Everything we do in this lesson can
be done in “Base R” instead, but it won’t (typically) be as efficient,
easy, or clear!</p>
<p><code>dplyr</code>, like many add-on packages, is
<strong>not</strong> installed with R. So, we must install it before we
can use it:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span> <span class="co">#Only run once!</span></span></code></pre>
</div>
<p>You only need to install a package once, so there’s no need to run
the above command more than once. However, packages are updated
occasionally. When updates are available, you can re-install new
versions using the same <code>install.packages()</code> function.</p>
<p>Once a package is installed, it still isn’t “turned on” by default.
So, to turn on <code>dplyr</code> so that we can access its unique
features, we use the <code>library()</code> function:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<p>The above command must be run every time you start up a new session
of R and want access to <code>dplyr</code>’s features!</p>
</section><section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>R users work with data frames A LOT…like, <em>a lot</em>. When
working with data frames, we very often find ourselves wanting to
perform a few specific actions, such as cutting certain rows or columns,
renaming columns, or transforming columns into new ones.</p>
<p>We can do ALL of those things in “Base R” if we wanted to, and we’ve
already seen ways to do some of those things in previous lessons!
However, <code>dplyr</code> makes doing all these things easier, more
concise, AND more intuitive. It does this by adding specific “verbs”
(functions) that have a consistent syntax and structure (as well as
intuitive names) and by allowing us to write our code in connected
“sentences” using those verbs so that more things can happen in a single
command without that command also getting harder to read.</p>
<p>In this lesson, we’ll go through each of these commands, showing
their individual uses for examining and manipulating the gapminder data
set:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">gap</span><span class="op">)</span> <span class="co">#To remind us what the columns are called and what data are contained in this data set</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap
1 Afghanistan 1952  8425333      Asia  28.801  779.4453
2 Afghanistan 1957  9240934      Asia  30.332  820.8530
3 Afghanistan 1962 10267083      Asia  31.997  853.1007
4 Afghanistan 1967 11537966      Asia  34.020  836.1971
5 Afghanistan 1972 13079460      Asia  36.088  739.9811
6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</div>
</section><section id="select-and-rename"><h2 class="section-heading">SELECT and RENAME<a class="anchor" aria-label="anchor" href="#select-and-rename"></a>
</h2>
<hr class="half-width">
<p>What if we only wanted a subset of the columns in a data set? The
<code>dplyr</code> verb corresponding to this desire is
<code>select()</code>.</p>
<p><strong>Important</strong>: Every verb in <code>dplyr</code>, such as
<code>select()</code>, takes as its first input the data frame you are
trying to manipulate. After that first input, every <em>subsequent</em>
input you provide becomes another “thing” you want the function to do to
that data frame. What I mean by that last part will hopefully become
more clear with an example.</p>
<p>Suppose I wanted a version of the gapminder data set that included
only the <code>country</code> and <code>year</code> columns. I could use
<code>select()</code> to achieve that desire like this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_shrunk</span> <span class="op">=</span> <span class="fu">select</span><span class="op">(</span><span class="va">gap</span>, <span class="co">#The first input is ALWAYS the data frame to be manipulated.</span></span>
<span>               <span class="va">country</span>, <span class="va">year</span><span class="op">)</span> <span class="co">#All the rest of the inputs become "things to do". Here, that's specific columns to select, referenced by name.</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_shrunk</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year
1 Afghanistan 1952
2 Afghanistan 1957
3 Afghanistan 1962
4 Afghanistan 1967
5 Afghanistan 1972
6 Afghanistan 1977</code></pre>
</div>
<p>In the example above, I provided my data frame as the first input to
<code>select()</code> and all the columns I wanted to <em>select</em> as
subsequent inputs. As a result, I ended up with a shrunken version of
the original data set, one that contains only those two columns.</p>
<p>In the indexing lesson, we learned some “tricks” that work with
<code>select()</code> too. For example, you can select a sequence of
columns that are consecutive by using the <code>:</code> operator and
the names of the first and last columns in that sequence like so:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_sequence</span> <span class="op">=</span> <span class="fu">select</span><span class="op">(</span><span class="va">gap</span>, </span>
<span>                      <span class="va">pop</span><span class="op">:</span><span class="va">lifeExp</span><span class="op">)</span> </span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_sequence</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       pop continent lifeExp
1  8425333      Asia  28.801
2  9240934      Asia  30.332
3 10267083      Asia  31.997
4 11537966      Asia  34.020
5 13079460      Asia  36.088
6 14880372      Asia  38.438</code></pre>
</div>
<p>We can also use the <code>-</code> operator to instead specify
columns we want to <em>reject</em> instead of keep. For example, to
retain every column <em>except</em> the <code>year</code> column, we
could do this:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_noyear</span> <span class="op">=</span> <span class="fu">select</span><span class="op">(</span><span class="va">gap</span>, </span>
<span>                    <span class="op">-</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_noyear</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country      pop continent lifeExp gdpPercap
1 Afghanistan  8425333      Asia  28.801  779.4453
2 Afghanistan  9240934      Asia  30.332  820.8530
3 Afghanistan 10267083      Asia  31.997  853.1007
4 Afghanistan 11537966      Asia  34.020  836.1971
5 Afghanistan 13079460      Asia  36.088  739.9811
6 Afghanistan 14880372      Asia  38.438  786.1134</code></pre>
</div>
<p>We can also use <code>select()</code> to <em>rearrange</em> columns
by specifying the column names in the new order we want them to be
in:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_reordered</span> <span class="op">=</span> <span class="fu">select</span><span class="op">(</span><span class="va">gap</span>, </span>
<span>                       <span class="va">year</span>, <span class="va">country</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_reordered</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  year     country
1 1952 Afghanistan
2 1957 Afghanistan
3 1962 Afghanistan
4 1967 Afghanistan
5 1972 Afghanistan
6 1977 Afghanistan</code></pre>
</div>
<p>What if wanted to rename some of our columns? The <code>dplyr</code>
verb corresponding to this goal is <code>rename()</code>.</p>
<p>As with <code>select()</code> (and all <code>dplyr</code> verbs),
<code>rename()</code>’s first input is the data frame we’re
manipulating. Each subsequent input needs to be an “instructions list,”
with the new name to the left of an <code>=</code> operator and the old
column name to the right of it (what I like to call <em>“new = old”
format</em>).</p>
<p>For example, to rename the <code>pop</code> column to “population,”
which I would personally find more intuitive, we would do the
following:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_renamed</span> <span class="op">=</span> <span class="fu">rename</span><span class="op">(</span><span class="va">gap</span>, </span>
<span>                     population <span class="op">=</span> <span class="va">pop</span><span class="op">)</span> <span class="co">#New = old format</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_renamed</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year population continent lifeExp gdpPercap
1 Afghanistan 1952    8425333      Asia  28.801  779.4453
2 Afghanistan 1957    9240934      Asia  30.332  820.8530
3 Afghanistan 1962   10267083      Asia  31.997  853.1007
4 Afghanistan 1967   11537966      Asia  34.020  836.1971
5 Afghanistan 1972   13079460      Asia  36.088  739.9811
6 Afghanistan 1977   14880372      Asia  38.438  786.1134</code></pre>
</div>
<p>It’s as simple as that! If we wanted to rename multiple columns, we
could just add more subsequent inputs to the same <code>rename()</code>
call.</p>
</section><section id="the-magic-of-pipes"><h2 class="section-heading">The magic of pipes<a class="anchor" aria-label="anchor" href="#the-magic-of-pipes"></a>
</h2>
<hr class="half-width">
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>What if I wanted to <em>first</em> eliminate some columns and
<em>then</em> rename some of the remaining columns? How would you go
about doing that?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Your <em>first</em> impulse might be to do this in two distinct
commands, saving <em>intermediate objects</em> after each step, like
so:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_selected</span> <span class="op">=</span> <span class="fu">select</span><span class="op">(</span><span class="va">gap</span>, </span>
<span>                      <span class="va">country</span><span class="op">:</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="va">gap_remonikered</span> <span class="op">=</span> <span class="fu">rename</span><span class="op">(</span><span class="va">gap_selected</span>, </span>
<span>               population <span class="op">=</span> <span class="va">pop</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_remonikered</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year population
1 Afghanistan 1952    8425333
2 Afghanistan 1957    9240934
3 Afghanistan 1962   10267083
4 Afghanistan 1967   11537966
5 Afghanistan 1972   13079460
6 Afghanistan 1977   14880372</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>There’s <strong>nothing</strong> <em>wrong</em> with this approach,
but it’s a little…tedious. Plus, if you don’t pick really good names for
each <em>intermediate object</em>, it can get confusing and hard for you
and others to follow along with.</p>
<p>I hope you’re thinking “I bet there’s an easier way.” And there is!
We can combine these two discrete steps into one easy-to-read
“sentence.” The only catch is we have to use a strange operator called a
<em>pipe</em> to do it.</p>
<p><code>dplyr</code> pipes look like this: <code>%&gt;%</code>. On
Windows, the hotkey to render a pipe is control + shift + M, in case
you’d rather type that then “%&gt;%”! On Mac, it’s similar: Command +
shift + M.</p>
<p>Pipes may look a little funny, but they do something <em>really</em>
cool. They take the “thing” produced on their left (once all the
operations over there are complete) and “pump” that thing into the
operations on their right, specifically into the first available input
slot.</p>
<p>This is easier to explain with an example, so let’s see how to use
pipes to perform the two operations we did above in a single
command.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap.final</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">country</span><span class="op">:</span><span class="va">pop</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>population <span class="op">=</span> <span class="va">pop</span><span class="op">)</span> </span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap.final</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year population
1 Afghanistan 1952    8425333
2 Afghanistan 1957    9240934
3 Afghanistan 1962   10267083
4 Afghanistan 1967   11537966
5 Afghanistan 1972   13079460
6 Afghanistan 1977   14880372</code></pre>
</div>
<p>The command above says: “Take the <code>gap</code> data set and pump
it into <code>select()</code>’s first input slot (where it belongs
anyway). Then, do <code>select()</code>’s operations (which yield a new,
manipulated data set) and pump <em>that</em> resulting data set into
<code>rename()</code>’s first input slot. Then, when all that’s done,
save the result into an object called <code>gap.final</code>.”</p>
<p>Hopefully, you can see how this might be easier to read and follow
along with and also be more efficient! It also explains why every
<code>dplyr</code> verb’s first input slot is the data frame to be
manipulated–it makes every verb ready to receive inputs from “upstream”
via a pipe!</p>
</section><section id="filter-arrange-and-mutate"><h2 class="section-heading">FILTER, ARRANGE, and MUTATE<a class="anchor" aria-label="anchor" href="#filter-arrange-and-mutate"></a>
</h2>
<hr class="half-width">
<p>What if we only wanted to look at the data from a specific continent
or a specific time span (i.e., we want just specific rows)? The
<code>dplyr</code> verb corresponding to this action is
<code>filter()</code> (see, I said the verbs have intuitive names!).</p>
<p>Each input given to <code>filter()</code> past the first (which is
ALWAYS the data frame to be manipulated, as we’ve firmly established) is
a <em>logical rule</em>, which is something we’ve seen before (e.g.,
when studying <code>if()</code>). Here, each <em>logical rule</em> will
consist of the name of the column we’ll check the values of, a
<em>logical operator</em> (like <code>==</code> or <code>&lt;=</code>),
and a “threshold” to check against. If <strong>all</strong> the
<em>logical rules</em> given for a particular row pass, we keep that
row. Otherwise, we remove it from the new data frame we create.</p>
<p>For example, here’s how we’d filter our data set to just rows where
the value in the <code>continent</code> column is
<strong>exactly</strong> <code>Europe</code>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_europe</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Europe"</span><span class="op">)</span> <span class="co">#The column to check values in, a logical operator, and the "value for comparison."</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_europe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  country year     pop continent lifeExp gdpPercap
1 Albania 1952 1282697    Europe   55.23  1601.056
2 Albania 1957 1476505    Europe   59.28  1942.284
3 Albania 1962 1728137    Europe   64.82  2312.889
4 Albania 1967 1984060    Europe   66.22  2760.197
5 Albania 1972 2263554    Europe   67.69  3313.422
6 Albania 1977 2509048    Europe   68.93  3533.004</code></pre>
</div>
<p>As another example, here’s how we’d filter our data set to just rows
with data from before the year <code>1975</code>:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_pre1975</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="fl">1975</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_pre1975</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap
1 Afghanistan 1952  8425333      Asia  28.801  779.4453
2 Afghanistan 1957  9240934      Asia  30.332  820.8530
3 Afghanistan 1962 10267083      Asia  31.997  853.1007
4 Afghanistan 1967 11537966      Asia  34.020  836.1971
5 Afghanistan 1972 13079460      Asia  36.088  739.9811
6     Albania 1952  1282697    Europe  55.230 1601.0561</code></pre>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>What if we wanted data only from <em>between</em> the years 1970 and
1979? How would you achieve this goal using <code>filter()</code>? Hint:
There are <em>at least</em> three ways you should be able to think
of!</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Here are three different solutions. In the first, we use the
<code>&amp;</code> (and) operator to specify two rules that a value in
the <code>year</code> column must satisfy:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">and_option</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1969</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;</span> <span class="fl">1980</span><span class="op">)</span></span></code></pre>
</div>
<p>However, I explained earlier that, with <code>filter()</code>, every
input past the first is a <em>logical rule</em> a row must satisfy for
that row to be kept. So, a comma between <em>logical rules</em> here is
just as good as <code>&amp;</code> is:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comma_option</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1969</span>, <span class="va">year</span> <span class="op">&lt;</span> <span class="fl">1980</span><span class="op">)</span></span></code></pre>
</div>
<p>Or, if you would prefer it, you can always just stack multiple
<code>filter()</code> calls back to back:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stacked_option</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1969</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="fl">1980</span><span class="op">)</span></span></code></pre>
</div>
<p>There’s nothing right or wrong with any of these options, so which do
you prefer? Why?</p>
</div>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p><strong>Important</strong>: When chaining dplyr verbs together, order
matters! Why does the following code fail when we try to run it?</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">this_will_fail</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">pop</span><span class="op">:</span><span class="va">lifeExp</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="fl">1975</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Recall that the <code>year</code> column is not one of the columns
that exists in between the <code>pop</code> and <code>lifeExp</code>
columns. So, the <code>year</code> column gets cuts by the
<code>select()</code> call here <em>before</em> we get to the
<code>filter()</code> call, so the <code>filter()</code> call then can’t
find that column to use it.</p>
<p>Considering that <code>dplyr</code> “sentences” can get long and
complicated, it’s good to remember to be thoughtful about the order you
specify actions in!</p>
</div>
</div>
</div>
</div>
<p>What if we wanted to <em>sort</em> our data set by the values in one
or more columns? The <code>dplyr</code> verb for this desire is
<code>arrange()</code>.</p>
<p>Every input past the first given to <code>arrange()</code> is a
column we want to sort by, with columns provided earlier taking
“precedence” in the sorting over later ones.</p>
<p>For example, here’s how we’d sort our data set by the
<code>lifeExp</code> column:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_sorted</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_sorted</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       country year     pop continent lifeExp gdpPercap
1       Rwanda 1992 7290203    Africa  23.599  737.0686
2  Afghanistan 1952 8425333      Asia  28.801  779.4453
3       Gambia 1952  284320    Africa  30.000  485.2307
4       Angola 1952 4232095    Africa  30.015 3520.6103
5 Sierra Leone 1952 2143249    Africa  30.331  879.7877
6  Afghanistan 1957 9240934      Asia  30.332  820.8530</code></pre>
</div>
<p>This sorts the data in ascending order by default. If we want to
reverse the sorting, we can use the <code>desc()</code> function:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_sorted_down</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_sorted_down</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          country year       pop continent lifeExp gdpPercap
1           Japan 2007 127467972      Asia  82.603  31656.07
2 Hong Kong China 2007   6980412      Asia  82.208  39724.98
3           Japan 2002 127065841      Asia  82.000  28604.59
4         Iceland 2007    301931    Europe  81.757  36180.79
5     Switzerland 2007   7554661    Europe  81.701  37506.42
6 Hong Kong China 2002   6762476      Asia  81.495  30209.02</code></pre>
</div>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>I mentioned above that you can provide multiple inputs to
<code>arrange()</code>, but it’s a little hard to explain what this
actually does, so let’s try it:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_2xsorted</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">year</span>, <span class="va">continent</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_2xsorted</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       country year     pop continent lifeExp gdpPercap
1      Algeria 1952 9279525    Africa  43.077 2449.0082
2       Angola 1952 4232095    Africa  30.015 3520.6103
3        Benin 1952 1738315    Africa  38.223 1062.7522
4     Botswana 1952  442308    Africa  47.622  851.2411
5 Burkina Faso 1952 4469979    Africa  31.975  543.2552
6      Burundi 1952 2445618    Africa  39.031  339.2965</code></pre>
</div>
<p>What did the command above do? Why? What would change if you reversed
the order of <code>continent</code> and <code>year</code> in the
call?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>This command <em>first</em> sorted the data set by the unique values
in the <code>year</code> column. It then “broke ties,” where two rows
have the <strong>same</strong> value for <code>year</code>, by
<em>then</em> sorting by unique values in the <code>continent</code>
column. So, we get records for <code>Africa</code> sooner than we get
records for <code>Asia</code> for the same year.</p>
<p>If we reversed the order of our two inputs, we’d instead get
<strong>all</strong> records for <code>Africa</code> before getting
<strong>any</strong> records for <code>Asia</code>. Within a
<code>continent</code>, though, we’d get back earlier records before
getting back more recent ones.</p>
<p>This mirrors the behavior of “multi-column sorting” functionality as
it exists in programs like Microsoft Excel.</p>
</div>
</div>
</div>
</div>
<p>What if we wanted to make a new column using an old column’s values
as inputs? This is the kind of thing many of us would think to do in
Microsoft Excel, where it isn’t always easy or reproducible. Thankfully,
we have the <code>dplyr</code> verb <code>mutate()</code> for this.</p>
<p>Every input to <code>mutate()</code> past the first is an
“instructions list” of how to make a new column using one or more old
columns, and these “instructions lists” also follow <em>“new = old”
format</em>.</p>
<p>For example, here’s how we would create a new column called
<code>pop1K</code> that is made by dividing the <code>pop</code>
column’s values by 1000:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_newcol</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>pop1K <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="va">pop</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="co">#New = old format</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_newcol</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap pop1K
1 Afghanistan 1952  8425333      Asia  28.801  779.4453  8425
2 Afghanistan 1957  9240934      Asia  30.332  820.8530  9241
3 Afghanistan 1962 10267083      Asia  31.997  853.1007 10267
4 Afghanistan 1967 11537966      Asia  34.020  836.1971 11538
5 Afghanistan 1972 13079460      Asia  36.088  739.9811 13079
6 Afghanistan 1977 14880372      Asia  38.438  786.1134 14880</code></pre>
</div>
<p>You’ll note that the old <code>pop</code> column is still around
after this. If you want to get rid of it, you can provide
<code>.keep = "unused"</code> as another input to <code>mutate()</code>
and it will eliminate any old columns that were used to create new ones.
Try it!</p>
<p>To keep things simple here, we won’t show you this, but
<code>mutate()</code>’s “instructions lists” can get <em>very</em>
complicated if you need them to! So, stop here to briefly imagine how
you could perform a more complicated <code>mutate()</code> call here
than the one we showed you.</p>
</section><section id="group_by-and-summarize"><h2 class="section-heading">GROUP_BY and SUMMARIZE<a class="anchor" aria-label="anchor" href="#group_by-and-summarize"></a>
</h2>
<hr class="half-width">
<p>Perhaps the most common (and powerful) action we might want to take
on a data set is generating summaries from it. “What’s the mean of
<em>this</em> column?” or “What’s the median value for all the different
groups in <em>that</em> column?”, for example.</p>
<p>What if we wanted to calculate the mean life expectancy across all
years by country for the gapminder data set?</p>
<p>We <em>could</em> use <code>filter()</code> to go country by country
(one at a time), save the resulting data sets as <em>intermediate
objects</em>, and then take a mean manually of the <code>lifeExp</code>
column for each <em>intermediate object</em>…but what a
<strong>pain</strong> that would be!</p>
<p>Thankfully, we don’t have to; instead, we can just use
<code>group_by()</code> and <code>summarize()</code>! Unlike other
<code>dplyr</code> verbs we’ve met, these are a duo–they are
<strong>almost always</strong> used together and, importantly, we
<em>always</em> have to use <code>group_by()</code> first.</p>
<p>So, let’s start by understanding what <code>group_by()</code> does.
Each input given to <code>group_by()</code> past the first creates
groupings in the data. Specifically, you provide one (or more) names of
columns and R will find all the different values in that column (such as
all the different unique country names) and subtly “bundle up” all the
rows that belong to each group.</p>
<p>This is easier to show you than to explain, so let’s try it:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_grouped</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="co">#Bundle up all the rows that belong to each different value in this country column.</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_grouped</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 6
# Groups:   country [1]
  country      year      pop continent lifeExp gdpPercap
  &lt;chr&gt;       &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan  1952  8425333 Asia         28.8      779.
2 Afghanistan  1957  9240934 Asia         30.3      821.
3 Afghanistan  1962 10267083 Asia         32.0      853.
4 Afghanistan  1967 11537966 Asia         34.0      836.
5 Afghanistan  1972 13079460 Asia         36.1      740.
6 Afghanistan  1977 14880372 Asia         38.4      786.</code></pre>
</div>
<p>When we actually look at the new data set we’ve created, it will
<em>look</em> as though nothing has changed. And, in a lot of ways,
nothing has! However, if you examine <code>gap_grouped</code> in your R
Studio’s ‘Environment’ Pane, you’ll notice that <code>gap_grouped</code>
is considered a “grouped data frame” now instead of a plain-old one.</p>
<p>We can see what that means by using the <code>str()</code>
(“structure”) function to peek “under the hood” at
<code>gap_grouped</code>:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">gap_grouped</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>gropd_df [1,704 × 6] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ country  : chr [1:1704] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...
 $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ pop      : num [1:1704] 8425333 9240934 10267083 11537966 13079460 ...
 $ continent: chr [1:1704] "Asia" "Asia" "Asia" "Asia" ...
 $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
 $ gdpPercap: num [1:1704] 779 821 853 836 740 ...
 - attr(*, "groups")= tibble [142 × 2] (S3: tbl_df/tbl/data.frame)
  ..$ country: chr [1:142] "Afghanistan" "Albania" "Algeria" "Angola" ...
  ..$ .rows  : list&lt;int&gt; [1:142] 
  .. ..$ : int [1:12] 1 2 3 4 5 6 7 8 9 10 ...
  .. ..$ : int [1:12] 13 14 15 16 17 18 19 20 21 22 ...
  .. ..$ : int [1:12] 25 26 27 28 29 30 31 32 33 34 ...
  .. ..$ : int [1:12] 37 38 39 40 41 42 43 44 45 46 ...
  .. ..$ : int [1:12] 49 50 51 52 53 54 55 56 57 58 ...
  .. ..$ : int [1:12] 61 62 63 64 65 66 67 68 69 70 ...
  .. ..$ : int [1:12] 73 74 75 76 77 78 79 80 81 82 ...
  .. ..$ : int [1:12] 85 86 87 88 89 90 91 92 93 94 ...
  .. ..$ : int [1:12] 97 98 99 100 101 102 103 104 105 106 ...
  .. ..$ : int [1:12] 109 110 111 112 113 114 115 116 117 118 ...
  .. ..$ : int [1:12] 121 122 123 124 125 126 127 128 129 130 ...
  .. ..$ : int [1:12] 133 134 135 136 137 138 139 140 141 142 ...
  .. ..$ : int [1:12] 145 146 147 148 149 150 151 152 153 154 ...
  .. ..$ : int [1:12] 157 158 159 160 161 162 163 164 165 166 ...
  .. ..$ : int [1:12] 169 170 171 172 173 174 175 176 177 178 ...
  .. ..$ : int [1:12] 181 182 183 184 185 186 187 188 189 190 ...
  .. ..$ : int [1:12] 193 194 195 196 197 198 199 200 201 202 ...
  .. ..$ : int [1:12] 205 206 207 208 209 210 211 212 213 214 ...
  .. ..$ : int [1:12] 217 218 219 220 221 222 223 224 225 226 ...
  .. ..$ : int [1:12] 229 230 231 232 233 234 235 236 237 238 ...
  .. ..$ : int [1:12] 241 242 243 244 245 246 247 248 249 250 ...
  .. ..$ : int [1:12] 253 254 255 256 257 258 259 260 261 262 ...
  .. ..$ : int [1:12] 265 266 267 268 269 270 271 272 273 274 ...
  .. ..$ : int [1:12] 277 278 279 280 281 282 283 284 285 286 ...
  .. ..$ : int [1:12] 289 290 291 292 293 294 295 296 297 298 ...
  .. ..$ : int [1:12] 301 302 303 304 305 306 307 308 309 310 ...
  .. ..$ : int [1:12] 313 314 315 316 317 318 319 320 321 322 ...
  .. ..$ : int [1:12] 325 326 327 328 329 330 331 332 333 334 ...
  .. ..$ : int [1:12] 337 338 339 340 341 342 343 344 345 346 ...
  .. ..$ : int [1:12] 349 350 351 352 353 354 355 356 357 358 ...
  .. ..$ : int [1:12] 361 362 363 364 365 366 367 368 369 370 ...
  .. ..$ : int [1:12] 373 374 375 376 377 378 379 380 381 382 ...
  .. ..$ : int [1:12] 385 386 387 388 389 390 391 392 393 394 ...
  .. ..$ : int [1:12] 397 398 399 400 401 402 403 404 405 406 ...
  .. ..$ : int [1:12] 409 410 411 412 413 414 415 416 417 418 ...
  .. ..$ : int [1:12] 421 422 423 424 425 426 427 428 429 430 ...
  .. ..$ : int [1:12] 433 434 435 436 437 438 439 440 441 442 ...
  .. ..$ : int [1:12] 445 446 447 448 449 450 451 452 453 454 ...
  .. ..$ : int [1:12] 457 458 459 460 461 462 463 464 465 466 ...
  .. ..$ : int [1:12] 469 470 471 472 473 474 475 476 477 478 ...
  .. ..$ : int [1:12] 481 482 483 484 485 486 487 488 489 490 ...
  .. ..$ : int [1:12] 493 494 495 496 497 498 499 500 501 502 ...
  .. ..$ : int [1:12] 505 506 507 508 509 510 511 512 513 514 ...
  .. ..$ : int [1:12] 517 518 519 520 521 522 523 524 525 526 ...
  .. ..$ : int [1:12] 529 530 531 532 533 534 535 536 537 538 ...
  .. ..$ : int [1:12] 541 542 543 544 545 546 547 548 549 550 ...
  .. ..$ : int [1:12] 553 554 555 556 557 558 559 560 561 562 ...
  .. ..$ : int [1:12] 565 566 567 568 569 570 571 572 573 574 ...
  .. ..$ : int [1:12] 577 578 579 580 581 582 583 584 585 586 ...
  .. ..$ : int [1:12] 589 590 591 592 593 594 595 596 597 598 ...
  .. ..$ : int [1:12] 601 602 603 604 605 606 607 608 609 610 ...
  .. ..$ : int [1:12] 613 614 615 616 617 618 619 620 621 622 ...
  .. ..$ : int [1:12] 625 626 627 628 629 630 631 632 633 634 ...
  .. ..$ : int [1:12] 637 638 639 640 641 642 643 644 645 646 ...
  .. ..$ : int [1:12] 649 650 651 652 653 654 655 656 657 658 ...
  .. ..$ : int [1:12] 661 662 663 664 665 666 667 668 669 670 ...
  .. ..$ : int [1:12] 673 674 675 676 677 678 679 680 681 682 ...
  .. ..$ : int [1:12] 685 686 687 688 689 690 691 692 693 694 ...
  .. ..$ : int [1:12] 697 698 699 700 701 702 703 704 705 706 ...
  .. ..$ : int [1:12] 709 710 711 712 713 714 715 716 717 718 ...
  .. ..$ : int [1:12] 721 722 723 724 725 726 727 728 729 730 ...
  .. ..$ : int [1:12] 733 734 735 736 737 738 739 740 741 742 ...
  .. ..$ : int [1:12] 745 746 747 748 749 750 751 752 753 754 ...
  .. ..$ : int [1:12] 757 758 759 760 761 762 763 764 765 766 ...
  .. ..$ : int [1:12] 769 770 771 772 773 774 775 776 777 778 ...
  .. ..$ : int [1:12] 781 782 783 784 785 786 787 788 789 790 ...
  .. ..$ : int [1:12] 793 794 795 796 797 798 799 800 801 802 ...
  .. ..$ : int [1:12] 805 806 807 808 809 810 811 812 813 814 ...
  .. ..$ : int [1:12] 817 818 819 820 821 822 823 824 825 826 ...
  .. ..$ : int [1:12] 829 830 831 832 833 834 835 836 837 838 ...
  .. ..$ : int [1:12] 841 842 843 844 845 846 847 848 849 850 ...
  .. ..$ : int [1:12] 853 854 855 856 857 858 859 860 861 862 ...
  .. ..$ : int [1:12] 865 866 867 868 869 870 871 872 873 874 ...
  .. ..$ : int [1:12] 877 878 879 880 881 882 883 884 885 886 ...
  .. ..$ : int [1:12] 889 890 891 892 893 894 895 896 897 898 ...
  .. ..$ : int [1:12] 901 902 903 904 905 906 907 908 909 910 ...
  .. ..$ : int [1:12] 913 914 915 916 917 918 919 920 921 922 ...
  .. ..$ : int [1:12] 925 926 927 928 929 930 931 932 933 934 ...
  .. ..$ : int [1:12] 937 938 939 940 941 942 943 944 945 946 ...
  .. ..$ : int [1:12] 949 950 951 952 953 954 955 956 957 958 ...
  .. ..$ : int [1:12] 961 962 963 964 965 966 967 968 969 970 ...
  .. ..$ : int [1:12] 973 974 975 976 977 978 979 980 981 982 ...
  .. ..$ : int [1:12] 985 986 987 988 989 990 991 992 993 994 ...
  .. ..$ : int [1:12] 997 998 999 1000 1001 1002 1003 1004 1005 1006 ...
  .. ..$ : int [1:12] 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018 ...
  .. ..$ : int [1:12] 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 ...
  .. ..$ : int [1:12] 1033 1034 1035 1036 1037 1038 1039 1040 1041 1042 ...
  .. ..$ : int [1:12] 1045 1046 1047 1048 1049 1050 1051 1052 1053 1054 ...
  .. ..$ : int [1:12] 1057 1058 1059 1060 1061 1062 1063 1064 1065 1066 ...
  .. ..$ : int [1:12] 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 ...
  .. ..$ : int [1:12] 1081 1082 1083 1084 1085 1086 1087 1088 1089 1090 ...
  .. ..$ : int [1:12] 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102 ...
  .. ..$ : int [1:12] 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 ...
  .. ..$ : int [1:12] 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 ...
  .. ..$ : int [1:12] 1129 1130 1131 1132 1133 1134 1135 1136 1137 1138 ...
  .. ..$ : int [1:12] 1141 1142 1143 1144 1145 1146 1147 1148 1149 1150 ...
  .. ..$ : int [1:12] 1153 1154 1155 1156 1157 1158 1159 1160 1161 1162 ...
  .. ..$ : int [1:12] 1165 1166 1167 1168 1169 1170 1171 1172 1173 1174 ...
  .. ..$ : int [1:12] 1177 1178 1179 1180 1181 1182 1183 1184 1185 1186 ...
  .. .. [list output truncated]
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
<p>If we look towards the bottom of the output above, we’ll see that,
for every unique value in the <code>country</code> column, there is now
a list of all the <em>row numbers</em> of rows sharing that same country
value (i.e., all the rows for <code>"Afghanistan"</code>, all the rows
for <code>"Albania"</code>, etc.). In other words, R now knows that each
row belongs to one specific group within the larger data set. So, when
we then ask it to calculate a summary of our data set, it can do so for
each group separately.</p>
<p>Let’s see how that works by next examining <code>summarize()</code>.
Each input past the first given to <code>summarize()</code> is an
“instructions list” for how to generate a summary, with these
“instructions lists” once again taking <em>new = old format</em> (see, I
said these tools were designed to be consistent!).</p>
<p>For example, let’s tell <code>summarize()</code> to calculate a mean
life expectancy for every country and to call the new column holding
those means <code>mean_lifeExp</code>:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_summarized</span> <span class="op">=</span> <span class="va">gap_grouped</span> <span class="op">%&gt;%</span>  <span class="co">#Make sure you put our grouped data set here!</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_lifeExp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="co">#new = old format.</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_summarized</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 2
  country     mean_lifeExp
  &lt;chr&gt;              &lt;dbl&gt;
1 Afghanistan         37.5
2 Albania             68.4
3 Algeria             59.0
4 Angola              37.9
5 Argentina           69.1
6 Australia           74.7</code></pre>
</div>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p>Consider: How many rows does <code>gap_summarized</code> now have?
Why does it have so many fewer rows than <code>gap_grouped</code> did?
And where did all the other columns go?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p><code>gap_summarized</code> only has 142 rows, whereas
<code>gap_grouped</code> had 1704. The reason for this is that we
summarized our data <em>by group</em>; we asked R to give us a
<strong>single value</strong> for each group in our data set. There are
only 142 countries in the gapminder data set, so we end up with a single
row for each country when we summarize.</p>
<p>But where did all the other columns go? Well, we didn’t ask for
summaries of those other columns. So, if there used to be 12 values of
<code>pop</code> for a given country before summarization, but there’s
going to be just a single row for a given country after summarization,
and we don’t tell R how exactly to “collapse” those 12 values down to
just one, it’s more “responsible” for R to just drop those columns
entirely rather than to guess how it should do that collapsing,
right?</p>
</div>
</div>
</div>
</div>
<p>If you want multiple summaries, you can simply provide multiple
inputs to <code>summarize()</code>. For example, <code>n()</code> is a
handy function for counting up the number of data points in each group
prior to any summarizations occurring:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_summarized</span> <span class="op">=</span> <span class="va">gap_grouped</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_lifeExp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span>,</span>
<span>            sample_sizes <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_summarized</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  country     mean_lifeExp sample_sizes
  &lt;chr&gt;              &lt;dbl&gt;        &lt;int&gt;
1 Afghanistan         37.5           12
2 Albania             68.4           12
3 Algeria             59.0           12
4 Angola              37.9           12
5 Argentina           69.1           12
6 Australia           74.7           12</code></pre>
</div>
<p>Here, all the values in our new column are <code>12</code> because we
have exactly 12 records per country to start with, but if the number of
records differed between countries, the above operation would have shown
us that.</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge6"></a>
</h3>
<div class="callout-content">
<p>One more concept: I said earlier that you can provide multiple inputs
to <code>group_by()</code>. What happens when we do that? Let’s try
it:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_2xgrouped</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">continent</span>, <span class="va">year</span><span class="op">)</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">gap_2xgrouped</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>gropd_df [1,704 × 6] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ country  : chr [1:1704] "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...
 $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ pop      : num [1:1704] 8425333 9240934 10267083 11537966 13079460 ...
 $ continent: chr [1:1704] "Asia" "Asia" "Asia" "Asia" ...
 $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
 $ gdpPercap: num [1:1704] 779 821 853 836 740 ...
 - attr(*, "groups")= tibble [60 × 3] (S3: tbl_df/tbl/data.frame)
  ..$ continent: chr [1:60] "Africa" "Africa" "Africa" "Africa" ...
  ..$ year     : int [1:60] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
  ..$ .rows    : list&lt;int&gt; [1:60] 
  .. ..$ : int [1:52] 25 37 121 157 193 205 229 253 265 313 ...
  .. ..$ : int [1:52] 26 38 122 158 194 206 230 254 266 314 ...
  .. ..$ : int [1:52] 27 39 123 159 195 207 231 255 267 315 ...
  .. ..$ : int [1:52] 28 40 124 160 196 208 232 256 268 316 ...
  .. ..$ : int [1:52] 29 41 125 161 197 209 233 257 269 317 ...
  .. ..$ : int [1:52] 30 42 126 162 198 210 234 258 270 318 ...
  .. ..$ : int [1:52] 31 43 127 163 199 211 235 259 271 319 ...
  .. ..$ : int [1:52] 32 44 128 164 200 212 236 260 272 320 ...
  .. ..$ : int [1:52] 33 45 129 165 201 213 237 261 273 321 ...
  .. ..$ : int [1:52] 34 46 130 166 202 214 238 262 274 322 ...
  .. ..$ : int [1:52] 35 47 131 167 203 215 239 263 275 323 ...
  .. ..$ : int [1:52] 36 48 132 168 204 216 240 264 276 324 ...
  .. ..$ : int [1:25] 49 133 169 241 277 301 349 385 433 445 ...
  .. ..$ : int [1:25] 50 134 170 242 278 302 350 386 434 446 ...
  .. ..$ : int [1:25] 51 135 171 243 279 303 351 387 435 447 ...
  .. ..$ : int [1:25] 52 136 172 244 280 304 352 388 436 448 ...
  .. ..$ : int [1:25] 53 137 173 245 281 305 353 389 437 449 ...
  .. ..$ : int [1:25] 54 138 174 246 282 306 354 390 438 450 ...
  .. ..$ : int [1:25] 55 139 175 247 283 307 355 391 439 451 ...
  .. ..$ : int [1:25] 56 140 176 248 284 308 356 392 440 452 ...
  .. ..$ : int [1:25] 57 141 177 249 285 309 357 393 441 453 ...
  .. ..$ : int [1:25] 58 142 178 250 286 310 358 394 442 454 ...
  .. ..$ : int [1:25] 59 143 179 251 287 311 359 395 443 455 ...
  .. ..$ : int [1:25] 60 144 180 252 288 312 360 396 444 456 ...
  .. ..$ : int [1:33] 1 85 97 217 289 661 697 709 721 733 ...
  .. ..$ : int [1:33] 2 86 98 218 290 662 698 710 722 734 ...
  .. ..$ : int [1:33] 3 87 99 219 291 663 699 711 723 735 ...
  .. ..$ : int [1:33] 4 88 100 220 292 664 700 712 724 736 ...
  .. ..$ : int [1:33] 5 89 101 221 293 665 701 713 725 737 ...
  .. ..$ : int [1:33] 6 90 102 222 294 666 702 714 726 738 ...
  .. ..$ : int [1:33] 7 91 103 223 295 667 703 715 727 739 ...
  .. ..$ : int [1:33] 8 92 104 224 296 668 704 716 728 740 ...
  .. ..$ : int [1:33] 9 93 105 225 297 669 705 717 729 741 ...
  .. ..$ : int [1:33] 10 94 106 226 298 670 706 718 730 742 ...
  .. ..$ : int [1:33] 11 95 107 227 299 671 707 719 731 743 ...
  .. ..$ : int [1:33] 12 96 108 228 300 672 708 720 732 744 ...
  .. ..$ : int [1:30] 13 73 109 145 181 373 397 409 517 529 ...
  .. ..$ : int [1:30] 14 74 110 146 182 374 398 410 518 530 ...
  .. ..$ : int [1:30] 15 75 111 147 183 375 399 411 519 531 ...
  .. ..$ : int [1:30] 16 76 112 148 184 376 400 412 520 532 ...
  .. ..$ : int [1:30] 17 77 113 149 185 377 401 413 521 533 ...
  .. ..$ : int [1:30] 18 78 114 150 186 378 402 414 522 534 ...
  .. ..$ : int [1:30] 19 79 115 151 187 379 403 415 523 535 ...
  .. ..$ : int [1:30] 20 80 116 152 188 380 404 416 524 536 ...
  .. ..$ : int [1:30] 21 81 117 153 189 381 405 417 525 537 ...
  .. ..$ : int [1:30] 22 82 118 154 190 382 406 418 526 538 ...
  .. ..$ : int [1:30] 23 83 119 155 191 383 407 419 527 539 ...
  .. ..$ : int [1:30] 24 84 120 156 192 384 408 420 528 540 ...
  .. ..$ : int [1:2] 61 1093
  .. ..$ : int [1:2] 62 1094
  .. ..$ : int [1:2] 63 1095
  .. ..$ : int [1:2] 64 1096
  .. ..$ : int [1:2] 65 1097
  .. ..$ : int [1:2] 66 1098
  .. ..$ : int [1:2] 67 1099
  .. ..$ : int [1:2] 68 1100
  .. ..$ : int [1:2] 69 1101
  .. ..$ : int [1:2] 70 1102
  .. ..$ : int [1:2] 71 1103
  .. ..$ : int [1:2] 72 1104
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
<p>How did R group together rows in this case?</p>
<p>Next, try generating mean life expectancies and sample sizes using
<code>gap_2xgrouped</code> as an input. You’ll get different values than
we did before when using <code>gap_grouped</code>, and we’ll also get a
different number of rows in the resulting output. Why?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Show me the solution</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>Here’s how we’d generate those summaries:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_2xsummarized</span> <span class="op">=</span> <span class="va">gap_2xgrouped</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_lifeExp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span>,</span>
<span>            sample_sizes <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_2xsummarized</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 4
# Groups:   continent [1]
  continent  year mean_lifeExp sample_sizes
  &lt;chr&gt;     &lt;int&gt;        &lt;dbl&gt;        &lt;int&gt;
1 Africa     1952         39.1           52
2 Africa     1957         41.3           52
3 Africa     1962         43.3           52
4 Africa     1967         45.3           52
5 Africa     1972         47.5           52
6 Africa     1977         49.6           52</code></pre>
</div>
<p>By specifying multiple columns to group by, what R did is find the
rows belonging to each unique <em>combo</em> of the unique values in
each column. That is, here, it found the rows that belong to each unique
<code>continent</code> x <code>year</code> combo.</p>
<p>So, when we summarize, we’re calculating summaries <em>across</em>
different countries that belong to each unique <code>continent</code>
for each unique <code>year</code>. Because there are differing numbers
of countries in each <code>continent</code>, our sample sizes now differ
between the continents–examine the final data frame and confirm
that!</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use the <code>dplyr</code> package to manipulate data frames in
efficient, clear, and intuitive ways.</li>
<li>Use <code>select()</code> to retain specific variables when creating
a new, smaller data frame.</li>
<li>Use <code>filter()</code> to subset data based on values in one or
more columns.</li>
<li>Use <code>group_by()</code> and <code>summarize()</code> to generate
summaries of data by groups.</li>
<li>Use <code>mutate()</code> to create new variables using old
ones.</li>
<li>Use <code>rename()</code> to rename columns and
<code>arrange()</code> to sort your data set by one or more
columns.</li>
<li>Use pipes (<code>%&gt;%</code>) to string <code>dplyr</code> verbs
together into “sentences.”</li>
<li>Remember that order matters when stringing together
<code>dplyr</code> verbs!</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-14b-tidyr"><p>Content from <a href="14b-tidyr.html">Pivoting using tidyr</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/14b-tidyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>
<em>How</em> am I storing data in my data sets?</li>
<li>How does R tend to expect me to store my data?</li>
<li>How can I convert (or <em>pivot</em>) my data from one form to
another?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Distinguish between “long” and “wide” formats (and “in-between”
formats) for storing data in a table.</li>
<li>Recognize and explain the benefits and drawbacks of storing data in
each format.</li>
<li>Use the <code>pivot</code> functions in the <code>tidyr</code>
package to convert data from one format to another.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p><strong>Important</strong>: There is no one universal, “right” way to
store data in a table! There are many advantages and disadvantages to
each way and, in some ways, so long as your organizational system
follows good data science storage conventions, is consistent, and works
for you and your team, then you’re probably doing it “right.”</p>
<p>That said, from a <em>computing</em> standpoint, there are two broad
ways to think about how data are stored in a table–in “wide” format or
in “long” format:</p>
<figure><img src="https://www.statology.org/wp-content/uploads/2021/12/wideLong1-1.png" alt="When data are in a wide format (left-hand side above), groups within the data (such as teams) have their own rows, and everything we know about each group (such as stats) is listed in different columns in that group’s row. When data are in long format (right-hand side above), each individual row belongs to a single observation, i.e one datum (such as one particular record of one statistic) and columns instead hold information about what groups each statistic belongs to. Same data, different organizations!" class="figure mx-auto d-block"><div class="figcaption">When data are in a wide format (left-hand side
above), <em>groups</em> within the data (such as teams) have their own
rows, and everything we know about each group (such as stats) is listed
in different columns in that group’s row. When data are in long format
(right-hand side above), each individual row belongs to a <em>single
observation</em>, i.e one datum (such as one particular record of one
statistic) and columns instead hold information about what groups each
statistic belongs to. Same data, different organizations!</div>
</figure><p>In “wide” format, each row is usually a grouping, site, individual,
etc. for which multiple observations are recorded, and each column is
everything you know about that entity, perhaps at several different time
points.</p>
<p>In “long” format, each row is a single observation (even if you have
several observations per entity), and the columns serve to clarify which
entity each observations belongs to.</p>
<p>Notice that, regardless, the <em>exact same information</em> is being
stored in the table–it’s just <em>arrayed</em> differently!</p>
<p>This is actually a spectrum–data can be organized in a <em>super</em>
long format, a <em>super</em> wide format, or somewhere in between (if
the data set has enough complexity to allow it)!</p>
<p>Also, when I say “long” and “wide,” I don’t mean in the
<em>physical</em> sense of how much data you’re storing. Obviously, if
you have a lot of data, you’re going to have a lot of rows and/or
columns potentially, so your data set might <em>look</em> “long” even
though it’s <em>organized</em> in a “wide” format.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p><strong>Important</strong>: One consequence of data organization is
that it influences the ease (or difficulty!) of using a programming
language like R to manipulate your data.</p>
<p>Consider: How would you use <code>dplyr</code>’s
<code>mutate()</code> function to calculate a “points per rebound” value
for each team using the “wide” format data set shown above? How about
for the “long” format data set?</p>
<p>Then, consider: How would you use <code>dplyr</code>’s
<code>summarize()</code> function to get an average number of assists
across all teams using the “wide” format data set shown above? How about
the “long” format data set?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>With the data in “wide” format, using <code>mutate()</code> to
calculate “points per rebound” for each team would be easy because the
two values for each team (<code>Points</code> and <code>Rebounds</code>)
are in the same row. So, we’d do something like this:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>pts_per_rebound <span class="op">=</span> <span class="va">Points</span><span class="op">/</span><span class="va">Rebounds</span><span class="op">)</span></span></code></pre>
</div>
<p>However, with the data in “long” format, it’s not at all obvious how
(or even if) one could use <code>mutate()</code> to get what we want.
The numbers we’re trying to slam together are in different rows now.
This demonstrates that, in some ways, <code>mutate()</code> is a
“rowwise” tool–its designed for operations that leverage data stored
more “widely.”</p>
<p>Similarly, with the data in “wide” format, using
<code>summarize()</code> to calculate an average number of
<code>Assists</code> across all teams would be easy because all the
numbers we’re trying to smash together are in the same column. So, we’d
do something like this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_assists <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">Assists</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Yes, you can use <code>summarize()</code> without using
<code>group_by()</code> if you have no groups to group by!</p>
<p>However, once again, the “long” format version presents
difficulties–there are numbers in the <code>Value</code> column we’d
need to avoid here to calculate our average. So, it’d require us to use
<code>filter()</code> first to remove these:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Variable</span> <span class="op">==</span> <span class="va">Assists</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co">#Notice I have to filter by the Variable column...</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_assists <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="co">#...But take the mean of the Value column.</span></span></code></pre>
</div>
<p>So, <code>summarize()</code> <em>seems</em> like a tool also designed
for “wide” format data, but that’s only because our wide-format data
have <em>already</em> been grouped by team. In fact,
<code>group_by()</code> and <code>summarize()</code> are best thought of
as tools designed to work best with “long” format data because we need
to be able to easily sub-divide our data into groups to then be able to
summarize effectively and long formats have more columns for “grouping
variables.”</p>
<p>This whole exercise is designed to show that while, to <em>some</em>
extent, data organization is “personal preference,” it also has
implications for how we manipulate our data (and how easy or hard it
will be to do so).</p>
</div>
</div>
</div>
</div>
<p>While this is perhaps over-generalizing, I would say that
<strong>humans tend to prefer reading and recording data in “wider”
formats</strong>. Notice that, when we report data in tables or record
data on data sheets, we tend to do so across rows rather than down
columns. Recording data in long format, in particular, tends to feel
tedious because it requires us to fill out “grouping variable” columns
many times with the same information.</p>
<p>However, <strong>computers tend to be designed to “prefer”
manipulating data in “longer” formats</strong> (regardless of what the
previous example may have led you to believe!). Computers don’t “see”
natural groupings in data like humans can, so they count on having
columns that clarify these groups (like <code>continent</code> and
<code>country</code> do in the gapminder dataset), and those types of
columns only exist in “longer” formats. In particular, many
<code>dplyr</code> operations will actually be easier if your data are
in “long” format, and <code>ggplot2</code> <em>especially</em> expects
“long” format to render plots with various groups correctly.</p>
<p>This may seem like a dilemma–we’re torn between how <em>we’d</em>
prefer the data to look and how <em>R</em> would prefer them to look.
But, remember, it’s all the same data, just arranged differently. So, it
seems like it’d be possible to “reshape” our data to suit both needs.
That’s, in part, what the <code>tidyr</code> package’s functions
<code>pivot_longer()</code> and <code>pivot_wider()</code> are for.</p>
</section><section id="preparation-and-setup"><h2 class="section-heading">Preparation and setup<a class="anchor" aria-label="anchor" href="#preparation-and-setup"></a>
</h2>
<hr class="half-width">
<p>Note: This lesson uses the <strong>gapminder data set</strong>. This
data set can be downloaded <a href="https://drive.google.com/file/d/1sBkIJlC_6fImNZhyV0XfsllyUD-hSmoS/view?usp=sharing" class="external-link">here</a>.
Make sure to load the data set into your global environment before
continuing.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap</span> <span class="op">=</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/gapminder_data.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>Also, this lesson will revolve around use of the optional “add-on”
package <code>tidyr</code>. <code>tidyr</code> is a package in the
“tidyverse”–an array of useful tools that are designed to look similar
and work well together and that make R much more powerful to use but
also a lot different than “Base R.” Everything we do in this lesson can
be done in “Base R” instead, but it won’t (typically) be as efficient,
easy, or clear!</p>
<p><code>tidyr</code>, like many add-on packages, is
<strong>not</strong> installed with R. So, we must install it before we
can use it:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span> <span class="co">#Only run once!</span></span></code></pre>
</div>
<p>You only need to install a package once, so there’s no need to run
the above command more than once. However, packages are updated
occasionally. When updates are available, you can re-install new
versions using the same <code>install.packages()</code> function.</p>
<p>Once a package is installed, it still isn’t “turned on” by default.
So, to turn on <code>tidyr</code> so that we can access its unique
features, we use the <code>library()</code> function:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span></code></pre>
</div>
<p>The above command must be run every time you start up a new session
of R and want access to <code>tidyr</code>’s features!</p>
<p>We’ll also need the <code>dplyr</code> package here so that we can
use pipes. See the <code>dplyr</code> lesson for details!</p>
</section><section id="minding-the-gapminder"><h2 class="section-heading">Minding the Gapminder<a class="anchor" aria-label="anchor" href="#minding-the-gapminder"></a>
</h2>
<hr class="half-width">
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>Let’s look at the gapminder data set once more to remind ourselves of
its structure and contents:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">gap</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      country year      pop continent lifeExp gdpPercap
1 Afghanistan 1952  8425333      Asia  28.801  779.4453
2 Afghanistan 1957  9240934      Asia  30.332  820.8530
3 Afghanistan 1962 10267083      Asia  31.997  853.1007
4 Afghanistan 1967 11537966      Asia  34.020  836.1971
5 Afghanistan 1972 13079460      Asia  36.088  739.9811
6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</div>
<p>Consider: Is the gapminder data set in “long” format or “wide”
format? Why do you say that?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Sorry, this is <em>sort of</em> a trick question because the right
answer is “both” (or “neither”).</p>
<p>On the one hand, the gapminder data set is not <em>as</em> long as it
<em>could</em> be. For example, right now, there are three columns
containing numeric data (<code>pop</code>, <code>lifeExp</code>, and
<code>gdpPercap</code>). We <em>could</em> instead have a single
<code>Value</code> column to hold these data, as we had with our fake
sports data earlier, and a second column that lists what kind of
<code>Value</code> each row represents.</p>
<p>On the other hand, the gapminder data set is also not <em>as</em>
wide as it <em>could</em> be either. For example, right now, there are
three “grouping variables” (<code>country</code>, <code>year</code>, and
<code>continent</code>). We <em>could</em> instead have a single row per
<code>country</code> and have separate columns for the data from each
year (i.e., <code>pop1952</code>, <code>pop1957</code>,
<code>pop1962</code>, etc.).</p>
<p>So, “data orientation” is a spectrum, and the gapminder data set
exists sort of in the middle of it! Hold onto this idea–in the rest of
this lesson, we’re going to see how to <strong>make</strong> those
longer and wider versions we just imagined!</p>
</div>
</div>
</div>
</div>
</section><section id="pivot_longer"><h2 class="section-heading">PIVOT_LONGER<a class="anchor" aria-label="anchor" href="#pivot_longer"></a>
</h2>
<hr class="half-width">
<p>We’ll begin by seeing how to make our data even longer than it is now
by combining all the values in the <code>pop</code>,
<code>lifeExp</code>, and <code>gdpPercap</code> columns into a single
column called <code>Value</code>. We’ll then add a second column
(officially called a “key” column) that clarifies which
<code>Statistic</code> is being reported in the <code>Value</code>
column in that row.</p>
<p>The <code>tidyr</code> verb that corresponds with this goal is
<code>pivot_longer()</code>. As with most <code>dplyr</code> verbs (and
<code>tidyverse</code> verbs in general!), the first input to
<code>pivot_longer()</code> is <strong>always</strong> the data frame
you are trying to reshape (or “pivot”). In this case, that will be our
gapminder data set.</p>
<p>After providing our data set, we will provide three more inputs in
this particular case:</p>
<ol style="list-style-type: decimal">
<li><p>The columns we are eliminating and collapsing into a single
column. Here, that will be <code>pop</code>, <code>lifeExp</code>, and
<code>gdpPercap</code>. We’ll provide these inputs to the
<code>cols</code> <em>parameter</em>.</p></li>
<li><p>The name of the new column that will hold all the <em>values</em>
that <em>used</em> to be held by the columns we’re eliminating. So, our
population, life expectancy, and GDP data in this case. We’ll call this
new column <code>Value</code>, and we’ll provide this input to the
<code>values_to</code> <em>parameter</em>.</p></li>
<li><p>The name of the new “key” column that will clarify which
statistic is being held in the <code>Value</code> column in a given row.
We’ll call this new column <code>Statistic</code>, and we’ll provide
this input to the <code>names_to</code> parameter.</p></li>
</ol>
<p>Let’s put all this together and see what it looks like!</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_longer</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> <span class="co">#Review the dplyr lesson if you forget how to use pipes!</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">pop</span>, <span class="va">lifeExp</span>, <span class="va">gdpPercap</span><span class="op">)</span>, <span class="co">#We have to use c() here to bundle the column names together because these three columns are not consecutive.</span></span>
<span>               values_to <span class="op">=</span> <span class="st">"Value"</span>, <span class="co">#Notice the quotation marks--these are essential here!</span></span>
<span>               names_to <span class="op">=</span> <span class="st">"Statistic"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_longer</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 5
  country      year continent Statistic     Value
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;
1 Afghanistan  1952 Asia      pop       8425333  
2 Afghanistan  1952 Asia      lifeExp        28.8
3 Afghanistan  1952 Asia      gdpPercap     779. 
4 Afghanistan  1957 Asia      pop       9240934  
5 Afghanistan  1957 Asia      lifeExp        30.3
6 Afghanistan  1957 Asia      gdpPercap     821. </code></pre>
</div>
<p>The first thing I want you to notice (by looking over in the
‘Environment Pane’) is that our new data set, <code>gap_longer</code> is
indeed much longer than before: it’s now up to <code>5112</code> rows!
It also has fewer columns: 5 instead of the 6 we started with.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>The other important thing to notice here is the contents of the
<code>Statistic</code> column. Where did R get this column’s contents
from?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>It used the names of the old columns, the ones we got rid of! It
figures if those names were good enough to serve as column names in the
original data, they must be good enough to be “keys” in this new
organization too!</p>
</div>
</div>
</div>
</div>
</section><section id="pivot_wider"><h2 class="section-heading">PIVOT_WIDER<a class="anchor" aria-label="anchor" href="#pivot_wider"></a>
</h2>
<hr class="half-width">
<p>Now, we’ll go the other way–we’ll make our gapminder data set wider
than it already is. We’ll make a data set that has a single row for each
<code>country</code> (countries will be our groups) and we’ll have a
different column for every <code>year</code> x “Statistic” combo we have
for each country.</p>
<p>The <code>tidyr</code> verb that corresponds with this goal is
<code>pivot_wider()</code>, and it works very similarly to
<code>pivot_longer()</code>. Besides our data frame (first input), we’ll
provide <code>pivot_wider()</code> two more inputs:</p>
<ol style="list-style-type: decimal">
<li>The column(s) that we’re going to eliminate by spreading their
contents out over several new columns. In our new, wider data set, we’re
going to have a column for each <code>year</code> x “Statistic”
combination, so we’re going to eliminate the current <code>pop</code>,
<code>lifeExp</code>, and <code>gdpPercap</code> columns as we know them
(though their names will get used to make the names for the new columns
we’re creating). We’ll provide them to the <code>values_from</code>
<em>parameter</em>.</li>
<li>The column that we’re going to eliminate by instead inserting it
into the names of the new columns we’re creating. Here, that’s going to
be the <code>year</code> column (I promise this’ll make more sense when
you see it!). We’ll provide this to the <code>names_from</code>
<em>parameter</em>.</li>
</ol>
<p>Let’s see what this looks like!</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_wider</span> <span class="op">=</span> <span class="va">gap</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>values_from <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">pop</span>, <span class="va">lifeExp</span>, <span class="va">gdpPercap</span><span class="op">)</span>,</span>
<span>              names_from <span class="op">=</span> <span class="va">year</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_wider</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 38
  country     continent pop_1952 pop_1957 pop_1962 pop_1967 pop_1972 pop_1977
  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Afghanistan Asia       8425333  9240934 10267083 11537966 13079460 14880372
2 Albania     Europe     1282697  1476505  1728137  1984060  2263554  2509048
3 Algeria     Africa     9279525 10270856 11000948 12760499 14760787 17152804
4 Angola      Africa     4232095  4561361  4826015  5247469  5894858  6162675
5 Argentina   Americas  17876956 19610538 21283783 22934225 24779799 26983828
6 Australia   Oceania    8691212  9712569 10794968 11872264 13177000 14074100
# ℹ 30 more variables: pop_1982 &lt;dbl&gt;, pop_1987 &lt;dbl&gt;, pop_1992 &lt;dbl&gt;,
#   pop_1997 &lt;dbl&gt;, pop_2002 &lt;dbl&gt;, pop_2007 &lt;dbl&gt;, lifeExp_1952 &lt;dbl&gt;,
#   lifeExp_1957 &lt;dbl&gt;, lifeExp_1962 &lt;dbl&gt;, lifeExp_1967 &lt;dbl&gt;,
#   lifeExp_1972 &lt;dbl&gt;, lifeExp_1977 &lt;dbl&gt;, lifeExp_1982 &lt;dbl&gt;,
#   lifeExp_1987 &lt;dbl&gt;, lifeExp_1992 &lt;dbl&gt;, lifeExp_1997 &lt;dbl&gt;,
#   lifeExp_2002 &lt;dbl&gt;, lifeExp_2007 &lt;dbl&gt;, gdpPercap_1952 &lt;dbl&gt;,
#   gdpPercap_1957 &lt;dbl&gt;, gdpPercap_1962 &lt;dbl&gt;, gdpPercap_1967 &lt;dbl&gt;, …</code></pre>
</div>
<p>As the name correctly suggests, <code>gap_wider</code> is indeed much
wider than our original gapminder data set: It has 38 columns instead of
the original 6. We also have fewer rows: Just 142 (1 per
<code>country</code>) compared to the original 1704.</p>
<p>Importantly, our new columns have intuitive, predictable names:
<code>gdpPercap_1972</code>, <code>pop_1992</code>, and
<code>lifeExp1987</code>, for example. Hopefully this is making more
sense now that you’ve seen it in action!</p>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>You’ve now seen <code>pivot_longer()</code> and
<code>pivot_wider()</code>. Maybe you’ve noticed that they seem like
“opposites?” They are! <em>They’re designed to “undo” the other’s
work</em>, in fact!</p>
<p>So, use <code>pivot_wider()</code> to “rewind”
<code>gap_longer</code> back to the organization of our original data
set.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>This task is thankfully <em>relatively</em> easy. We tell R that it
should pull the names for the new columns in our wider table from the
<code>Statistic</code> column, then pull the values for those new
columns from the old <code>Value</code> column:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_returned1</span> <span class="op">=</span> <span class="va">gap_longer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Statistic</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">Value</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_returned1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 6
  country      year continent      pop lifeExp gdpPercap
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan  1952 Asia       8425333    28.8      779.
2 Afghanistan  1957 Asia       9240934    30.3      821.
3 Afghanistan  1962 Asia      10267083    32.0      853.
4 Afghanistan  1967 Asia      11537966    34.0      836.
5 Afghanistan  1972 Asia      13079460    36.1      740.
6 Afghanistan  1977 Asia      14880372    38.4      786.</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p>Now, use <code>pivot_longer()</code> to “rewind”
<code>gap_wider</code> back to the organization of the original data
set. This transformation will be a <em>little</em> more complicated,
though; you’ll need to specify slightly different inputs:</p>
<ol style="list-style-type: decimal">
<li>For the <code>names_to</code> <em>parameter</em>, specify exactly
<code>c(".value", "year")</code>. <code>".value"</code> is a special
input value here that has a particular meaning–see if you can guess what
it is! You can use <code>?pivot_longer()</code> to research the answer,
if you’d like.</li>
<li>You’ll also need to specify <code>"_"</code> as an input for the
<code>names_sep</code> <em>parameter</em>. See if you can guess
why.</li>
<li>Lastly, you won’t be needing to specify anything for the
<code>values_to</code> parameter this time–<code>".value"</code> is
taking care of the need to put anything there.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>Here’s how we’d use <code>pivot_longer()</code> to “rewind” to our
original data set:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_returned2</span> <span class="op">=</span> <span class="va">gap_wider</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">pop_1952</span><span class="op">:</span><span class="va">gdpPercap_2007</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">gap_returned2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 6
  country     continent year       pop lifeExp gdpPercap
  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan Asia      1952   8425333    28.8      779.
2 Afghanistan Asia      1957   9240934    30.3      821.
3 Afghanistan Asia      1962  10267083    32.0      853.
4 Afghanistan Asia      1967  11537966    34.0      836.
5 Afghanistan Asia      1972  13079460    36.1      740.
6 Afghanistan Asia      1977  14880372    38.4      786.</code></pre>
</div>
<p>Our inputs for <code>names_to</code> were first telling R “the names
of the new columns should come from the <em>first</em> parts of the
names of the columns we’re getting rid of.” That was the
<code>".values"</code> bit!</p>
<p>Then, they were telling R “the other column you should make should
simply be called <code>year</code>.”</p>
<p>Lastly, by saying <code>names_sep = "_"</code>, we were indicating
that R should hack apart the old column names at the underscores (aka
<em>separate</em> the old names at the <code>_</code>) to find the
proper bits to use in the new column names.</p>
<p>So, R pulled apart the old column names, creating <code>pop</code>,
<code>lifeExp</code>, and <code>gdpPercap</code> columns from the front
halves and then years to fill the new <code>year</code> column from the
back halves of those old column names. Pretty incredible, huh??</p>
<p>Try to rephrase the above explanation in your own words.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use the <code>tidyr</code> package to reshape the organization of
your data.</li>
<li>Use <code>pivot_longer()</code> to go towards a “longer”
layout.</li>
<li>Use <code>pivot_wider()</code> to go towards a “wider” layout.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-15-knitr-markdown"><p>Content from <a href="15-knitr-markdown.html">Producing Reports With knitr</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/15-knitr-markdown.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I integrate software and reports?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the value of writing reproducible reports</li>
<li>Learn how to recognise and compile the basic components of an R
Markdown file</li>
<li>Become familiar with R code chunks, and understand their purpose,
structure and options</li>
<li>Demonstrate the use of inline chunks for weaving R outputs into text
blocks, for example when discussing the results of some
calculations</li>
<li>Be aware of alternative output formats to which an R Markdown file
can be exported</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="data-analysis-reports"><h2 class="section-heading">Data analysis reports<a class="anchor" aria-label="anchor" href="#data-analysis-reports"></a>
</h2>
<hr class="half-width">
<p>Data analysts tend to write a lot of reports, describing their
analyses and results, for their collaborators or to document their work
for future reference.</p>
<p>Many new users begin by first writing a single R script containing
all of their work, and then share the analysis by emailing the script
and various graphs as attachments. But this can be cumbersome, requiring
a lengthy discussion to explain which attachment was which result.</p>
<p>Writing formal reports with Word or <a href="https://www.latex-project.org/" class="external-link">LaTeX</a> can simplify this
process by incorporating both the analysis report and output graphs into
a single document. But tweaking formatting to make figures look correct
and fixing obnoxious page breaks can be tedious and lead to a lengthy
“whack-a-mole” game of fixing new mistakes resulting from a single
formatting change.</p>
<p>Creating a report as a web page (which is an html file) using R
Markdown makes things easier. The report can be one long stream, so tall
figures that wouldn’t ordinarily fit on one page can be kept at full
size and easier to read, since the reader can simply keep scrolling.
Additionally, the formatting of and R Markdown document is simple and
easy to modify, allowing you to spend more time on your analyses instead
of writing reports.</p>
</section><section id="literate-programming"><h2 class="section-heading">Literate programming<a class="anchor" aria-label="anchor" href="#literate-programming"></a>
</h2>
<hr class="half-width">
<p>Ideally, such analysis reports are <em>reproducible</em> documents:
If an error is discovered, or if some additional subjects are added to
the data, you can just re-compile the report and get the new or
corrected results rather than having to reconstruct figures, paste them
into a Word document, and hand-edit various detailed results.</p>
<p>The key R package here is <a href="https://yihui.name/knitr/" class="external-link"><code>knitr</code></a>. It allows you
to create a document that is a mixture of text and chunks of code. When
the document is processed by <code>knitr</code>, chunks of code will be
executed, and graphs or other results will be inserted into the final
document.</p>
<p>This sort of idea has been called “literate programming”.</p>
<p><code>knitr</code> allows you to mix basically any type of text with
code from different programming languages, but we recommend that you use
<code>R Markdown</code>, which mixes Markdown with R. <a href="https://www.markdownguide.org/" class="external-link">Markdown</a> is a light-weight
mark-up language for creating web pages.</p>
</section><section id="creating-an-r-markdown-file"><h2 class="section-heading">Creating an R Markdown file<a class="anchor" aria-label="anchor" href="#creating-an-r-markdown-file"></a>
</h2>
<hr class="half-width">
<p>Within RStudio, click File → New File → R Markdown and you’ll get a
dialog box like this:</p>
<figure><img src="fig/New_R_Markdown.png" alt="Screenshot of the New R Markdown file dialogue box in RStudio" class="figure mx-auto d-block"></figure><p>You can stick with the default (HTML output), but give it a
title.</p>
</section><section id="basic-components-of-r-markdown"><h2 class="section-heading">Basic components of R Markdown<a class="anchor" aria-label="anchor" href="#basic-components-of-r-markdown"></a>
</h2>
<hr class="half-width">
<p>The initial chunk of text (header) contains instructions for R to
specify what kind of document will be created, and the options chosen.
You can use the header to give your document a title, author, date, and
tell it what type of output you want to produce. In this case, we’re
creating an html document.</p>
<pre><code>---
title: "Initial R Markdown document"
author: "Karl Broman"
date: "April 23, 2015"
output: html_document
---</code></pre>
<p>You can delete any of those fields if you don’t want them included.
The double-quotes aren’t strictly <em>necessary</em> in this case.
They’re mostly needed if you want to include a colon in the title.</p>
<p>RStudio creates the document with some example text to get you
started. Note below that there are chunks like</p>
<pre>
```{r}
summary(cars)
```
</pre>
<p>These are chunks of R code that will be executed by
<code>knitr</code> and replaced by their results. More on this
later.</p>
</section><section id="markdown"><h2 class="section-heading">Markdown<a class="anchor" aria-label="anchor" href="#markdown"></a>
</h2>
<hr class="half-width">
<p>Markdown is a system for writing web pages by marking up the text
much as you would in an email rather than writing html code. The
marked-up text gets <em>converted</em> to html, replacing the marks with
the proper html code.</p>
<p>For now, let’s delete all of the stuff that’s there and write a bit
of markdown.</p>
<p>You make things <strong>bold</strong> using two asterisks, like this:
<code>**bold**</code>, and you make things <em>italics</em> by using
underscores, like this: <code>_italics_</code>.</p>
<p>You can make a bulleted list by writing a list with hyphens or
asterisks with a space between the list and other text, like this:</p>
<pre><code>A list:

* bold with double-asterisks
* italics with underscores
* code-type font with backticks</code></pre>
<p>or like this:</p>
<pre><code>A second list:

- bold with double-asterisks
- italics with underscores
- code-type font with backticks</code></pre>
<p>Each will appear as:</p>
<ul>
<li>bold with double-asterisks</li>
<li>italics with underscores</li>
<li>code-type font with backticks</li>
</ul>
<p>You can use whatever method you prefer, but <em>be consistent</em>.
This maintains the readability of your code.</p>
<p>You can make a numbered list by just using numbers. You can even use
the same number over and over if you want:</p>
<pre><code>1. bold with double-asterisks
1. italics with underscores
1. code-type font with backticks</code></pre>
<p>This will appear as:</p>
<ol style="list-style-type: decimal">
<li>bold with double-asterisks</li>
<li>italics with underscores</li>
<li>code-type font with backticks</li>
</ol>
<p>You can make section headers of different sizes by initiating a line
with some number of <code>#</code> symbols:</p>
<pre><code><span><span class="co"># Title</span></span>
<span><span class="co">## Main section</span></span>
<span><span class="co">### Sub-section</span></span>
<span><span class="co">#### Sub-sub section</span></span></code></pre>
<p>You <em>compile</em> the R Markdown document to an html webpage by
clicking the “Knit” button in the upper-left.</p>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<p>Create a new R Markdown document. Delete all of the R code chunks and
write a bit of Markdown (some sections, some italicized text, and an
itemized list).</p>
<p>Convert the document to a webpage.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Challenge 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>In RStudio, select File &gt; New file &gt; R Markdown…</p>
<p>Delete the placeholder text and add the following:</p>
<pre><code># Introduction

## Background on Data

This report uses the *gapminder* dataset, which has columns that include:

* country
* continent
* year
* lifeExp
* pop
* gdpPercap

## Background on Methods
</code></pre>
<p>Then click the ‘Knit’ button on the toolbar to generate an html
document (webpage).</p>
</div>
</div>
</div>
</div>
</section><section id="a-bit-more-markdown"><h2 class="section-heading">A bit more Markdown<a class="anchor" aria-label="anchor" href="#a-bit-more-markdown"></a>
</h2>
<hr class="half-width">
<p>You can make a hyperlink like this:
<code>[Carpentries Home Page](https://carpentries.org/)</code>.</p>
<p>You can include an image file like this:
<code>![The Carpentries Logo](https://carpentries.org/assets/img/TheCarpentries.svg)</code></p>
<p>You can do subscripts (e.g., F<sub>2</sub>) with <code>F~2~</code>
and superscripts (e.g., F<sup>2</sup>) with <code>F^2^</code>.</p>
<p>If you know how to write equations in <a href="https://www.latex-project.org/" class="external-link">LaTeX</a>, you can use
<code>$ $</code> and <code>$$ $$</code> to insert math equations, like
<code>$E = mc^2$</code> and</p>
<pre><code>$$y = \mu + \sum_{i=1}^p \beta_i x_i + \epsilon$$</code></pre>
<p>You can review Markdown syntax by navigating to the “Markdown Quick
Reference” under the “Help” field in the toolbar at the top of
RStudio.</p>
</section><section id="r-code-chunks"><h2 class="section-heading">R code chunks<a class="anchor" aria-label="anchor" href="#r-code-chunks"></a>
</h2>
<hr class="half-width">
<p>The real power of Markdown comes from mixing markdown with chunks of
code. This is R Markdown. When processed, the R code will be executed;
if they produce figures, the figures will be inserted in the final
document.</p>
<p>The main code chunks look like this:</p>
<pre>
```{r load_data}
gapminder 
<p>That is, you place a chunk of R code between <code>```{r
chunk_name}</code> and <code>```</code>. You should give each chunk a
unique name, as they will help you to fix errors and, if any graphs are
produced, the file names are based on the name of the code chunk that
produced them. You can create code chunks quickly in RStudio using the
shortcuts <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd> on Windows and
Linux, or <kbd>Cmd</kbd>+<kbd>Option</kbd>+<kbd>I</kbd> on Mac.</p>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<p>Add code chunks to:</p>
<ul>
<li>Load the ggplot2 package</li>
<li>Read the gapminder data</li>
<li>Create a plot</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Challenge 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<pre>
```{r load-ggplot2}
library("ggplot2")
```
</pre>
<pre>
```{r read-gapminder-data}
gapminder 
<pre>
```{r make-plot}
plot(lifeExp ~ year, data = gapminder)
```
</pre>
</pre>
</div>
</div>
</div>
</div>
</pre></section><section id="how-things-get-compiled"><h2 class="section-heading">How things get compiled<a class="anchor" aria-label="anchor" href="#how-things-get-compiled"></a>
</h2>
<hr class="half-width">
<p>When you press the “Knit” button, the R Markdown document is
processed by <a href="https://yihui.name/knitr" class="external-link"><code>knitr</code></a>
and a plain Markdown document is produced (as well as, potentially, a
set of figure files): the R code is executed and replaced by both the
input and the output; if figures are produced, links to those figures
are included.</p>
<p>The Markdown and figure documents are then processed by the tool <a href="https://pandoc.org/" class="external-link"><code>pandoc</code></a>, which converts the
Markdown file into an html file, with the figures embedded.</p>
<figure><img src="fig/15-knitr-markdown-rendered-rmd_to_html_fig-1.png" style="display: block; margin: auto auto auto 0;" class="figure mx-auto d-block"></figure></section><section id="chunk-options"><h2 class="section-heading">Chunk options<a class="anchor" aria-label="anchor" href="#chunk-options"></a>
</h2>
<hr class="half-width">
<p>There are a variety of options to affect how the code chunks are
treated. Here are some examples:</p>
<ul>
<li>Use <code>echo=FALSE</code> to avoid having the code itself
shown.</li>
<li>Use <code>results="hide"</code> to avoid having any results
printed.</li>
<li>Use <code>eval=FALSE</code> to have the code shown but not
evaluated.</li>
<li>Use <code>warning=FALSE</code> and <code>message=FALSE</code> to
hide any warnings or messages produced.</li>
<li>Use <code>fig.height</code> and <code>fig.width</code> to control
the size of the figures produced (in inches).</li>
</ul>
<p>So you might write:</p>
<pre>
```{r load_libraries, echo=FALSE, message=FALSE}
library("dplyr")
library("ggplot2")
```
</pre>
<p>Often there will be particular options that you’ll want to use
repeatedly; for this, you can set <em>global</em> chunk options, like
so:</p>
<pre>
```{r global_options, echo=FALSE}
knitr::opts_chunk$set(fig.path="Figs/", message=FALSE, warning=FALSE,
                      echo=FALSE, results="hide", fig.width=11)
```
</pre>
<p>The <code>fig.path</code> option defines where the figures will be
saved. The <code>/</code> here is really important; without it, the
figures would be saved in the standard place but just with names that
begin with <code>Figs</code>.</p>
<p>If you have multiple R Markdown files in a common directory, you
might want to use <code>fig.path</code> to define separate prefixes for
the figure file names, like <code>fig.path="Figs/cleaning-"</code> and
<code>fig.path="Figs/analysis-"</code>.</p>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<p>Use chunk options to control the size of a figure and to hide the
code.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Challenge 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<pre>
```{r echo = FALSE, fig.width = 3}
plot(faithful)
```
</pre>
</div>
</div>
</div>
</div>
<p>You can review all of the <code>R</code> chunk options by navigating
to the “R Markdown Cheat Sheet” under the “Cheatsheets” section of the
“Help” field in the toolbar at the top of RStudio.</p>
</section><section id="inline-r-code"><h2 class="section-heading">Inline R code<a class="anchor" aria-label="anchor" href="#inline-r-code"></a>
</h2>
<hr class="half-width">
<p>You can make <em>every</em> number in your report reproducible. Use
<code>`r</code> and <code>`</code> for an in-line code chunk, like so:
<code>`r round(some_value, 2)`</code>. The code will be executed and
replaced with the <em>value</em> of the result.</p>
<p>Don’t let these in-line chunks get split across lines.</p>
<p>Perhaps precede the paragraph with a larger code chunk that does
calculations and defines variables, with <code>include=FALSE</code> for
that larger chunk (which is the same as <code>echo=FALSE</code> and
<code>results="hide"</code>).</p>
<p>Rounding can produce differences in output in such situations. You
may want <code>2.0</code>, but <code>round(2.03, 1)</code> will give
just <code>2</code>.</p>
<p>The <a href="https://github.com/kbroman/broman/blob/master/R/myround.R" class="external-link"><code>myround</code></a>
function in the <a href="https://github.com/kbroman/broman" class="external-link">R/broman</a>
package handles this.</p>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<p>Try out a bit of in-line R code.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to Challenge 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Here’s some inline code to determine that 2 + 2 = <code>4</code>.</p>
</div>
</div>
</div>
</div>
</section><section id="other-output-options"><h2 class="section-heading">Other output options<a class="anchor" aria-label="anchor" href="#other-output-options"></a>
</h2>
<hr class="half-width">
<p>You can also convert R Markdown to a PDF or a Word document. Click
the little triangle next to the “Knit” button to get a drop-down menu.
Or you could put <code>pdf_document</code> or <code>word_document</code>
in the initial header of the file.</p>
<div id="tip-creating-pdf-documents" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-creating-pdf-documents" class="callout-inner">
<h3 class="callout-title">Tip: Creating PDF documents<a class="anchor" aria-label="anchor" href="#tip-creating-pdf-documents"></a>
</h3>
<div class="callout-content">
<p>Creating .pdf documents may require installation of some extra
software. The R package <code>tinytex</code> provides some tools to help
make this process easier for R users. With <code>tinytex</code>
installed, run <code>tinytex::install_tinytex()</code> to install the
required software (you’ll only need to do this once) and then when you
knit to pdf <code>tinytex</code> will automatically detect and install
any additional LaTeX packages that are needed to produce the pdf
document. Visit the <a href="https://yihui.org/tinytex/" class="external-link">tinytex
website</a> for more information.</p>
</div>
</div>
</div>
<div id="tip-visual-markdown-editing-in-rstudio" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-visual-markdown-editing-in-rstudio" class="callout-inner">
<h3 class="callout-title">Tip: Visual markdown editing in RStudio<a class="anchor" aria-label="anchor" href="#tip-visual-markdown-editing-in-rstudio"></a>
</h3>
<div class="callout-content">
<p>RStudio versions 1.4 and later include visual markdown editing mode.
In visual editing mode, markdown expressions (like
<code>**bold words**</code>) are transformed to the formatted appearance
(<strong>bold words</strong>) as you type. This mode also includes a
toolbar at the top with basic formatting buttons, similar to what you
might see in common word processing software programs. You can turn
visual editing on and off by pressing the <img src="fig/visual_mode_icon.png" alt="Icon for turning on and off the visual editing mode in RStudio, which looks like a pair of compasses" class="figure">
button in the top right corner of your R Markdown document.</p>
</div>
</div>
</div>
</section><section id="resources"><h2 class="section-heading">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://kbroman.org/knitr_knutshell" class="external-link">Knitr in a knutshell
tutorial</a></li>
<li>
<a href="https://www.amazon.com/exec/obidos/ASIN/1482203537/7210-20" class="external-link">Dynamic
Documents with R and knitr</a> (book)</li>
<li><a href="https://rmarkdown.rstudio.com" class="external-link">R Markdown
documentation</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf" class="external-link">R
Markdown cheat sheet</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/getting-started-with-r-markdown/" class="external-link">Getting
started with R Markdown</a></li>
<li>
<a href="https://bookdown.org/yihui/rmarkdown/" class="external-link">R Markdown: The
Definitive Guide</a> (book by Rstudio team)</li>
<li><a href="https://www.rstudio.com/resources/webinars/reproducible-reporting/" class="external-link">Reproducible
Reporting</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/the-ecosystem-of-r-markdown/" class="external-link">The
Ecosystem of R Markdown</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/introducing-bookdown/" class="external-link">Introducing
Bookdown</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Mix reporting written in R Markdown with software written in R.</li>
<li>Specify chunk options to control formatting.</li>
<li>Use <code>knitr</code> to convert these documents into PDF and other
formats.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-16-wrap-up"><p>Content from <a href="16-wrap-up.html">Writing Good Software</a></p>
<hr>
<p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/episodes/16-wrap-up.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I write software that other people can use?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe best practices for writing R and explain the justification
for each.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="structure-your-project-folder"><h2 class="section-heading">Structure your project folder<a class="anchor" aria-label="anchor" href="#structure-your-project-folder"></a>
</h2>
<hr class="half-width">
<p>Keep your project folder structured, organized and tidy, by creating
subfolders for your code files, manuals, data, binaries, output plots,
etc. It can be done completely manually, or with the help of RStudio’s
<code>New Project</code> functionality, or a designated package, such as
<code>ProjectTemplate</code>.</p>
<div id="tip-projecttemplate---a-possible-solution" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-projecttemplate---a-possible-solution" class="callout-inner">
<h3 class="callout-title">Tip: ProjectTemplate - a possible
solution<a class="anchor" aria-label="anchor" href="#tip-projecttemplate---a-possible-solution"></a>
</h3>
<div class="callout-content">
<p>One way to automate the management of projects is to install the
third-party package, <code>ProjectTemplate</code>. This package will set
up an ideal directory structure for project management. This is very
useful as it enables you to have your analysis pipeline/workflow
organised and structured. Together with the default RStudio project
functionality and Git you will be able to keep track of your work as
well as be able to share your work with collaborators.</p>
<ol style="list-style-type: decimal">
<li>Install <code>ProjectTemplate</code>.</li>
<li>Load the library</li>
<li>Initialise the project:</li>
</ol>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"ProjectTemplate"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"ProjectTemplate"</span><span class="op">)</span></span>
<span><span class="fu">create.project</span><span class="op">(</span><span class="st">"../my_project_2"</span>, merge.strategy <span class="op">=</span> <span class="st">"allow.non.conflict"</span><span class="op">)</span></span></code></pre>
</div>
<p>For more information on ProjectTemplate and its functionality visit
the home page <a href="https://projecttemplate.net/index.html" class="external-link">ProjectTemplate</a></p>
</div>
</div>
</div>
</section><section id="make-code-readable"><h2 class="section-heading">Make code readable<a class="anchor" aria-label="anchor" href="#make-code-readable"></a>
</h2>
<hr class="half-width">
<p>The most important part of writing code is making it readable and
understandable. You want someone else to be able to pick up your code
and be able to understand what it does: more often than not this someone
will be you 6 months down the line, who will otherwise be cursing
past-self.</p>
</section><section id="documentation-tell-us-what-and-why-not-how"><h2 class="section-heading">Documentation: tell us what and why, not how<a class="anchor" aria-label="anchor" href="#documentation-tell-us-what-and-why-not-how"></a>
</h2>
<hr class="half-width">
<p>When you first start out, your comments will often describe what a
command does, since you’re still learning yourself and it can help to
clarify concepts and remind you later. However, these comments aren’t
particularly useful later on when you don’t remember what problem your
code is trying to solve. Try to also include comments that tell you
<em>why</em> you’re solving a problem, and <em>what</em> problem that
is. The <em>how</em> can come after that: it’s an implementation detail
you ideally shouldn’t have to worry about.</p>
</section><section id="keep-your-code-modular"><h2 class="section-heading">Keep your code modular<a class="anchor" aria-label="anchor" href="#keep-your-code-modular"></a>
</h2>
<hr class="half-width">
<p>Our recommendation is that you should separate your functions from
your analysis scripts, and store them in a separate file that you
<code>source</code> when you open the R session in your project. This
approach is nice because it leaves you with an uncluttered analysis
script, and a repository of useful functions that can be loaded into any
analysis script in your project. It also lets you group related
functions together easily.</p>
</section><section id="break-down-problem-into-bite-size-pieces"><h2 class="section-heading">Break down problem into bite size pieces<a class="anchor" aria-label="anchor" href="#break-down-problem-into-bite-size-pieces"></a>
</h2>
<hr class="half-width">
<p>When you first start out, problem solving and function writing can be
daunting tasks, and hard to separate from code inexperience. Try to
break down your problem into digestible chunks and worry about the
implementation details later: keep breaking down the problem into
smaller and smaller functions until you reach a point where you can code
a solution, and build back up from there.</p>
</section><section id="know-that-your-code-is-doing-the-right-thing"><h2 class="section-heading">Know that your code is doing the right thing<a class="anchor" aria-label="anchor" href="#know-that-your-code-is-doing-the-right-thing"></a>
</h2>
<hr class="half-width">
<p>Make sure to test your functions!</p>
</section><section id="dont-repeat-yourself"><h2 class="section-heading">Don’t repeat yourself<a class="anchor" aria-label="anchor" href="#dont-repeat-yourself"></a>
</h2>
<hr class="half-width">
<p>Functions enable easy reuse within a project. If you see blocks of
similar lines of code through your project, those are usually candidates
for being moved into functions.</p>
<p>If your calculations are performed through a series of functions,
then the project becomes more modular and easier to change. This is
especially the case for which a particular input always gives a
particular output.</p>
</section><section id="remember-to-be-stylish"><h2 class="section-heading">Remember to be stylish<a class="anchor" aria-label="anchor" href="#remember-to-be-stylish"></a>
</h2>
<hr class="half-width">
<p>Apply consistent style to your code.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Keep your project folder structured, organized and tidy.</li>
<li>Document what and why, not how.</li>
<li>Break programs into short single-purpose functions.</li>
<li>Write re-runnable tests.</li>
<li>Don’t repeat yourself.</li>
<li>Be consistent in naming, indentation, and other aspects of
style.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/swcarpentry/r-novice-gapminder/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/swcarpentry/r-novice-gapminder/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/swcarpentry/r-novice-gapminder/" class="external-link">Source</a></p>
				<p><a href="https://github.com/swcarpentry/r-novice-gapminder/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://swcarpentry.github.io/r-novice-gapminder/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://swcarpentry.github.io/r-novice-gapminder/aio.html",
  "identifier": "https://swcarpentry.github.io/r-novice-gapminder/aio.html",
  "dateCreated": "2015-04-18",
  "dateModified": "2024-05-07",
  "datePublished": "2024-05-07"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

